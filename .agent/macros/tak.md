---
name: "@tak"
version: "2.0"
type: macro
ccl_signature: "@tak"
description: タスク整理マクロ — 制御構文を含む本物のCCLプログラム
composed_of: [S1, S3, K2, P1, O3, K4, K1, O2]
---

# @tak — タスク整理マクロ v2.0

> **本質**: 制御構文を含む CCL プログラム
> **進化**: v1.0 (順次のみ) → v2.0 (ループ + 条件分岐 + 振動)

---

## CCL プログラム

```ccl
@tak = /s1 _                   # INTAKE: 分割
       F:3{/sta~/chr} _        # LOOP: 分類↔見積 (最大3回)
       F:3{/kho~/zet} _        # LOOP: 構造↔Gap (最大3回)
       ?gap{/sop} _            # IF: Gap有なら調査
       /euk _ /bou             # SCHEDULE + OUTPUT
```

---

## 構文解説

| 記法 | 意味 | 例 |
|:-----|:-----|:---|
| `F:N{X}` | X を最大N回ループ | `F:3{/sta~/chr}` |
| `?cond{X}` | 条件が真なら X 実行 | `?gap{/sop}` |
| `A~B` | A と B の振動 | `/sta~/chr` |
| `A_B` | A の後に B | `/euk_/bou` |

---

## フロー図

```
┌─────────────────────────────────────────────────────────────────┐
│                        @tak フロー                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  入力 ──▶ [/s1 分割]                                            │
│                │                                                 │
│                ▼                                                 │
│         ┌─────────────────┐                                     │
│         │ F:3{/sta~/chr}  │◀──┐ 分類と見積が収束するまで        │
│         │  分類 ↔ 見積    │───┘ (最大3回)                       │
│         └─────────────────┘                                     │
│                │                                                 │
│                ▼                                                 │
│         ┌─────────────────┐                                     │
│         │ F:3{/kho~/zet}  │◀──┐ 構造とGapが収束するまで         │
│         │  構造 ↔ Gap     │───┘ (最大3回)                       │
│         └─────────────────┘                                     │
│                │                                                 │
│                ▼                                                 │
│         ┌─────────────────┐     ┌─────────┐                     │
│         │ ?gap{/sop}      │────▶│ /sop    │─────┐               │
│         │ Gap有なら調査   │     │ 調査実行│     │ 再帰          │
│         └─────────────────┘     └─────────┘     │               │
│                │ No                              ▲               │
│                ▼                                 │               │
│         [/euk タイミング] ──▶ [/bou 出力] ───────┘               │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 演算子

| 式 | 意味 |
|:---|:-----|
| `@tak+` | 内部全WFに + 伝播 (詳細版) |
| `@tak^` | プログラム自体を問う (メタ) |
| `@tak~/s` | @tak と /s の振動 |

---

## 収束条件

| ループ | 収束条件 |
|:-------|:---------|
| `/sta~/chr` | 分類結果が見積で変わらなくなった |
| `/kho~/zet` | 新たなGapが検出されなくなった |

---

*v2.0 — 本物のCCLプログラム (2026-01-30)*
