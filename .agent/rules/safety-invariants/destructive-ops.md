---
trigger: model_decision
glob: 
description: 破壊的操作の安全ガード — ファイル削除・上書き防止
---
# 破壊的操作の安全ガード

> **Guard 法則**: 大事なものには触らせない
> **Undo 法則**: 何をしても元に戻せる状態を保つ

---

## 対象コマンド（ブラックリスト）

以下のコマンドは **SafeToAutoRun=false** で実行し、必ずユーザー承認を得ること:

| コマンド | 理由 |
|----------|------|
| `Remove-Item` (PowerShell) | ファイル/ディレクトリ削除 |
| `rm -rf` (Unix) | 再帰的削除 |
| `git reset --hard` | コミット破壊 |
| `git clean -fd` | 未追跡ファイル削除 |
| `DROP TABLE` / `DELETE FROM` | データベース破壊 |
| `Invoke-WebRequest -Method DELETE` | リモートリソース削除 |

---

## 実行前チェックリスト

破壊的操作を実行する前に、以下を確認すること:

```markdown
## 破壊的操作チェック

- [ ] `git status` を実行し、未追跡ファイルを確認した
- [ ] 削除対象が Git 追跡済み、または別途バックアップ済み
- [ ] 削除対象のパスを `list_dir` で確認した
- [ ] ユーザーに「本当に削除しますか？」と確認した
```

---

## 違反時の対応

1. **即座に停止**: 削除コマンドは送信しない
2. **ユーザーに報告**: 「未追跡ファイルがあります。削除前にバックアップを推奨します」
3. **代替案を提示**: `git add` して追跡するか、手動でバックアップするか

---

## 背景（Gemini 事故 2026-01-25）

- Gemini が `forge/` を Git 未追跡のまま `Remove-Item -Force` で削除
- GitHub に push されていたため復元できたが、危うくデータ損失
- 本ルールはこの再発を防止するために制定

---

*Hegemonikón: Guard, Undo 法則に基づく*
