---
name: "T4 Phronēsis"
description: |
  FEP Octave T4: 実践知モジュール (I-P-S)。長期目標に基づき方策を設計する。
  Use when: 「どう進める？」質問時、複雑なタスクの分解が必要な時、A案/B案の比較評価時。
  Use when NOT: 単純な即時実行タスクの時、既に計画が承認済みの時。
Triggers: T6 Praxis (計画策定→実行へ) or T7 Dokimē (計画策定→検証設計へ)
Keywords: how-to, strategy, planning, roadmap, decomposition, options, trade-off.
---

# T4: Phronēsis (φρόνησις) — 実践知

> **FEP Code:** I-P-S (Inference × Pragmatic × Slow)
> **Hegemonikón:** 14 Phronēsis-H

---

## Core Function

**役割:** 長期目標に基づき方策を設計する

| 項目 | 内容 |
|------|------|
| **FEP役割** | 方策 π の設計、長期EFE最小化 |
| **本質** | 「どうすれば目標に到達するか」を設計する |

---

## Precondition

| 条件 | 内容 |
|------|------|
| **位置** | 長期学習ループの一部（Core Loopではない） |
| **依存** | T3からの因果モデル（任意）、T8からの価値関数（任意） |
| **注意** | **セッション内戦略設計のみ**（永続状態なし） |

---

## Input / Output

### Input

| 種別 | 形式 | ソース | 備考 |
|------|------|--------|------|
| 因果モデル | テキスト | T3 Theōria | 任意（なければ推論で補完） |
| 目標 | テキスト | セッション履歴 / ユーザー発話 | 暗黙的または明示的 |
| 価値関数 | テキスト | T8 Anamnēsis | 任意（過去の成功/失敗パターン） |
| 現在の制約 | テキスト | T1 Aisthēsis | リソース、時間、環境 |

### Output

| 種別 | 形式 | 送信先 | 備考 |
|------|------|--------|------|
| 戦略 | Markdown | T2 Krisis | 優先順位付けの基準 |
| 実行計画 | Markdown | T6 Praxis / ユーザー | 具体的なステップ |
| 方策比較 | テーブル | ユーザー | 複数案がある場合 |

---

## Trigger

| トリガー | 条件 | 優先度 |
|----------|------|--------|
| 明示的設計要求 | 「計画して」「戦略を」「どう進める」 | 最高 |
| 目標設定 | 新規目標の明示 | 高 |
| 行き詰まり検出 | T2/T6から「進め方不明」信号 | 高 |
| 複数選択肢 | T2で選択肢が3つ以上 | 中 |

---

## Processing Logic

```
Phase 1: 目標明確化
  1. ユーザー発話から目標を抽出
  2. 目標が曖昧な場合は質問で明確化
  3. 目標を「達成状態」として定義

Phase 2: 現状分析
  4. 現在地（現状）を定義
  5. 目標との差分（Gap）を特定
  6. 利用可能なリソース・制約を確認

Phase 3: 方策設計
  7. Gap を埋めるための経路を列挙
  8. 各経路を評価（→ 経路評価基準参照）
  9. 最適経路を選択 or 複数案を提示

Phase 4: 実行計画作成
  10. 経路をマイルストーンに分解
  11. 各マイルストーンの達成基準を定義
  12. T2 Krisis, T6 Praxis へ送信
```

---

## Path Evaluation Criteria

```yaml
# 経路評価の5軸
path_evaluation:
  axes:
    - name: "達成可能性"
      weight: 0.25
      question: "現在のリソースで達成可能か？"
      
    - name: "時間効率"
      weight: 0.20
      question: "どれくらい時間がかかるか？"
      
    - name: "リスク"
      weight: 0.20
      question: "失敗した場合のダメージは？"
      
    - name: "学習価値"
      weight: 0.15
      question: "この経路から何を学べるか？"
      
    - name: "一貫性"
      weight: 0.20
      question: "過去の成功パターンと一致するか？"

  scoring:
    high: 0.8 - 1.0
    medium: 0.5 - 0.79
    low: 0.0 - 0.49
```

---

## Strategy Types

| 戦略種別 | 選択条件 | 例 |
|----------|----------|-----|
| **直線戦略** | Gap小、障害なし | A → B → C → Goal |
| **迂回戦略** | 直接経路に障害 | A → X → B → Goal |
| **並列戦略** | 独立したサブ目標が複数 | (A → B) ∥ (C → D) → Goal |
| **撤退戦略** | 目標が非現実的 | Goal → Goal' (目標再定義) |
| **探索戦略** | 情報不足 | T5 Peira 発動 → 情報収集後に再設計 |

### 戦略選択フローチャート

```
目標は達成可能か？
├─ Yes → Gap は小さいか？
│         ├─ Yes → 直線戦略
│         └─ No → 障害があるか？
│                  ├─ Yes → 迂回戦略
│                  └─ No → 並列戦略
│
└─ No → 目標を縮小可能か？
         ├─ Yes → 撤退戦略
         └─ No → 探索戦略（情報収集）
```

---

## Edge Cases

| ケース | 検出条件 | フォールバック動作 |
|--------|----------|-------------------|
| **目標不明** | 目標が抽出できない | ユーザーに質問「何を達成したいですか？」 |
| **リソースゼロ** | 利用可能リソースなし | 撤退戦略 or 「現状では不可能」と報告 |
| **全経路失敗** | 全ての経路が評価低 | 探索戦略発動、T5に情報収集要求 |
| **目標矛盾** | 複数目標が矛盾 | ユーザーに優先順位を質問 |

---

## Test Cases

| ID | 入力 | 期待される出力 |
|----|------|----------------|
| T1 | 「このプロジェクトをどう進める？」 | 戦略提案、マイルストーン分解 |
| T2 | 明確な目標 + 障害検出 | 迂回戦略 |
| T3 | 目標なし（曖昧な依頼） | 質問「何を達成したいですか？」 |
| T4 | 複数の選択肢 | 方策比較テーブル提示 |
| T5 | 非現実的な目標 | 撤退戦略、目標再定義提案 |

---

## Failure Modes

| 失敗 | 症状 | 検出方法 | 回復策 |
|------|------|----------|--------|
| 非現実的計画 | リソース超過 | 実行時エラー頻発 | 制約条件の再確認 |
| 方策固執 | 環境変化を無視 | 同じ失敗を繰り返す | T3 Theōria に再分析要求 |
| 分析麻痺 | 決定できない | 経路が5個超 | 強制的にトップ3に絞る |
| 目標膨張 | スコープが拡大し続ける | 当初目標との乖離 | 元の目標を再確認 |

---

## Integration

| 依存 | 対象 | 関係 |
|------|------|------|
| **Precondition** | T3 Theōria | 因果モデル（任意） |
| **Precondition** | T8 Anamnēsis | 価値関数（任意） |
| **Postcondition** | T2 Krisis | 戦略を評価基準として提供 |
| **Postcondition** | T6 Praxis | 実行計画を提供 |
| **Postcondition** | T5 Peira | 情報不足時に情報収集要求 |

---

## Configuration

| パラメータ | デフォルト | 説明 |
|------------|-----------|------|
| `max_paths_to_evaluate` | 5 | 評価する最大経路数 |
| `min_feasibility_score` | 0.4 | 経路採用の最低達成可能性スコア |
| `force_top_n` | 3 | 分析麻痺時に強制絞り込む数 |

---

## Limitations (制約)

> **重要:** Antigravityはセッション間で状態を永続化しない。

| 制約 | 影響 | 対策 |
|------|------|------|
| **セッション単位** | 戦略はセッション終了で消失 | T8 Anamnēsis でVaultに保存（手動） |
| **月次レビュー不可** | 自動定期レビューは不可能 | ユーザー起動の `/plan` で代替 |
| **長期追跡なし** | マイルストーン進捗を追跡できない | Vault タスク管理で補完 |
