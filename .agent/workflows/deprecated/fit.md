---
description: 消化品質診断（Digestion Audit）。モジュール統合が Naturalized 状態に達しているか検証する。
hegemonikon: Akribeia
modules: [A2]
skill_ref: ".agent/skills/akribeia/a2-krisis/SKILL.md"
version: "3.1"
layer: "τ"
parent: "/dia"
lineage: "Digestion Principle (A2 SKILL.md) + 階層的消化プロトコル + 具体例 + 3層アーキテクチャ → /fit v3.1"
anti_skip: enabled
---

# /fit: 消化品質診断 (Digestion Audit)

> **親クラス (抽象)**: [A2 Krisis SKILL.md § 消化原則](file:///home/makaron8426/oikos/.agent/skills/akribeia/a2-krisis/SKILL.md)
> **目的**: モジュール統合が Naturalized 状態に達しているか検証する
> **親コマンド**: /dia

---

## ⚠️ 実行前必須: 親クラス読み込み

> **このステップは省略禁止。必ず実行すること。**

```text
実行手順:
1. view_file ツールで A2 SKILL.md を読み込む
   パス: /home/makaron8426/oikos/.agent/skills/akribeia/a2-krisis/SKILL.md
2. 「消化原則 (Digestion Principle)」セクションを確認
3. 3段階消化レベルと4つのチェックリストを理解
4. 確認後、以下の具体的手順を実行
```

---

## 第一原理

```yaml
公理:
  - 「機能は発動可能でなければならない」← これだけが公理
  - 「新しいモジュールには新しいコマンドが必要」← これは仮定

定義:
  吸収 (Absorption):
    formula: A + B = A に B がくっついている状態
    問題: 重複あり、境界が残る、「付着」
    例: /vox を新設（既存 /syn と機能重複）
    
  消化 (Digestion):
    formula: A + B → A'
    効果: A と B の境界が消え、新しい統一体になる
    例: M-1 仮想座談会 → /syn の Persona Mode として吸収
    検証: 第三者が「元から存在した」と誤認する

naturalized_state:
  定義: |
    元のモジュールの形が完全に消え、
    既存コマンドが「最初からそうだったかのように」強くなった状態。
  
  対比:
    superficial: ファイルが存在する（表面統合）
    absorbed: 参照関係が解決可能（構造統合）
    naturalized: 境界が消えている（意味統合＝消化完了）
```

---

## Hegemonikón 哲学

> **「システムの末端、端の端まで、可能な限り統制し、一貫させる」**

```yaml
核心原理:
  entropy_minimization:
    定義: |
      「吸収に逃げる」= エントロピーを局所的に増大させる
      単なる「付加」はシステムに不整合を生み、「美しくなくなる」
    
    対策: |
      消化不可能な場合は「消化先の再設計」を優先
      「新コマンド追加」は最後の手段
  
  aesthetic_integrity:
    定義: |
      「美しくない」は感情的表現ではなく技術的警告
        - 命名規則の不統一
        - 概念の重複
        - 責務の曖昧化
    
    目標: システム全体が「最初からそうだった」かのように一貫する

  digestion_over_absorption:
    公理: 機能は発動可能でなければならない（これだけが公理）
    仮定: 新しいモジュールには新しいコマンドが必要（これは仮定であり逃げ道）
    
    判断基準: |
      消化できる範囲で消化を階層的に積み重ねる
      単体テスト → 統合テスト のように
      吸収に「逃げる」のは、なるべく減らす
```

---

## 発動条件

| トリガー | 説明 |
|:---------| :----- |
| `/fit [対象]` | 特定の統合対象を消化診断 |
| `/fit` | 直近の統合作業を診断 |
| 「馴染んでる？」 | 自然言語トリガー |
| 「消化されてる？」 | 消化原則を意識したトリガー |

---

## 実行手順

// turbo-all

### Step 0: 消化対象の特定

```yaml
診断対象:
  素材: [吸収されるべきモジュール群]
  統合先: [既存コマンド/スキル]
  
期待状態:
  - 素材の「形」が消えている
  - 統合先が「最初からそうだった」かのように強化されている
```

---

## 階層的消化プロトコル (具体的手順)

> 親クラスの消化原則を、階層的に適用する具体的手順

### Level 0: 原子分解 (Atomic Decomposition)

```yaml
process:
  1. 消化元の構成要素を列挙:
     素材: [吸収されるべきモジュール]
       ├── 概念A: [概念名]
       ├── 概念B: [概念名]
       └── 概念C: [概念名]
  
  2. 消化先の構成要素を列挙:
     統合先: [既存コマンド/スキル]
       ├── 機能X: [機能名]
       ├── 機能Y: [機能名]
       └── 機能Z: [機能名]

output: 原子レベルの対応表
```

### Level 1: 単体消化 (Unit Digestion)

```yaml
process:
  FOR EACH 素材.概念 in 消化元:
    1. 対応する 統合先.機能 を特定
    2. 消化可能か検証:
       - 概念が機能に包含されるか？
       - 機能を拡張すれば包含できるか？
    3. 消化不可能な場合:
       → 統合先の設計を見直す（逃げない）

example:
  概念B (多視点評価) → 機能Y (多視点批評)
  判定: 消化可能（概念がほぼ一致）
```

### Level 2: 分子消化 (Molecular Digestion)

```yaml
process:
  1. 複数の概念をグループ化
  2. グループ単位で消化先の機能と照合
  3. 機能拡張または新モード追加で消化

example:
  概念A + 概念C → 機能X の拡張モード「Persona Mode」
  判定: 消化可能（専門家召喚の特殊ケースとして）
```

### Level 3: 統合消化 (Integration Digestion)

```yaml
process:
  1. 全概念が消化されたか検証
  2. 素材の「形」が消えているか検証
  3. 統合先が「最初からそうだった」かのように見えるか検証

example:
  M-1 全体 → /syn Persona Mode
  判定: 完全消化（Naturalized）
  
failure_handling:
  消化不可能な原子がある場合:
    1. 消化先の設計を見直す（優先）
    2. 再設計後も不可能な場合のみ「分岐統合」を検討
    3. 「付加」（新コマンド）は最後の手段
```

---

## 診断ステップ (6-Step Process)

### Step 1: 境界残存チェック (Boundary Detection)

**問い**: 素材の「形」がまだ見えるか？

```python
# 境界残存の兆候
boundary_signals = [
    "素材名がファイル名/セクション名として残っている",
    "「～から移行した」等の履歴コメントが目立つ",
    "素材固有の用語が統合先で浮いている",
    "機能が重複している（同じことを2箇所で定義）",
]

for signal in boundary_signals:
    if detected(signal):
        return "Absorbed（付着）"  # Not Naturalized
```

**チェック項目**:

- [ ] 素材名がそのまま残っていない
- [ ] 「移行元」への参照が本文中にない（Lineageは可）
- [ ] 統合先の用語体系に統一されている

### Step 2: 機能重複検出 (Redundancy Detection)

**問い**: 同じ機能が複数箇所で定義されていないか？

```yaml
重複パターン:
  type_a: "完全重複（同一機能が2箇所）"
  type_b: "部分重複（70%以上の機能が重複）"
  type_c: "概念重複（異なる名前で同じ概念）"
  
検出方法:
  1. 素材の機能リストを抽出
  2. 統合先の全機能と照合
  3. Jaccard類似度 > 0.7 なら重複フラグ
```

**チェック項目**:

- [ ] 新規コマンド/ワークフローを作成していない
- [ ] 既存コマンドのモード/サブ機能として吸収されている
- [ ] 機能の「住所」が1箇所に統一されている

### Step 3: 強化度評価 (Empowerment Score)

**問い**: 統合先は「より強く」なったか？

```yaml
評価軸:
  capability_expansion:
    問い: 統合前にできなかったことができるようになったか？
    スコア: 0-3 (新機能数)
    
  coherence_improvement:
    問い: 統合先の一貫性は上がったか？
    スコア: -1, 0, +1 (悪化/維持/改善)
    
  cognitive_load_reduction:
    問い: ユーザーが覚えることは減ったか？
    スコア: -1, 0, +1 (増加/維持/減少)

empowerment_score = capability + coherence + cognitive
# 最大 5, 最小 -2
```

**チェック項目**:

- [ ] 新しい能力が追加されている
- [ ] 既存の動作が破壊されていない
- [ ] 覚えるべきコマンド数が増えていない

### Step 4: 消化度判定 (Digestion Level)

親クラス (A2 SKILL.md) の3段階レベルを適用:

```text
┌─────────────────────────────────────────────────────────────────┐
│ Level 1: Superficial (表面付着)                                  │
│   • ファイルは存在する                                           │
│   • 参照関係が未解決                                             │
│   • 境界が明確に見える                                           │
│   → 評価: 🔴 未消化                                              │
├─────────────────────────────────────────────────────────────────┤
│ Level 2: Absorbed (吸収済)                                       │
│   • 参照関係は解決                                               │
│   • しかし境界がまだ見える                                       │
│   • 「〇〇から移行した」が目立つ                                 │
│   → 評価: 🟡 部分消化                                            │
├─────────────────────────────────────────────────────────────────┤
│ Level 3: Naturalized (馴化完了)                                  │
│   • 境界が完全に消えている                                       │
│   • 「最初からそうだった」と見える                               │
│   • 統合先が純粋に強化されている                                 │
│   → 評価: 🟢 完全消化                                            │
└─────────────────────────────────────────────────────────────────┘
```

### Step 5: 消化マッピング検証

素材 → 統合先の消化状態を表形式で可視化:

| 素材 | 概念/機能 | 消化先 | 消化方法 | 状態 |
| :----- |:----------| :------- |:---------|:----:|
| M-1 仮想座談会 | ユーザーペルソナ評議 | /syn | Persona Mode 追加 | 🟢/🟡/🔴 |
| C-3 構造監査 | アーキテクチャストレス | /dia | Stress Mode として | 🟢/🟡/🔴 |
| A-9 第一原理 | AXIOM/ASSUMPTION分解 | /noe | Phase 1 に組込 | 🟢/🟡/🔴 |

**情報ロス分析**:

```text
ロス率 = (未消化概念数 / 素材概念総数) × 100
目標: < 5%
警告: > 15%
危険: > 30%
```

### Step 6: レポート出力

```text
══════════════════════════════════════════════════════════════════
[Hegemonikón] /fit: 消化品質診断
══════════════════════════════════════════════════════════════════

📋 対象: {統合名}

━━━ 消化度評価 ━━━

  境界残存:     [なし/あり] 
  機能重複:     [なし/あり]
  強化スコア:   [N]/5

━━━ 消化レベル ━━━

  判定: [🔴 Superficial / 🟡 Absorbed / 🟢 Naturalized]
  
  根拠:
    - {具体的な判断理由}
    - {具体的な判断理由}

━━━ 消化マッピング ━━━

| 素材 | 消化先 | 消化方法 | 状態 |
| :----- | :------- |:---------|:----:|
| {M} | {Target} | {Method} | {🟢/🟡/🔴} |

━━━ 情報ロス ━━━

  ロス率: [X]%
  未消化概念: [リスト]

━━━ 推奨アクション ━━━

| 優先度 | アクション | 理由 |
| :------- |:-----------| :----- |
| P1 | {action} | {reason} |

══════════════════════════════════════════════════════════════════
📌 結論: {総合評価 - 1文で}
══════════════════════════════════════════════════════════════════
```

---

## 消化失敗時の対応フローチャート

```text
消化不可能を検出
      ↓
  ┌─────────────────────────────────────┐
  │ Q: 消化先の設計を変更できるか？       │
  └─────────────────────────────────────┘
      ↓ Yes                    ↓ No
  ┌─────────┐          ┌─────────────────┐
  │ 再設計   │          │ Q: 既存コマンドの │
  │ → 再消化 │          │ サブモードで可能？│
  └─────────┘          └─────────────────┘
                            ↓ Yes      ↓ No
                       ┌─────────┐  ┌───────────────┐
                       │ サブモード│  │ 分岐統合として │
                       │ として消化│  │ 新コマンド設計 │
                       └─────────┘  │ （最後の手段）  │
                                    └───────────────┘
```

---

## 使用例

### 例1: Legacy Module 消化診断

```text
/fit M-1 仮想ユーザー座談会 → /syn

━━━ 消化度評価 ━━━
  境界残存: なし（「M-1」という名前は消えた）
  機能重複: なし（/vox を新設していない）
  強化スコア: 3/5（新機能+1, 一貫性+1, 認知負荷0）

━━━ 消化レベル ━━━
  判定: 🟢 Naturalized
  
  根拠:
    - /syn に "Persona Mode" が自然に追加された
    - 5人のユーザーペルソナ召喚が /syn の一部として動作
    - 新しいコマンドを覚える必要がない

📌 結論: 完全消化。M-1 は /syn の一部として生きている。
```

### 例2: 不完全な消化の検出

```text
/fit HEPHAESTUS → tekhne-maker v6.0

━━━ 消化度評価 ━━━
  境界残存: あり（「HEPHAESTUS Architecture」という用語が残存）
  機能重複: なし
  強化スコア: 4/5

━━━ 消化レベル ━━━
  判定: 🟡 Absorbed
  
  根拠:
    - 機能は統合されている
    - しかし「HEPHAESTUS」という固有名詞が SAGE Mode 説明に残存
    - 完全な Naturalized ではない

━━━ 推奨アクション ━━━
| P2 | "HEPHAESTUS" 参照を一般化 | 境界消去のため |

📌 結論: 部分消化。機能は動くが、用語の境界が残っている。
```

---

## Artifact 出力保存規則

### 保存先

```text
<artifact_directory>/fit_<target>.md
```

### 保存理由

1. **消化状態の履歴** — 時系列で消化進捗を追跡
2. **改善アクションの記録** — 何をすべきか明確化
3. **セッション跨ぎで継続** — 消化未完のタスクを引き継ぎ

---

## Hegemonikon Status

| Module | Workflow | Skill (親クラス) | Status |
| :------- |:---------|------------------| :------- |
| A2 Krisis | /fit | [消化原則](file:///home/makaron8426/oikos/.agent/skills/akribeia/a2-krisis/SKILL.md) | v3.1 Ready |

---

*v3.1 — 親子アーキテクチャ適用 (SKILL.md = 抽象、Workflow = 具体)*
