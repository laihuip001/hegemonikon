# CCL æ„å‘³çš„æ¤œè¨¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è¨­è¨ˆæ¡ˆ

> **æ‡¸å¿µ3 å¯¾å¿œ**: å½¢å¼çš„æ­£ã—ã• â†’ æ„å‘³çš„å¦¥å½“æ€§ã¸ã®æ‹¡å¼µ

---

## ç¾çŠ¶ (v2.0)

| ãƒ¬ã‚¤ãƒ¤ãƒ¼ | æ¤œè¨¼å†…å®¹ |
|:---------|:---------|
| [syntax_validator.py](file:///home/laihuip001/oikos/hegemonikon/mekhane/ccl/syntax_validator.py) | ãƒ–ãƒ¬ãƒ¼ã‚¹ãƒãƒ©ãƒ³ã‚¹ã€WF å­˜åœ¨ã€æ¼”ç®—å­è¦å‰‡ |

## ææ¡ˆ (v2.1)

| ãƒ¬ã‚¤ãƒ¤ãƒ¼ | æ¤œè¨¼å†…å®¹ | æ‰‹æ³• |
|:---------|:---------|:-----|
| Layer 1: æ§‹æ–‡ | ä¸Šè¨˜ | Regex |
| **Layer 2: æ„å‘³** | æ„å›³-CCL æ•´åˆæ€§ | **LLM** |

---

## å®Ÿè£…æ¡ˆ: `semantic_validator.py`

```python
class CCLSemanticValidator:
    """LLM-based semantic validation for CCL expressions."""
    
    def validate(self, intent: str, ccl: str) -> SemanticResult:
        """
        Validate semantic alignment between intent and CCL.
        
        Returns:
            SemanticResult with:
                - aligned: bool (æ„å‘³çš„ã«ä¸€è‡´ã—ã¦ã„ã‚‹ã‹)
                - confidence: float (ç¢ºä¿¡åº¦ 0.0-1.0)
                - reasoning: str (åˆ¤æ–­ç†ç”±)
                - suggestions: List[str] (æ”¹å–„æ¡ˆ)
        """
```

---

## LLM ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¨­è¨ˆ

```markdown
## Task
ã‚ãªãŸã¯ CCL (Cognitive Control Language) ã®æ„å‘³çš„æ¤œè¨¼å™¨ã§ã™ã€‚

## Input
- **Intent**: {intent}
- **CCL Expression**: {ccl}

## Output (JSON)
{
  "aligned": true/false,
  "confidence": 0.0-1.0,
  "reasoning": "åˆ¤æ–­ç†ç”±",
  "suggestions": ["æ”¹å–„æ¡ˆ1", "æ”¹å–„æ¡ˆ2"]
}

## CCL çŸ¥è­˜
- `/bou`: æ„å¿—ãƒ»ç›®çš„ã®æ˜ç¢ºåŒ–
- `/noe+`: æ·±ã„èªè­˜ãƒ»åˆ†æ
- `/s_/ene`: è¨­è¨ˆâ†’å®Ÿè¡Œã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹
...
```

---

## çµ±åˆè¨ˆç”»

1. âœ… [llm_parser.py](file:///home/laihuip001/oikos/hegemonikon/mekhane/ccl/llm_parser.py) ã® API ã‚­ãƒ¼å•é¡Œã‚’è§£æ±ºï¼ˆæ‡¸å¿µ1ã§å®Œäº†ï¼‰
2. ğŸ”¨ `semantic_validator.py` ã‚’æ–°è¦ä½œæˆ
3. ğŸ”— [generator.py](file:///home/laihuip001/oikos/hegemonikon/mekhane/ccl/generator.py) ã®å¾Œå‡¦ç†ã¨ã—ã¦çµ±åˆ
4. ğŸ“Š æ¤œè¨¼çµæœã‚’ Doxa ã«è¨˜éŒ²ã—ã€å­¦ç¿’ãƒ‡ãƒ¼ã‚¿åŒ–

---

## å®Ÿè£…ã‚³ã‚¹ãƒˆ

| é …ç›® | è¦‹ç©ã‚‚ã‚Š |
|:-----|:---------|
| é–‹ç™ºæ™‚é–“ | 2-3 æ™‚é–“ |
| API ã‚³ã‚¹ãƒˆ | ä½ï¼ˆæ¤œè¨¼æ™‚ã®ã¿å‘¼ã³å‡ºã—ï¼‰ |
| ä¾å­˜é–¢ä¿‚ | [llm_parser.py](file:///home/laihuip001/oikos/hegemonikon/mekhane/ccl/llm_parser.py) ã¨å…±é€š |

---

*Decision required: ã“ã®è¨­è¨ˆæ¡ˆã§é€²ã‚ã¾ã™ã‹ï¼Ÿ*
