# Hermēneus Phase 1 + 2 + 3 完了 Walkthrough

## 概要

CCL (Cognitive Control Language) を **コンパイル→実行→オーケストレーション** する **Hermēneus** コンパイラの Phase 1-3 を完了。

## アーキテクチャ

```
CCL Input → [Phase 1: Compiler] → LMQL
                ↓
         [Phase 2: Runtime] → LLM Execution
                ↓
         [Phase 3: Orchestration] → Stateful Graph
```

## 作成ファイル

| Phase | ファイル | 役割 | 行数 |
|:------|:---------|:-----|-----:|
| 1 | [ast.py](file:///home/laihuip001/oikos/hegemonikon/hermeneus/src/ast.py) | AST ノード | 163 |
| 1 | [expander.py](file:///home/laihuip001/oikos/hegemonikon/hermeneus/src/expander.py) | 省略形展開 | 180 |
| 1 | [parser.py](file:///home/laihuip001/oikos/hegemonikon/hermeneus/src/parser.py) | CCL パーサー | 335 |
| 1 | [translator.py](file:///home/laihuip001/oikos/hegemonikon/hermeneus/src/translator.py) | LMQL 変換 | 280 |
| 2 | [runtime.py](file:///home/laihuip001/oikos/hegemonikon/hermeneus/src/runtime.py) | 実行エンジン | 350 |
| 2 | [constraints.py](file:///home/laihuip001/oikos/hegemonikon/hermeneus/src/constraints.py) | 制約デコード | 320 |
| 3 | [graph.py](file:///home/laihuip001/oikos/hegemonikon/hermeneus/src/graph.py) | StateGraph変換 | 450 |
| 3 | [checkpointer.py](file:///home/laihuip001/oikos/hegemonikon/hermeneus/src/checkpointer.py) | 状態永続化 | 340 |
| 3 | [hitl.py](file:///home/laihuip001/oikos/hegemonikon/hermeneus/src/hitl.py) | HITL制御 | 280 |

**合計: 2,698行**

## テスト結果

```
======================== 50 passed, 2 warnings in 0.12s ========================
```

| Phase | テスト数 |
|:------|--------:|
| Phase 1 | 19 |
| Phase 2 | 16 |
| Phase 3 | 15 |

## 公開 API (v0.3.0)

```python
from hermeneus.src import (
    # Phase 1: コンパイル
    compile_ccl, parse_ccl,
    
    # Phase 2: 実行
    execute_ccl, generate_constrained,
    
    # Phase 3: オーケストレーション
    build_graph, execute_graph,
    save_state, load_state,
    HITLController
)

# 1. コンパイル
lmql = compile_ccl("/noe+ >> V[] < 0.3")

# 2. 実行
result = execute_ccl("/noe+", context="分析対象")

# 3. ステートフルグラフ実行
graph = build_graph("/s+_/bou_/ene >> V[] < 0.2")
state = execute_graph(graph, "プロジェクト設計", thread_id="session-001")
```

---

*Completed: 2026-02-01 | v0.3.0*
