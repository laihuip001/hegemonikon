# CCL セレクタ構文 設計計画 v2.0

> **Hegemonikón**: S-series (戦略設計) + CCL v5.3 拡張
> **CCL 式**: `/s+_/ene+`
> **目的**: ワークフロー出力の部分選択を可能にする構文の追加

---

## 問題定義

現在の CCL:

- `/bou+` → 5つの望み全てを生成
- Creator が「1番だけ」と選択したい場合、手動で指定が必要

**要望**: インデックス/セレクタ構文で部分選択を可能に

---

## /s+ STAGE 0-3: 設計確定

### 選択: ブラケット記法 `[n]`

```
/bou+[1]     → 望み1番のみ
/noe+[3]     → PHASE 3 のみ
/s+[0,1]     → STAGE 0,1 のみ
/bou+[desir] → 派生指定
```

### 構文仕様 (v5.3)

| 構文 | 意味 | 例 |
|:-----|:-----|:---|
| `[n]` | n番目の項目 | `/bou+[1]` |
| `[n-m]` | n〜m 番目の範囲 | `/noe+[1-3]` |
| `[n,m]` | n と m (複数選択) | `/s+[2,4]` |
| `[name]` | 名前付きセクション | `/bou+[desir]` |
| `[*]` | 全項目 (明示的) | `/bou+[*]` |

### 評価順序

セレクタは**末尾に置き、直前の演算子適用後にフィルタリング**:

```
/bou+[1]   = Select(Deepen(bou), 1)
/noe^[3]   = Select(Meta(noe), 3)
```

---

## 実装計画

### 変更対象ファイル

| 種別 | ファイル | 変更内容 |
|:-----|:---------|:---------|
| [MODIFY] | `operators_and_layers.md` | セクション1.5にセレクタ演算子追加 |
| [MODIFY] | `roadmap.md` | Phase 7 追加 |
| [NEW] | `selector_syntax_spec.md` | 詳細仕様ドキュメント |

---

## /ene+ 実行計画

### Step 1: operators_and_layers.md に追加

セクション「1.5 セレクタ演算子」を追加:

```markdown
### 1.5 セレクタ演算子 (1個)

| 記号 | 名称 | 作用 | 例 |
|:-----|:-----|:-----|:---|
| `[...]` | セレクタ | 出力の部分選択 | `/bou+[1]` |

**構文**:
- `[n]` → n番目
- `[n-m]` → 範囲
- `[n,m]` → 複数
- `[name]` → 名前指定
```

### Step 2: roadmap.md に Phase 7 追加

```markdown
## Phase 7: Selector Syntax (完了 ✅)

- セレクタ演算子 `[...]` を追加
- 部分選択による認知負荷軽減
```

### Step 3: 詳細仕様書作成

`selector_syntax_spec.md` に完全仕様を記載

---

## 検証計画

### 手動検証

1. `/bou+[1]` → 望み1番のみ展開
2. `/noe+[3]` → PHASE 3 のみ実行
3. `/s+[0,1]` → STAGE 0,1 のみ実行

### 互換性テスト

- `/bou+` → 従来通り全項目
- `/noe*dia^` → 従来通り動作

---

*Updated: /s+ Stage 完了 → /ene+ へ*
