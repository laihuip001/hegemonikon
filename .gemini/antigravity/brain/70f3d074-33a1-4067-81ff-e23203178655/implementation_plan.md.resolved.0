# FEP ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼çµ±åˆè¨ˆç”»

> **ç›®çš„**: pymdp FEP Agent ã‚’ /noe, /bou, /boot, /bye ã«å®Œå…¨çµ±åˆ
> **å‰æ**: Phase 1-3 (fep_agent + persistence + Dirichlet) ã¯å®Ÿè£…æ¸ˆã¿ãƒ»å…¨ãƒ†ã‚¹ãƒˆé€šé

---

## Phase 4: ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼çµ±åˆ

### STAGE 0: ç¾çŠ¶åˆ†æ

| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | ç¾çŠ¶ | å¿…è¦ãªå¤‰æ›´ |
|:--------------|:-----|:-----------|
| O1 SKILL.md | FEPã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚ã‚Š âœ… | ãªã— |
| O2 SKILL.md | FEPã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚ã‚Š âœ… | ãªã— |
| /noe.md | FEPè¨€åŠãªã— | ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚¹ãƒ†ãƒƒãƒ—è¿½åŠ  |
| /bou.md | FEPè¨€åŠãªã— | ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚¹ãƒ†ãƒƒãƒ—è¿½åŠ  |
| /bye.md | Aè¡Œåˆ—ä¿å­˜ãªã— | Stepè¿½åŠ  |
| /boot.md | Aè¡Œåˆ—èª­è¾¼ãªã— | Stepè¿½åŠ  |

---

## Proposed Changes

### Component: /bye (ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†)

---

#### [MODIFY] [bye.md](file:///home/laihuip001/oikos/.agent/workflows/bye.md)

**Step 3.9: FEP Aè¡Œåˆ—æ°¸ç¶šåŒ–** ã‚’è¿½åŠ :

```markdown
### Step 3.9: FEP Aè¡Œåˆ—æ°¸ç¶šåŒ–

ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸­ã®è¦³å¯Ÿå­¦ç¿’ï¼ˆDirichletæ›´æ–°ï¼‰ã‚’æ°¸ç¶šåŒ–ã€‚

```python
from mekhane.fep import HegemonikÃ³nFEPAgent

agent = HegemonikÃ³nFEPAgent(use_defaults=True)
# ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸­ã«å­¦ç¿’ãŒã‚ã£ãŸå ´åˆ
saved_path = agent.save_learned_A()
print(f"âœ… FEP Aè¡Œåˆ—ä¿å­˜: {saved_path}")
```

**å‡ºåŠ›å…ˆ**: `/home/laihuip001/oikos/mneme/.hegemonikon/learned_A.npy`
```

---

### Component: /boot (ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹)

---

#### [MODIFY] [boot.md](file:///home/laihuip001/oikos/.agent/workflows/boot.md)

**Step 8.5: FEP Aè¡Œåˆ—èª­è¾¼** ã‚’ Phase 3 çŸ¥è­˜èª­è¾¼ ã«è¿½åŠ :

```markdown
#### 8.5 ğŸ§  FEP Aè¡Œåˆ—èª­è¾¼ (Cognitive Layer)

å‰å›ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§å­¦ç¿’ã—ãŸè¦³å¯Ÿãƒ¢ãƒ‡ãƒ«ã‚’èª­ã¿è¾¼ã‚€ã€‚

```python
from mekhane.fep import HegemonikÃ³nFEPAgent

agent = HegemonikÃ³nFEPAgent(use_defaults=True)
if agent.load_learned_A():
    print("âœ… FEP Aè¡Œåˆ—: å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«èª­è¾¼")
else:
    print("ğŸ“ FEP Aè¡Œåˆ—: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆä½¿ç”¨ï¼ˆæœªå­¦ç¿’ï¼‰")
```
```

---

### Component: /noe (NoÄ“sis)

---

#### [MODIFY] [noe.md](file:///home/laihuip001/oikos/.agent/workflows/noe.md)

**ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«: FEP æ‹¡å¼µ** ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ :

```markdown
## ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«: FEP æ‹¡å¼µ (Cognitive Layer)

> **ç™ºå‹•æ¡ä»¶**: ä¿¡å¿µã®ä¸ç¢ºå®Ÿæ€§ã‚’å®šé‡åŒ–ã—ãŸã„å ´åˆ

/noe ã®æ€è€ƒçµæœã‚’ pymdp ã®ä¿¡å¿µåˆ†å¸ƒã¨ã—ã¦è¡¨ç¾ã™ã‚‹ã€‚

### ä½¿ç”¨ä¾‹

```python
from mekhane.fep import HegemonikÃ³nFEPAgent
from mekhane.fep.state_spaces import encode_observation

agent = HegemonikÃ³nFEPAgent(use_defaults=True)

# PHASE 0.5 ã®çµè«–ã‚’è¦³å¯Ÿã¨ã—ã¦å…¥åŠ›
obs = encode_observation(
    context_clarity=0.7,  # ç›²ç‚¹ãƒªã‚¹ã‚¯ã‹ã‚‰ç®—å‡º
    urgency=0.3,          # æ™‚é–“çš„åˆ¶ç´„
    confidence=0.6        # ä¿¡é ¼åº¦
)

# O1 NoÄ“sis: ä¿¡å¿µæ›´æ–°
result = agent.infer_states(obs)
print(f"ä¿¡å¿µã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼: {result['entropy']:.2f}")
print(f"MAPçŠ¶æ…‹: {result['map_state_names']}")

# ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ > 2.02 â†’ EpochÄ“ (åˆ¤æ–­åœæ­¢) ã‚’ç¤ºå”†
if result['entropy'] > 2.02:
    print("âš ï¸ EpochÄ“ æ¨å¥¨: ä¿¡å¿µã®ä¸ç¢ºå®Ÿæ€§ãŒé«˜ã„")
```
```

---

### Component: /bou (BoulÄ“sis)

---

#### [MODIFY] [bou.md](file:///home/laihuip001/oikos/.agent/workflows/bou.md)

**ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«: FEP æ‹¡å¼µ** ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ :

```markdown
## ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«: FEP æ‹¡å¼µ (Cognitive Layer)

> **ç™ºå‹•æ¡ä»¶**: ãƒãƒªã‚·ãƒ¼é¸æŠã®æ•°å­¦çš„æ ¹æ‹ ãŒå¿…è¦ãªå ´åˆ

/bou ã®å„ªå…ˆé †ä½æ±ºå®šã‚’ Expected Free Energy ã§å®šé‡åŒ–ã™ã‚‹ã€‚

### ä½¿ç”¨ä¾‹

```python
from mekhane.fep import HegemonikÃ³nFEPAgent
from mekhane.fep.state_spaces import encode_observation

agent = HegemonikÃ³nFEPAgent(use_defaults=True)

# ç¾åœ¨ã®çŠ¶æ³ã‚’è¦³å¯Ÿã¨ã—ã¦å…¥åŠ›
obs = encode_observation(
    context_clarity=0.8,  # æœ›ã¿ã®æ˜ç¢ºã•
    urgency=0.5,          # æ™‚é–“çš„ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼
    confidence=0.7        # é”æˆã¸ã®ç¢ºä¿¡
)

# O1 â†’ O2 ã®é †ã§å®Ÿè¡Œ
agent.infer_states(obs)
q_pi, neg_efe = agent.infer_policies()

# ãƒãƒªã‚·ãƒ¼è§£é‡ˆ
if q_pi[1] > q_pi[0]:
    print(f"ğŸ¯ BoulÄ“sis æ¨å¥¨: ACT (è¡Œå‹•) â€” ç¢ºç‡ {q_pi[1]:.1%}")
    print("â†’ æ˜ç¢ºãªæ„å¿—ãŒå½¢æˆã•ã‚ŒãŸã€‚/ene ã§å®Ÿè¡Œã¸")
else:
    print(f"ğŸ” BoulÄ“sis æ¨å¥¨: OBSERVE (è¦³å¯Ÿ) â€” ç¢ºç‡ {q_pi[0]:.1%}")
    print("â†’ ã•ã‚‰ãªã‚‹æƒ…å ±åé›†ãŒå¿…è¦")
```
```

---

## å®Ÿè£…é †åº

1. **Phase 4.1**: [/bye.md](file:///home/laihuip001/oikos/.agent/workflows/bye.md) ã« Step 3.9 è¿½åŠ 
2. **Phase 4.2**: [/boot.md](file:///home/laihuip001/oikos/.agent/workflows/boot.md) ã« Step 8.5 è¿½åŠ 
3. **Phase 4.3**: [/noe.md](file:///home/laihuip001/oikos/.agent/workflows/noe.md) ã« FEP ã‚ªãƒ—ã‚·ãƒ§ãƒ³è¿½åŠ 
4. **Phase 4.4**: [/bou.md](file:///home/laihuip001/oikos/.agent/workflows/bou.md) ã« FEP ã‚ªãƒ—ã‚·ãƒ§ãƒ³è¿½åŠ 
5. **Phase 4.5**: ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ + Handoff ãƒ†ã‚¹ãƒˆ

---

## Verification Plan

### Automated Tests

```bash
# æ—¢å­˜ãƒ†ã‚¹ãƒˆç¶­æŒ
cd /home/laihuip001/oikos/hegemonikon
source .venv/bin/activate
PYTHONPATH=. pytest tests/test_fep_agent.py -v
```

### Manual Verification

1. `/bye` å®Ÿè¡Œæ™‚ã« Aè¡Œåˆ—ãŒä¿å­˜ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
2. `/boot` å®Ÿè¡Œæ™‚ã« Aè¡Œåˆ—ãŒèª­è¾¼ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
3. `/noe` + FEP ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª

---

*Generated by HegemonikÃ³n /plan v3.0*
