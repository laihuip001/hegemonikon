# Zero-Trust CCL Executor å®Ÿè£… Walkthrough

**æ—¥ä»˜**: 2026-01-31
**ç›®çš„**: LLM ã®è«–å¤–å‡¦ç† (ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæœªèª­ãƒ»çœç•¥ãƒ»æ€ æƒ°) ã‚’æ§‹é€ çš„ã«è§£æ¶ˆ

---

## èƒŒæ™¯: ç™ºç”Ÿã—ãŸå•é¡Œ

```
å•é¡Œ1: operators.md ã«ã€Œ! = éšä¹—ã€ã¨æ˜è¨˜ â†’ èª­ã¾ãšã€Œå¦å®šã€ã¨èª¤è§£
å•é¡Œ2: è¤‡é›‘ãª CCL å¼ â†’ ã€Œé•·ããªã‚‹ã‹ã‚‰ã€ã¨çœç•¥
å•é¡Œ3: ã€Œæ¥½ãªæ–¹ã‚’é¸ã‚“ã ã€ã¨è‡ªè¦šçš„ã«æ€ æƒ°
```

---

## è§£æ±º: 5æ®µéš Zero-Trust ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
CCL Expression â†’ Phase 0 (ä»•æ§˜æ³¨å…¥) â†’ Phase 1 (æ§‹é€ å¼·åˆ¶)
             â†’ Phase 2 (æ¤œè¨¼) â†’ Phase 3 (ç›£æŸ») â†’ Phase 4 (å­¦ç¿’)
             â†’ Validated Output
```

---

## å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«

| Phase | ãƒ•ã‚¡ã‚¤ãƒ« | æ©Ÿèƒ½ |
|-------|----------|------|
| 0 | [spec_injector.py](file:///home/laihuip001/oikos/hegemonikon/mekhane/ccl/spec_injector.py) | æ¼”ç®—å­ä»•æ§˜ã®è‡ªå‹•æ³¨å…¥ + ã‚¯ã‚¤ã‚º |
| 1 | [output_schema.py](file:///home/laihuip001/oikos/hegemonikon/mekhane/ccl/output_schema.py) | Pydantic ã‚¹ã‚­ãƒ¼ãƒ |
| 2 | [validators.py](file:///home/laihuip001/oikos/hegemonikon/mekhane/ccl/guardrails/validators.py) | å‡ºåŠ›æ¤œè¨¼ + ãƒªã‚¸ã‚§ã‚¯ãƒˆ |
| 4 | [failure_db.py](file:///home/laihuip001/oikos/hegemonikon/mekhane/ccl/learning/failure_db.py) | å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’ |
| çµ±åˆ | [executor.py](file:///home/laihuip001/oikos/hegemonikon/mekhane/ccl/executor.py) | ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ |

---

## ãƒ†ã‚¹ãƒˆçµæœ

```
Test 1: Spec Injector
  Operators found: {'+', '~', '!', '/'}
  Prompt length: 663 chars
  âœ… Spec Injector works

Test 2: Output Validator
  Valid: False (ä¸å®Œå…¨ãªå‡ºåŠ›ã‚’æ­£ã—ãæ¤œå‡º)
  Errors: 7
  âœ… Validator works

Test 3: Failure DB
  Warnings for /noe!~/u+: 1
  - æ¼”ç®—å­ `!` ã¯ã€Œéšä¹— = å…¨æ´¾ç”ŸåŒæ™‚å®Ÿè¡Œã€ã§ã™ã€‚ã€Œå¦å®šã€ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
  âœ… Failure DB works
```

---

## ä½¿ç”¨ä¾‹

```python
from mekhane.ccl import create_ccl_prompt, validate_ccl_output

# 1. LLM ã«æ¸¡ã™ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ç”Ÿæˆ
prompt = create_ccl_prompt("/noe!~/u+")
# â†’ æ¼”ç®—å­ä»•æ§˜ + ç†è§£ã‚¯ã‚¤ã‚º + è­¦å‘ŠãŒè‡ªå‹•æ³¨å…¥

# 2. LLM å‡ºåŠ›ã‚’æ¤œè¨¼
result = validate_ccl_output("/noe!~/u+", llm_output)
if not result.valid:
    print(result.regeneration_instruction)
    # â†’ å†ç”Ÿæˆã‚’è¦æ±‚
```

---

## æ—¢çŸ¥ã®è­¦å‘Š (è‡ªå‹•æ³¨å…¥)

| æ¼”ç®—å­ | è­¦å‘Š |
|--------|------|
| `!` | ğŸ”´ ã€Œéšä¹— = å…¨æ´¾ç”ŸåŒæ™‚å®Ÿè¡Œã€ã§ã‚ã‚Šã€Œå¦å®šã€ã§ã¯ãªã„ |
| `*^` | ğŸŸ¡ ã€Œèåˆ + ãƒ¡ã‚¿åˆ†æã€ä¸¡æ–¹ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒå¿…è¦ |

---

## æ®‹ã‚¿ã‚¹ã‚¯

- [ ] Phase 3: Multi-Agent Validator (è«–ç†ç›£æŸ»)
- [ ] æ­£å¼ãƒ†ã‚¹ãƒˆè¿½åŠ 
- [ ] README.md è¿½åŠ 
