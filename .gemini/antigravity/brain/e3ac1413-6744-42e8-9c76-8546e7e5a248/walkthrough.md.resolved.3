# Dendron v2 レッドチーム監査レポート

> **CCL**: `/syn+.lex[Dendron] × /dia+.adv × /pre+ × /pan.grave × /epo+`
> **日時**: 2026-02-01 17:20

---

## 監査サマリー

| 結果 | 数 |
|------|---:|
| ✅ 安全 | 3 |
| ⚠️ 要改善 | 4 |
| ❌ 脆弱性 | 2 |
| 🪦 死コード | 2 |

---

## Layer 2: /dia+.adv 攻撃ベクトル

| # | 攻撃 | 結果 |
|---|------|------|
| 1 | 偽の親参照 (存在しないパス) | ⚠️ **脆弱性: 親パス存在チェックなし** |
| 2 | 空の親参照 | ✅ 安全: ORPHAN として検出 |
| 3 | Unicode 偽装 (Cyrillic P) | ✅ 安全: regex は ASCII のみ |
| 4 | パストラバーサル (`../../../`) | ⚠️ **注意: regex では防げない** |
| 5 | regex DoS (10000文字) | ✅ 安全: 0.0000秒 |

---

## Layer 4: /pan.grave 墓場歩き

| # | 項目 | 結果 |
|---|------|------|
| G1 | `check_dirs` | ✅ 使用中 (cli.py から) |
| G2 | `PROOF_PATTERN` v1 | 🪦 **死コード: checker.py では未使用** |
| G3 | `SPECIAL_PARENTS` | 🪦 **死コード: 定義のみ、使用なし** |
| G4 | `ReportFormat.MARKDOWN` | ✅ 使用中 (cli から) |

---

## Layer 5: /epo+ 確信度評価

| 主張 | 確信度 |
|------|--------|
| 「親参照で演繹が表現できる」 | 🟡 **60%** — 親パスの検証がないため形骸化リスク |
| 「100% カバレッジに価値がある」 | 🟢 80% — CI でのゲートとして機能 |
| 「Dendron は形骸化しない」 | 🟡 **50%** — 自動生成に依存しすぎるリスク |

---

## 改善計画

| 優先度 | 項目 | 対策 |
|--------|------|------|
| **HIGH** | 親パス存在チェック | `validate_parent()` メソッド追加 |
| **MED** | パストラバーサル防止 | 相対パス正規化 |
| **LOW** | 死コード削除 | `PROOF_PATTERN` v1, `SPECIAL_PARENTS` 削除 |
