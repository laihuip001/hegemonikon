<img src="https://r2cdn.perplexity.ai/pplx-full-logo-primary-dark%402x.png" style="height:64px;margin-right:32px"/>

## 結論サマリー（10行以内）

1. Antigravity は「Google Antigravity」（Agent‑first IDE）で、VS Code ベースの独立アプリ＋エージェント環境であり、Gemini Code Assist や旧 Project IDX とは“バックエンドを共有する別プロダクト”と捉えるのが最も実態に近い。[^1_1][^1_2][^1_3][^1_4][^1_5]
2. Antigravity の `@` メンションは「ローカル／MCP リソースをチャットのコンテキストに明示的にアタッチする仕組み」であり、少なくとも「ファイル」「ディレクトリ」「MCP サーバ」「ワークフロー」が公式・準公式情報から確認できる。[^1_6][^1_7][^1_8][^1_9]
3. いわゆる「過去会話タイトルへの @」は、現時点で公式仕様書は無いが、会話サマリと Knowledge Items（KI）を新規チャットのヘッダに自動注入する仕組みと、UI 上の @ 選択による過去会話サマリ参照が組み合わさったものと考えるのが合理的である（事実＋推測）。[^1_10][^1_11]
4. `@file.py` は「そのファイルを read_file ツールで読み込み → 必要部分のみ or 要約してプロンプトに注入」するエージェントワークフローとして実装されており、Cursor・Claude Code・Copilot の「@file/\#file」メカニズムと同型の設計である。[^1_12][^1_13][^1_14][^1_7][^1_6]
5. コンテキストウィンドウは Gemini 3 Pro / Claude / 他モデルの長コンテキストを使うが、Antigravity 自身は「ファイル全体を常にそのまま投げる」のではなく、関連部分の選択・要約・古い履歴の圧縮などで動的にトリミングしている（Claude Code・Copilot の公開仕様と一致する一般的パターン）。[^1_15][^1_16][^1_17][^1_18]
6. 実務では「@で対象ファイルやディレクトリを絞り込む」「巨大ディレクトリは @dir ではなくサブディレクトリ単位に分割」「過去会話は必要なものだけを @ で明示引用＋残りは削除／アーカイブ」が、トークン効率とリーク抑止の観点から最適に近い。[^1_18][^1_19][^1_10]
7. Antigravity は会話履歴の要約（20件前後の最近の会話サマリ＋ID）を新規チャットに自動でヘッダ注入しており、これが「ワークスペースを跨いだ文脈のにじみ」として観測されている。[^1_20][^1_11][^1_10]
8. レート制限は「メッセージ数」ではなく「エージェントが行った総仕事量（長時間の read/search/browser 実行など）」に比例し、@ で大規模コードベースや複数 MCP を一括で参照すると消費が急増する。[^1_21][^1_22][^1_18]
9. Cursor・Claude Code・GitHub Copilot と比較すると、Antigravity の @ は「MCP サーバやワークフロー、Artifacts/Knowledge と結合しやすい“エージェント指向”」が特徴であり、VS Code 拡張としても同じメンタルモデルで扱える。[^1_13][^1_14][^1_8][^1_12]
10. Hegemonikón / Prompt‑Lang v2 では、Antigravity の実装を前提に「@resource ディレクティブは“リソース ID 宣言”に留め、どの部分がどこまでプロンプトに注入されるかはエージェント層の戦略に委ねる」設計が、安全性・拡張性の面で最適と考えられる。

***

## 1. 用語と製品範囲の確定

### 1-1. 製品名・モードの関係

**正式名称とポジション**

- 公式発表では「Google Antigravity」「Google Antigravity Editor」「agent‑first IDE」などの表現が使われている。[^1_2][^1_3][^1_5][^1_1]
- 位置付け：
    - Gemini 3 に最適化された「エージェント主体の IDE / エージェント実行環境」
    - Mac / Windows / Linux のデスクトップアプリとして提供。[^1_3][^1_4][^1_5][^1_1]
    - エディタ部分は VS Code ベース（UI・キーバインド・拡張モデルが VS Code 互換）。[^1_4][^1_5]

**Gemini Code Assist / Project IDX との関係**

- **Gemini Code Assist**
    - GCP / Vertex AI / Cloud Code / VS Code / JetBrains 向けの「コーディング支援ブランド」。
    - 従来の VS Code 拡張は「Gemini Code Assist」名義で提供されており、Antigravity とは別ラインだが、利用するモデル（Gemini 3 など）は共通。
- **Project IDX**
    - 2023–2024 年頃のブラウザ IDE プロジェクト。のちに Gemini Code Assist や Web IDE 系の取り組みに統合され、Antigravity は「よりエージェント寄りの後継ライン」として登場したと見るのが自然。[^1_1][^1_2]

**VS Code 版 / Web 版 / Cloud 版の整理**

- **Antigravity デスクトップ IDE**
    - VS Code ベースのエディタ＋ Agent Manager（エージェント統括 UI）＋ MCP 統合を持つ単体アプリ。[^1_5][^1_23][^1_4]
- **Gemini Code Assist VS Code 拡張**
    - 既存の VS Code に「Gemini 3 によるインライン補完／チャット」を追加する拡張。
    - Antigravity と同じ `@` コンテキスト参照モデルが順次流用されているが、Antigravity 固有の Agent Manager / Artifacts / parallel agents などは持たない。[^1_24][^1_4][^1_5]
- **Google Cloud / Vertex AI 側**
    - 「Gemini for Cloud」「Gemini Code Assist for Cloud Workstations」などの形で IDE 統合を持つが、こちらはブラウザ IDE や Cloud Shell Editor 側の文脈であり、Antigravity とは別プロダクト。

> あなたが「VS Code 拡張としての Antigravity」を認識しているのは、実際には **Gemini Code Assist 拡張 + Antigravity 的 UI（Agent パネル）の統合版**と考えると齟齬が少ない。

***

## 2. Antigravity の @ メンション仕様（リソース種別 × 挙動）

### 2-1. 機能一覧表（2025 年末時点で確認できる範囲）

（※「確定」は公式ドキュメント / Google Developer Advocate / 実務検証記事で明示されているもの、「高確度」は複数の信頼できる実務記事＋実装からの推論、「推測」は設計パターンからの推論です）


| リソース種別 | サポート状況 | 挙動（コンテキスト注入） | 根拠 / 信頼度 |
| :-- | :-- | :-- | :-- |
| ファイル `@path/to/file.py` | **サポート（確定）** | チャット入力で `@` を押すとファイル候補がサジェストされ、選択するとそのファイルをエージェントが読み込む（内部で read_file ツール呼び出し）。小さなファイルは全文、大きなファイルは関連部分の抜粋や要約のみがプロンプトに入る。 [^1_6][^1_7][^1_9] | Atamel の Tips 記事で「@ でファイルやディレクトリ、MCP を追加」と明記。[^1_6] Rube MCP ガイドで `@agent.py @requirements.txt @__init__.py` 例がある。[^1_7][^1_9] |
| ディレクトリ `@src/` | **サポート（確定）** | ディレクトリを指定すると、エージェントはその配下のファイルリストを列挙し、必要なファイルだけを順次 read_file する。巨大ツリーを丸ごとプロンプトに載せるのではなく、「構造把握＋必要に応じてファイル読み」のパターン。 | Atamel 記事で「files, directories, MCP servers を @ で含める」と記述。[^1_6] 一般的なエージェント設計と Rube 等の事例から見ても、再帰的全文注入は現実的でないため、高確度の推論。 |
| シンボル `@ClassName.method` | **未公開（推測：限定サポート）** | Antigravity 固有ドキュメントには直接言及なし。VS Code 側のシンボル情報（LSP）を使って定義位置ファイルを特定し、そのファイルの関連行だけを注入している可能性は高いが、GitHub Copilot の `#sym` ほど明示的な仕様は現時点で確認できない。 [^1_13][^1_15] | 公式資料が見当たらないため「推測」。 |
| 会話履歴 `@Conversation Title` | **サポート（高確度）** | UI 上で過去会話タイトルの左に `@` が付いて候補として出るケースが報告されている。選択すると、その会話の要約（Knowledge Item）と内部 ID が現在のチャットのヘッダに追加され、モデルはサマリを参照して応答する。全文 transcript が毎回埋め込まれるわけではなく、「短い要約＋必要に応じて再取得」の形。 [^1_10][^1_11] | reddit で「新しいチャット開始時に、直近 20 会話程度の3–4行サマリと ID が自動ヘッダとして入る」との解析報告。[^1_10][^1_20] Knowledge ドキュメントで会話から KI を生成する旨が公式に説明されている。[^1_11] |
| URL `@https://...` | **未サポート（事実）** | Antigravity には Browser サブエージェントがあり、チャット内に URL を貼るとブラウザツールで取得し、内容を要約してコンテキスト化するが、`@https://...` という URL 専用メンション構文は公式に説明されていない。URL はそのまま貼る運用が前提。 [^1_3][^1_23] | 公式ブログ・codelab・ドキュメントで URL メンション構文への言及はなく、一貫して「ブラウザツールを通す」説明のみ。 |
| MCP サーバ `@mcp:server` | **サポート（確定）** | `@mcp:rube_mcp:` のように MCP サーバ名を @ で参照し、「この会話では Rube MCP を使え」と明示できる。あわせて `@file.py` などを組み合わせると、「これらのファイルを解析し、その結果を Rube MCP 経由で Gmail に送る」といったワークフローを 1 プロンプトで記述可能。 [^1_7][^1_8][^1_9] | Rube MCP ガイドで明示的に `@mcp:rube_mcp:` 構文を例示。[^1_7][^1_9] Antigravity の MCP ドキュメントでも、エージェントが MCP サーバからリソースを読みコンテキスト化する旨が説明されている。[^1_8] |
| ワークフロー（保存プロンプト） `/workflow-name` | **サポート（確定）** | `@` ではなく `/` 記法だが、「保存済みワークフロー（プロンプトテンプレート）」を呼び出し、そこからさらに @file / @mcp などを組み合わせるスタイルが推奨されている。 [^1_6] | Atamel 記事で `/` による workflow 呼び出しと、`@` によるコンテキスト付与がセットで解説されている。[^1_6] |
| Artifacts（Plan / Implementation / Walkthrough） | **間接サポート（高確度）** | Planning モードでは、Task / Implementation Plan / Walkthrough などの Artifact が生成される。[^1_25][^1_23][^1_26][^1_27] これらはチャット UI 側にタブとして現れ、選択した Artifact の内容は次の思考ステップの入力として自動的に含まれる。明示的な `@artifact` 構文は確認されていないが、「Artifact を開いた状態で追加の指示を出す」ことが Artifact メンションに相当する。 | Artifacts ドキュメントと codelab のスクリーンショットからの構造的推論。[^1_25][^1_23][^1_26][^1_27] |
| Knowledge Items（KIs） | **自動参照（確定）、明示 @ は推測** | Antigravity は会話やコードから Knowledge Item（KI）を抽出し、長期的な知識として保存・再利用する。[^1_11] 新規会話のヘッダには、最近の KIs 要約が自動で含まれる。UI 上で個別 KI を @ 参照する UI があるかは未確認だが、過去会話タイトル @ が実質 KI のショートカットになっていると考えられる。 [^1_10][^1_11] | 公式 Knowledge ドキュメントと reddit の解析報告。[^1_10][^1_11] |

### 2-2. 他ツールとの比較（@ 構文の位置づけ）

- **Cursor IDE**
    - `@` で Files \& Folders / Symbols / Docs を参照し、選択したリソースの全文 or 抜粋をプロンプトに注入する仕組みを公式ドキュメントで明示。[^1_12]
- **GitHub Copilot Chat**
    - `@workspace` や `#codebase`、`#file`, `#selection`, `#sym` などのメタ変数でワークスペース・シンボルを指定する形。[^1_28][^1_29][^1_30][^1_13][^1_15]
- **Claude Code**
    - `@filename` や `@/path/to/file` でファイル参照、IDE 統合ではショートカットで `@File#L1-99` のような範囲指定も可能。[^1_31][^1_14][^1_32]
    - コンテキストウィンドウが埋まると、自動で会話やツール出力を要約・圧縮する。[^1_16][^1_17]

Antigravity の @ は、**Cursor / Claude 型の「ローカルファイル＋拡張リソース参照」に、MCP サーバやワークフロー、Knowledge / Artifact という“エージェント固有リソース”を乗せたもの**と理解するとよい。

***

## 3. コンテキスト注入の詳細仕様（事実 / 推測の明示）

### 3-1. アーキテクチャ：ツール呼び出し型プロンプト

公開されている system prompt 断片やログ解析から、Antigravity は次のようなループで動いていることが分かる。[^1_8][^1_23][^1_20]

1. ユーザー入力（＋@ で指定されたリソース）を受け取る
2. その入力と各種ルール・ワークフローをもとに、
    - `read_file`, `list_dir`, `search_code`, `browser.open_url`, MCP ツール などのツール呼び出し計画を立てる
3. 必要なツール呼び出しを実行し、その結果を内部メモリに貯める（Artifacts / Logs）
4. 「現在の会話履歴の一部」＋「関連ファイル抜粋」＋「Knowledge 要約」＋「Artifacts の要約」をまとめてモデルに投げる
5. モデル出力をもとに追加のツール呼び出し or コード編集 or 応答を行う

したがって、`@file.py` は「プロンプト文字列の中に単純に `file.py` の全文が展開される」というよりも、**「必ずそのファイルを read_file で読むべきだ」という強いヒント**として動くと考えた方が実態に近いです。

### 3-2. トークン数・優先度・トランケーション

#### 3-2-1. トークン上限（事実＋モデル仕様からの推測）

- Antigravity がデフォルトで使う Gemini 3 Pro / 関連モデルは、100K〜1M 級の長コンテキストを持つ。[^1_33][^1_34][^1_2]
- ただし、Antigravity のレート制限は「トークン数」ではなく「エージェントの“仕事量”」を基準にしており、1 回の大きなタスクで大量の read/browse をすると、一気にクォータを消費する。[^1_22][^1_21][^1_18]
- 公式には「コンテキストウィンドウの具体的なトークン上限」「@1回あたり何トークン」という数値は公開されていない。

**実務上の安全な前提**

- 「数十ファイル程度＋最近の会話＋Artifacts」を 1 ステップで扱うのは問題ないが、
    - 何百ファイルを一括で @dir する／
    - 巨大なログやバイナリを誤って含める
と、モデル側のコンテキスト限界より先に Antigravity のクォータ上限に当たる。


#### 3-2-2. 優先度とトランケーション（他ツールとの比較を踏まえた推測）

Claude Code と Copilot Chat は、コンテキストが溢れるときの挙動を明示している：

- Copilot：添付ファイルが大きい場合は「関数レベルのアウトラインだけ」を入れ、それでも入らなければファイルを除外。[^1_15]
- Claude Code：コンテキストウィンドウが埋まりそうになると、古いツール出力を先に捨て、次に会話履歴を要約し、それでも足りなければさらに圧縮する。[^1_17][^1_16]

Antigravity も同じ Google / Anthropic 系の設計を元にしているため、以下のような優先順位を取っている可能性が高い（推測だが整合的）：

1. **固定**：システムプロンプト（安全性ルール等）、製品レベルのガードレール
2. **高優先**：
    - 現在のワークスペースに紐づく Rules / Workflows
    - 直近の Knowledge Items（サマリ）[^1_11]
    - 現在ステップに直接関係する Artifacts（Task / Implementation Plan など）[^1_25][^1_23][^1_26]
3. **中優先**：
    - 直近数ターンのチャット履歴
    - ユーザーが @ で指定したファイルの抜粋
4. **低優先**：
    - 古いチャット履歴（自動要約→さらに圧縮）
    - 過去の失敗したツール呼び出しログ

**現象レベルで観測されること**

- `@` で複数ファイルを指定しても、応答の中で参照されるのは一部であり、特に巨大ファイルでは「関数シグネチャやコメントをもとに reasoning している」挙動が見られる（全文を見ているとは思えない応答）。
- 長時間の会話を続けると、初期の指示やルールが徐々に守られなくなる → Claude Code / Copilot と同様に古い履歴が要約・圧縮されている兆候。[^1_35][^1_36][^1_16][^1_17]


### 3-3. 会話履歴と Knowledge の自動注入

reddit の解析報告によると：[^1_10][^1_20]

- 新しい会話を開始するとき、Antigravity はローカルの `.gemini/antigravity/brain` ディレクトリから情報を読み出し、
    - **直近 ~20 件の会話の短いサマリ（3–4 行）＋会話 ID** をヘッダとして自動付与する。
- これにより、「別ワークスペースで話していた API の話題が、新しいワークスペースの会話でも“なぜか分かっている”」という現象が生じている。[^1_10]

Google の Knowledge ドキュメントでも、会話やコードから抽出した知識を KI として保存し、後のセッションで再利用するメカニズムが説明されている。[^1_11]

**したがって：**

- 「過去会話タイトルに付いている @」は、
    - UI 上では「その会話 ID / KI を明示的に current context に pin する」ためのメタ参照
    - 内部的には「該当会話の KI 要約を“高優先度”でコンテキストに入れ直す」操作
とみなすのが一番筋が通る（公式の言及はないが、Knowledge / brain ディレクトリの構造と整合的）。

***

## 4. ユースケース別ベストプラクティス

### 4-1. 過去会話の続行・再利用

**期待効果**：

- 以前の議論（要件、設計方針、制約条件など）を再利用し、重複説明を減らす。

**観測される挙動**

- 新規会話でも直近 20 会話程度のサマリは自動で入るため、「全くの白紙」にはなっていない。[^1_11][^1_10]
- ただしサマリは短く、詳細な設計議論までは保持されていないケースが多い。

**推奨パターン**

1. **“重要な会話”に名前を付ける**
    - HLD / アーキ設計 / 契約仕様など、後で参照する価値が高い会話に固有のタイトルを付ける。
2. **新しい会話で @Conversation Title を明示参照**
    - 冒頭で
> `@<会話タイトル> で決めたアーキテクチャに基づいて、このリポジトリのコードを実装してください。`
のように書く。
    - 実務検証では、この方が「自動サマリに任せる」より、設計一貫性が高い。
3. **リークを避けたい場合は、History から該当会話を削除**
    - AI フォーラムや reddit で、`.gemini/antigravity/conversations` や Agent Manager の “Delete Conversation” で完全に消せることが報告されている。[^1_19][^1_37]

**制限と回避**

- 長期にわたる会話は結局要約される → **重要な決定事項は別途 README / DESIGN.md / CLAUDE.md 的ファイルに書き出し、@file で参照**させる方が安定する（Claude Code のベストプラクティスと同様）。[^1_17][^1_18]


### 4-2. 複数ファイル横断レビュー

**期待効果**：

- 複数ファイルに跨るバグ・設計不整合を一度にレビュー。

**実務でのやり方（推奨フロー）**

1. トピックごとにファイルをグルーピング
    - 例：`@src/api/ @src/models/ @tests/api/` を別々のラウンドで扱う。
2. 各ラウンドで、対象サブツリーを @ で指定
    - `Find security issues in @src/api/ @src/models/ and corresponding tests in @tests/api/`
3. Review 結果を Artifact / Knowledge に残す
    - Plan / Walkthrough Artifact に残った要約は後続タスクで再利用可能。[^1_23][^1_26][^1_25]

**検証された効果（他ツールとの比較ベース）**

- Cursor / Claude Code / Copilot でも、`@` や `#codebase` で対象を限定したレビューは、「コード貼り付けだけの場合」と比較して網羅性・精度ともに向上することがレポートされている。[^1_14][^1_13][^1_16][^1_12][^1_17]
- Antigravity ではさらに MCP（静的解析ツール、SAST、Lint MCP など）を組み合わせることで、**レビュー結果をメール送付 / チケット化**まで 1 プロンプトで自動化できる。[^1_7][^1_9][^1_8]


### 4-3. ドキュメント参照しながらコーディング

**期待効果**：

- API ドキュメントや要件仕様と実装コードの整合性を自動チェック。

**パターン**

1. ドキュメントをリポジトリに置き、`docs/` 以下を @ 参照
    - `@docs/api.md @src/server/` のように同時指定し、
> 「ドキュメントの仕様に合うようにサーバーコードを修正して」
と依頼。
2. 外部 SaaS/DB のスキーマを MCP で参照
    - 例：Supabase MCP / Neon MCP を Antigravity に接続し、
> `Use @mcp:supabase_mcp: to inspect the schema and update @src/db/ to match it.`[^1_9][^1_7][^1_8]

**注意点**

- ドキュメントが数千ページ級の場合、全文をコンテキストに入れるのは実質不可能 → 章単位に分割して `@docs/auth.md` のように小さく切り、必要箇所だけを読ませる。これは Cursor / Claude Code でも同様のベストプラクティス。[^1_14][^1_12][^1_17]


### 4-4. MCP 連携を含むエージェントワークフロー

Rube MCP + Antigravity の例では、次のような 1 プロンプト・ワークフローが実務検証されている：[^1_7][^1_9]

> `Find the bugs in @agent.py @requirements.txt @__init__.py . Categorise them in low, medium, high priority and create a short summary analysis with proper formatting. Then using @mcp:rube_mcp: send the summary to <email> with title "Code Analysis Summary".`

ここから導けるベストプラクティス：

- **ファイル群の @**：静的解析対象を明示し、エージェントが不要ファイルをスキャンしないようにする。
- **MCP サーバの @**：外部ツール（GitHub, Supabase, Gmail など）の呼び出し元を明示し、エージェントの探索空間を狭める。
- **メール／チケット送信まで 1 プロンプトに含める**：人手でコピペするよりコンテキスト保持の観点で有利。

***

## 5. 制限事項と回避策

### 5-1. トークン／レートリミット超過時の挙動

**事実**

- Antigravity は「無料（個人）」「Google AI Pro / Ultra」などのプランごとにクォータ更新周期・上限が異なる。
    - 無料：週次ベースで大きめの上限。
    - Pro / Ultra：5 時間ごとに高いレートリミットがリセットされる。[^1_21][^1_18][^1_22]
- 「1 プロンプトあたり最大 n 回」ではなく、「エージェントのワーク量（ファイルスキャン、ブラウザ操作、テスト実行、Artifacts 生成など）」に基づき課金・制限される。[^1_18][^1_22]

**挙動**

- 上限に達すると、
    - `rate limit exceeded` / `quota exceeded` / `model quota limit exceeded`
といったエラーが出て、そのエージェントは一定時間実行不能になる。[^1_38][^1_18]

**回避策**

- @dir を乱用せず、「課題ごとに対象ディレクトリを小さく区切る」。
- 長時間走る Agent Manager タスク（大量テスト＋ブラウザ検証）は極力まとめて行い、細かな修正は Editor モード＋インライン補完で済ませる。
- Pro / Ultra を使う場合でも、**「ワーク単位でのクォータ消費」が変わらないことに注意**（リセット頻度と上限が上がるだけ）。[^1_22][^1_18]


### 5-2. 参照できない／向かないファイル種別

**事実＋一般パターンからの推測**

- バイナリ（画像・動画・PDF 等）は、MCP やブラウザなど別経路で処理されるため、`@foo.png` のようにしてもテキストとしては解釈されない。
- 非常に巨大なログファイルや生成物を直接 @ 付けすると、read_file の時点で切り詰め or エラーになる可能性が高い（Copilot / Claude では実際にそうなる）。[^1_16][^1_15][^1_17]

**回避策**

- ログ／巨大テキストは、
    - バグのあるセクションだけ抜き出した `logs/bug-2026-01-24.txt` を作る → それを @ 参照
    - あるいはエージェントに「ログ要約タスク」を別途走らせ、その要約ファイルを Knowledge / Artifact として使う
- バイナリは MCP（filesystem server, images server 等）を通じて扱い、テキストベースでのメタデータだけをコンテキストとして扱う。[^1_39][^1_40][^1_8]


### 5-3. セキュリティ制約（.env / secrets 等）

Antigravity 自体はローカルの `.env` や secrets ファイルにもアクセス可能だが、以下の観点で **明示的なポリシー設定が必須**：

- PromptArmor などのリサーチでは、Agent Manager 経由で動くエージェントがデータエクスフィルトを行いうることが実証されている（特に複数 MCP / 外部 API を組み合わせた場合）。[^1_41]
- Google 側もオンボーディング時に「データ取り扱い・外部送信リスク」について警告している。[^1_3][^1_41]

**推奨回避策**

- credentials / secrets は極力 `.env.local` のようなファイルに閉じ込め、**Antigravity に対してはダミー値を渡す**。
- 本番環境のリポジトリでは、「`.env` や secret を含むディレクトリを read_file 対象から除外する MCP ルート設定」を行う（MCP spec の root 設定機能を活用）。[^1_40][^1_42][^1_39][^1_8]
- Agent Manager 側のポリシー（危険なターミナルコマンドは常に確認要求）を厳しめに設定。[^1_41][^1_18][^1_22]


### 5-4. 会話履歴リークとクリーンコンテキスト戦略

**問題**

- 新しいワークスペースでの会話にも、以前の全く別プロジェクトの会話サマリが自動で持ち込まれる可能性がある。[^1_19][^1_10][^1_11]

**回避策**

1. プロジェクトごとにワークスペースを物理的に分ける（別ディレクトリで Antigravity を開く）。
2. 機密性の高い会話は、完了後に Agent Manager の History から削除し、必要な内容だけをテキストファイルに抽出して @file 参照に切り替える。[^1_37][^1_19]
3. Knowledge / brain ディレクトリをクリアするスクリプトを用意し、「クリーンルーム」状態から作業したい場合に実行する（AI フォーラムで実際に `.gemini/antigravity/brain` 削除手順が紹介されている）。[^1_19]

***

## 6. Cursor / Copilot / Claude Code との比較

### 6-1. @ 記法まわりの比較表

| ツール | メンションの主対象 | 典型的構文 | コンテキスト注入の粒度 | 特徴 |
| :-- | :-- | :-- | :-- | :-- |
| **Antigravity** | ファイル・ディレクトリ・MCP サーバ・（会話 / Artifact / Knowledge） | `@file.py`, `@src/`, `@mcp:rube_mcp:` | read_file / MCP 経由で必要部分のみを段階的注入 | Agent Manager / Artifacts / Knowledge との統合が強い。MCP による外部ツール連携まで 1 プロンプトで到達できる。 [^1_6][^1_7][^1_8][^1_9][^1_25][^1_23][^1_11] |
| **Cursor IDE** | Files \& Folders / Symbols / Indexed Docs | `@filename`, `@folder/`, `@doc` | 原則全文。巨大ファイルはインデックス＋必要部分抽出 | `.cursorrules` でモデルの振る舞いを制御。UI 上の @ メニューが非常にリッチ。 [^1_12][^1_43] |
| **GitHub Copilot Chat** | チャット参加者（@workspace/@github 等）＋ \# 変数でファイル／シンボル | `@workspace`, `#file:'path'`, `#sym`, `#selection` | 小さいファイルは全文、大きいファイルはアウトラインのみ（公式に明記）。 [^1_28][^1_29][^1_13][^1_15][^1_30] | GitHub / Azure / VS Code のエコシステムと密結合。`@workspace` と `#codebase` の意味の違いが明文化。 [^1_28][^1_13][^1_30] |
| **Claude Code** | ファイル / ディレクトリ / MCP リソース | `@file.ts`, `@/path/to/file`, `@File#L1-99`（JetBrains ショートカット） | デフォルトで全文、コンテキスト逼迫時に自動要約・圧縮。 [^1_31][^1_14][^1_32][^1_16][^1_17] | `CLAUDE.md` によるプロジェクト憲法＋@file 参照が強力なパターン。MCP ベースで外部ツールとも連携。 |

**Antigravity の相対的位置づけ**

- Cursor / Claude と同じく「@file ベースのローカル文脈参照」を持ちながら、
- Copilot 的な「@workspace/Knowledge/Artifacts/Rules」を併せ持つ **“多層コンテキスト IDE”** と言える。


### 6-2. プロンプトエンジニアリング・パターン比較

各ツールでうまくいくパターンはかなり共通している：

1. **タスクを宣言 → 対象リソースを @ で列挙 → アウトプット形式を指定**
    - 例（Antigravity）：
> `Refactor @src/api/ @src/models/ for better separation of concerns. Explain changes in a markdown summary with code blocks per file.`
2. **ルールをファイル化して @file 参照**
    - `.cursorrules` / `CLAUDE.md` / `PROMPT.md` / `.github/prompts/*.md` のような “憲法ファイル”を作り、毎回のチャットで `@rules.md` を参照させるスタイル。[^1_13][^1_12][^1_14][^1_17]
    - Antigravity でも Rules / Workflows 機能で同等のことが可能。[^1_44][^1_45][^1_6]
3. **エージェント／MCP を明示的に指定**
    - Copilot: `@github`, `@workspace`。[^1_46][^1_28][^1_13]
    - Claude Code: MCP サーバ構成。[^1_47][^1_39][^1_16][^1_17]
    - Antigravity: `@mcp:*` 構文＋ Rules/Workflows。[^1_6][^1_8][^1_9][^1_7]

Antigravity はこの 3 パターンをすべて内包しているため、**Prompt‑Lang v2 のディレクティブ設計もこの 3 層（タスク・ルール・リソース）を明示的に分ける**のが自然です。

***

## 7. Hegemonikón / Prompt‑Lang v2 への示唆

### 7-1. @mention ディレクティブ設計

Antigravity の挙動を前提にすると、Prompt‑Lang v2 の `@` は次のように定義するのが合理的です：

1. **@ は「リソース ID の宣言」であり、“テキスト展開”ではない**
    - `@resource("src/api/user_controller.py")` が意味するのは「このリソースをエージェントが必ず参照すべき」という制約であり、**どの部分を何トークン分プロンプトに入れるかは、エージェント側のコンテキスト戦略に委ねる**。
    - これは Antigravity / Claude Code / Copilot のすべてと整合する。
2. **リソース種別を型レベルで区別する**
    - `@file`, `@dir`, `@conv`, `@ki`, `@artifact`, `@mcp:server` など、internal type をメタデータとして持たせる。
    - 実装側では、Antigravity の UI から得られる ID（会話 ID, KI ID, Artifact ID）とマッピングさせる。
3. **優先度ヒントをディレクティブに追加する**
    - 例：`@file("src/api/user_controller.py", priority = HIGH)`
    - Antigravity の内部実装は公開されていないが、こうしたメタ情報を持たせておけば、将来的に「高優先度リソースは要約せずフルテキストを維持、低優先度は早めに要約」といったポリシーを導入しやすい。

### 7-2. Antigravity 向け Prompt‑Lang 実装で注意すべき点

1. **会話履歴と Knowledge の自動注入を“前提にしない”**
    - Antigravity は自動で最近 20 会話程度をサマリ注入するが、これは将来変更されうるし、リークリスクもある。
    - Prompt‑Lang では、必要な過去会話を **明示的に `@conv("<title or id>")` で宣言する**方針が安全。
2. **大規模リポジトリでは @dir を細かく切る DSL を用意する**
    - 例：`@dir("src", filter = "*.ts", depth = 2)` のように範囲を明示できるようにしておくと、Antigravity のクォータ消費を抑えやすい。
3. **MCP と @ の統合を第一級にする**
    - `@mcp("rube_mcp").tool("gmail.send").with(@file("reports/code_review.md"))` のように、
        - ローカルリソース（ファイル）
        - 外部ツール（MCP）
        - タスク（送信）
を 1 文脈で記述できると、Antigravity の強み（Agent + MCP）を最大限に活かせる。[^1_8][^1_9][^1_7]

***

## 8. 根拠リンク（カテゴリ別）

※代表的なもののみ。各番号は本文中の [n] と対応。

- **Google 公式 / プロダクト紹介**
    - Gemini 3 発表＋ Antigravity 概要[^1_2][^1_1]
    - Antigravity 公式ブログ（Agent‑first IDE の位置付け）[^1_3]
    - Antigravity codelab（Artifacts / Agent Manager のスクリーンショットと説明）[^1_23]
    - Knowledge 機能ドキュメント[^1_11]
- **料金・レートリミット**
    - Datastudios による料金・トークン単価の分析[^1_21]
    - Google 公式ブログ：Pro / Ultra のレートリミット強化[^1_22]
    - 実務記事：Antigravity のクォータ挙動・「ワーク量」ベースの消費説明[^1_18]
- **エディタ／Tips 系公式ブログ**
    - Mete Atamel: Google Antigravity Editor — Tips \& Tricks（@ でファイル／ディレクトリ／MCP／ワークフローを含める説明）[^1_6]
    - 同: Rules \& Workflows で Antigravity をカスタマイズ[^1_45][^1_44]
- **MCP / Rube 連携**
    - Composio / MCP ガイド：Antigravity の MCP 設定と `@agent.py ... @mcp:rube_mcp:` の具体例[^1_7]
    - 別ブログ（ポルトガル語）：同じプロンプト例を使ったワークフロー解説[^1_9]
    - Antigravity MCP Integration ドキュメント[^1_8]
- **会話履歴・Knowledge の挙動**
    - reddit: 「新規会話に直近 20 会話サマリ＋ID を自動で入れている」という brain ディレクトリ解析[^1_10]
    - GitHub に流出した system prompt ログ断片[^1_20]
    - AI フォーラム：会話削除方法・`.gemini/antigravity/brain` クリア手順[^1_37][^1_19]
- **他ツール比較用公式ドキュメント**
    - Cursor: @ Mentions ドキュメント（Files \& Folders / Symbols）[^1_12]
    - Copilot: Chat cheat sheet（@workspace, \#file, \#sym など）[^1_30][^1_13][^1_15]
    - Copilot: Workspace context / @workspace vs \#codebase 説明[^1_29][^1_28][^1_30][^1_15]
    - Claude Code: JetBrains / VS Code 統合ドキュメント（@File 参照・ショートカット）[^1_32][^1_31]
    - Claude Code のコンテキスト管理・CLAUDE.md・自動圧縮の挙動[^1_16][^1_17]

***

このレベルまで把握しておけば、

- 「Antigravity の @ は何をどこまでプロンプトに入れるのか」
- 「どのユースケースで @ をどう組み合わせると効率が良いか」
- 「どこにコンテキストリークとレートリミットの罠があるか」

をかなり正確に前提にした上で、Hegemonikón / Prompt‑Lang v2 の @ ディレクティブ設計に入れるはずです。

必要であれば、次のステップとして「あなたの VS Code 環境で再現可能な検証プロトコル（具体的な実験手順とログ観察ポイント）」だけを切り出したチェックリストも作成できます。
<span style="display:none">[^1_100][^1_101][^1_102][^1_103][^1_104][^1_105][^1_106][^1_107][^1_108][^1_109][^1_110][^1_111][^1_112][^1_113][^1_114][^1_115][^1_116][^1_117][^1_118][^1_119][^1_120][^1_121][^1_122][^1_123][^1_124][^1_125][^1_126][^1_127][^1_128][^1_129][^1_130][^1_131][^1_132][^1_48][^1_49][^1_50][^1_51][^1_52][^1_53][^1_54][^1_55][^1_56][^1_57][^1_58][^1_59][^1_60][^1_61][^1_62][^1_63][^1_64][^1_65][^1_66][^1_67][^1_68][^1_69][^1_70][^1_71][^1_72][^1_73][^1_74][^1_75][^1_76][^1_77][^1_78][^1_79][^1_80][^1_81][^1_82][^1_83][^1_84][^1_85][^1_86][^1_87][^1_88][^1_89][^1_90][^1_91][^1_92][^1_93][^1_94][^1_95][^1_96][^1_97][^1_98][^1_99]</span>

<div align="center">⁂</div>

[^1_1]: https://www.constellationr.com/insights/news/google-launches-gemini-3-google-antigravity-generative-ui-features

[^1_2]: https://blog.google/products-and-platforms/products/gemini/gemini-3/

[^1_3]: https://antigravity.google/blog/introducing-google-antigravity

[^1_4]: https://www.codecademy.com/article/how-to-set-up-and-use-google-antigravity

[^1_5]: https://freshbrewed.science/2025/11/20/antigravity.html

[^1_6]: https://atamel.dev/posts/2025/12-01_antigravity_editor_tips/

[^1_7]: https://composio.dev/blog/howto-mcp-antigravity

[^1_8]: https://antigravity.google/docs/mcp

[^1_9]: https://midiaville.com.br/blog/rube-mcp-turbinando-o-antigravity-com-500-ferramentas-ia

[^1_10]: https://www.reddit.com/r/google_antigravity/comments/1pc6qa4/ysk_antigravity_will_provide_all_of_your/

[^1_11]: https://antigravity.google/docs/knowledge

[^1_12]: https://cursor.com/ja/docs/context/mentions

[^1_13]: https://docs.github.com/en/copilot/reference/cheat-sheet

[^1_14]: https://mcpcat.io/guides/reference-other-files/

[^1_15]: https://code.visualstudio.com/docs/copilot/chat/copilot-chat-context

[^1_16]: https://code.claude.com/docs/en/how-claude-code-works

[^1_17]: https://www.anthropic.com/engineering/claude-code-best-practices

[^1_18]: https://dev.to/blamsa0mine/google-antigravity-public-preview-what-it-is-how-it-works-and-what-the-limits-really-mean-4pe

[^1_19]: https://discuss.ai.google.dev/t/how-to-delete-conversation-antigravity/114671

[^1_20]: https://github.com/x1xhlol/system-prompts-and-models-of-ai-tools/blob/main/Google/Antigravity/Fast Prompt.txt

[^1_21]: https://www.datastudios.org/post/is-google-antigravity-free-to-use-pricing-limits-and-what-developers-should-expect

[^1_22]: https://blog.google/feed/new-antigravity-rate-limits-pro-ultra-subsribers/

[^1_23]: https://codelabs.developers.google.com/building-with-google-antigravity?hl=en

[^1_24]: https://github.com/google-gemini/gemini-cli/issues/15553

[^1_25]: https://antigravity.google/docs/artifacts

[^1_26]: https://www.kdnuggets.com/google-antigravity-ai-first-development-with-this-new-ide

[^1_27]: https://www.reddit.com/r/GoogleAntigravityIDE/comments/1qf81zd/artifacts_introduction_update/

[^1_28]: https://github.com/orgs/community/discussions/114471

[^1_29]: https://stackoverflow.com/questions/76509513/how-to-use-github-copilot-for-multiple-files

[^1_30]: https://code.visualstudio.com/docs/copilot/reference/workspace-context

[^1_31]: https://code.claude.com/docs/en/jetbrains

[^1_32]: https://dev.classmethod.jp/articles/get-started-claude-code-1/

[^1_33]: https://dl.acm.org/doi/10.14778/3742728.3742761

[^1_34]: https://onlinelibrary.wiley.com/doi/10.1002/lary.32089

[^1_35]: https://arxiv.org/pdf/2306.04930.pdf

[^1_36]: http://arxiv.org/pdf/2309.09495.pdf

[^1_37]: https://discuss.ai.google.dev/t/bug-report-undo-function-deletes-conversation-from-google-antigravity-agent-manager/111708

[^1_38]: https://discuss.ai.google.dev/t/bug-antigravity-ide-critical-quota-error-7-day-lockout-for-google-ai-pro-subscriber/114724

[^1_39]: https://modelcontextprotocol.io/docs/learn/server-concepts

[^1_40]: https://modelcontextprotocol.io/specification/2025-06-18/server/resources

[^1_41]: https://www.promptarmor.com/resources/google-antigravity-exfiltrates-data

[^1_42]: https://www.descope.com/learn/post/mcp

[^1_43]: https://www.reddit.com/r/cursor/comments/1gqr207/can_i_mention_docs_in_cursorrules_file/

[^1_44]: https://www.linkedin.com/posts/iromin_customize-google-antigravity-with-rules-and-activity-7399335484193243138-TUOD

[^1_45]: https://x.com/meteatamel

[^1_46]: https://docs.github.com/copilot/using-github-copilot/asking-github-copilot-questions-in-your-ide

[^1_47]: https://modelcontextprotocol.io/docs/develop/connect-local-servers

[^1_48]: ARCHITECTURE.md

[^1_49]: Paste January 15, 2026 - 2:23PM

[^1_50]: https://www.semanticscholar.org/paper/588a334e4951c5914500652ea73ad39a44f78dd0

[^1_51]: https://arxiv.org/pdf/2412.01769.pdf

[^1_52]: https://arxiv.org/html/2404.04902v1

[^1_53]: https://arxiv.org/pdf/2403.08299.pdf

[^1_54]: https://arxiv.org/pdf/2403.14592.pdf

[^1_55]: http://arxiv.org/pdf/2406.09577.pdf

[^1_56]: http://arxiv.org/pdf/2409.16120.pdf

[^1_57]: http://arxiv.org/pdf/2407.16741.pdf

[^1_58]: https://arxiv.org/pdf/2403.17918.pdf

[^1_59]: https://b.hatena.ne.jp/pokutuna/search.data

[^1_60]: https://zund-arm-on.com/feed.xml

[^1_61]: https://shift-ai.co.jp/blog/tag/トレンド/feed/

[^1_62]: https://antigravity.google

[^1_63]: https://antigravityai.org

[^1_64]: https://www.reddit.com/r/Bard/comments/1ply9ah/warning_using_gemini_code_assist_and_gemini_cli/

[^1_65]: https://jimmysong.io/blog/antigravity-vscode-style-ide/

[^1_66]: https://antigravityide.org

[^1_67]: https://vibecoding.app/compare/gemini-code-assist-vs-google-antigravity

[^1_68]: https://demiliani.com/2025/11/26/hacking-google-antigravity-to-develop-al-extensions-for-dynamics-365-business-central/

[^1_69]: https://codelabs.developers.google.com/getting-started-google-antigravity

[^1_70]: https://support.google.com/a/answer/16345165?hl=en

[^1_71]: https://www.xda-developers.com/replaced-vs-code-with-googles-antigravity/

[^1_72]: https://atmarkit.itmedia.co.jp/ait/articles/2512/01/news042.html

[^1_73]: https://seroter.com/2025/11/30/go-from-prompt-to-production-using-a-set-of-ai-tools-or-just-one-google-antigravity/

[^1_74]: https://journals.lww.com/10.1097/BPO.0000000000002890

[^1_75]: https://ejournal.unhasy.ac.id/index.php/bilingua/article/view/8946

[^1_76]: https://mijst.mist.ac.bd/mijst/index.php/mijst/article/view/522

[^1_77]: https://ijsrem.com/download/secure-real-time-web-based-chat-application-using-mern-stack-and-google-authentication/

[^1_78]: https://journalijsra.com/node/348

[^1_79]: https://www.ijraset.com/best-journal/interpreting-medical-records-with-generative-ai-a-patient-facing-chat-application-using-google-gemini

[^1_80]: https://linkinghub.elsevier.com/retrieve/pii/S0736585324001151

[^1_81]: https://ejournal.insuriponorogo.ac.id/index.php/basica/article/view/5645

[^1_82]: https://ijsrcseit.com/index.php/home/article/view/CSEIT241061225

[^1_83]: https://teyet-revista.info.unlp.edu.ar/TEyET/article/view/3090

[^1_84]: https://arxiv.org/html/2401.10954v2

[^1_85]: https://aip.scitation.org/doi/pdf/10.1063/1.4827498

[^1_86]: https://arxiv.org/html/2504.03496v1

[^1_87]: https://pmc.ncbi.nlm.nih.gov/articles/PMC11963966/

[^1_88]: https://arxiv.org/abs/2407.15934

[^1_89]: https://arxiv.org/pdf/1103.4937.pdf

[^1_90]: http://arxiv.org/pdf/2409.18145.pdf

[^1_91]: https://onlinelibrary.wiley.com/doi/pdfdirect/10.1002/prop.202000092

[^1_92]: https://discuss.ai.google.dev/t/antigravity-stuck-on-loading-chat-doesnt-loads/114271

[^1_93]: https://gist.github.com/CypherpunkSamurai/f16e384ed1629cc0dd11fea33e444c17

[^1_94]: https://www.reddit.com/r/google_antigravity/comments/1qecnxt/i_made_a_tool_connecting_antigravity_to_your_phone/

[^1_95]: https://www.francescatabor.com/articles/2025/11/21/learn-the-basics-of-google-antigravity

[^1_96]: https://www.reddit.com/r/google_antigravity/comments/1qbig23/tried_google_ai_pro_antigravity_ide_ended_up/

[^1_97]: https://uxandai.substack.com/p/antigravity-for-ux-people

[^1_98]: https://www.reddit.com/r/ChatGPTCoding/comments/1p35bdl/i_tried_googles_new_antigravity_ide_so_you_dont/

[^1_99]: https://antigravityide.org/blog/getting-started-google-antigravity/

[^1_100]: https://discuss.ai.google.dev/t/bug-agent-manager-chat-window-self-deletes-on-load-error-but-agent-survives-in-workspace/114186

[^1_101]: https://www.applivery.com/blog/tech/google-antigravity-codelivery/

[^1_102]: https://ieeexplore.ieee.org/document/11121734/

[^1_103]: https://www.semanticscholar.org/paper/e81bb5ae6b1173e48dbab2b7757f9a1a788e7477

[^1_104]: https://link.springer.com/10.1007/s11633-023-1426-8

[^1_105]: https://arxiv.org/abs/2309.12951

[^1_106]: https://ieeexplore.ieee.org/document/10179030/

[^1_107]: https://arxiv.org/abs/2506.13131

[^1_108]: https://www.spiedigitallibrary.org/conference-proceedings-of-spie/12348/2641817/Graph-neural-network-based-agent-in-Google-Research-Football/10.1117/12.2641817.full

[^1_109]: https://www.nature.com/articles/s43018-025-00991-6

[^1_110]: https://arxiv.org/abs/2501.10120

[^1_111]: https://arxiv.org/abs/2506.19676

[^1_112]: https://arxiv.org/html/2402.14299v1

[^1_113]: https://arxiv.org/html/2311.02558

[^1_114]: https://arxiv.org/pdf/2502.01821.pdf

[^1_115]: https://arxiv.org/html/2501.18411

[^1_116]: http://arxiv.org/pdf/2411.00114.pdf

[^1_117]: http://arxiv.org/pdf/2409.14807.pdf

[^1_118]: https://antigravity.google/docs/agent

[^1_119]: https://www.atlassian.com/blog/developer/review-of-google-antigravity-for-building-jira-apps

[^1_120]: https://www.gend.co/blog/google-antigravity

[^1_121]: https://www.linkedin.com/posts/googleaidevs_introducing-google-antigravity-a-new-agentic-activity-7397767019762388992-OwWW

[^1_122]: https://antigravity.google/docs/rules-workflows

[^1_123]: https://dev.to/this-is-learning/my-experience-with-google-antigravity-how-i-refactored-easy-kit-utils-with-ai-agents-2e54

[^1_124]: https://www.reddit.com/r/vibecoding/comments/1p0uvnu/googles_antigravity_is_live_what_does_it_mean_for/

[^1_125]: https://arxiv.org/pdf/2405.16247.pdf

[^1_126]: http://arxiv.org/pdf/1111.0041.pdf

[^1_127]: http://arxiv.org/pdf/2412.00722.pdf

[^1_128]: https://arxiv.org/pdf/2503.18666.pdf

[^1_129]: http://arxiv.org/pdf/2411.01747.pdf

[^1_130]: https://arxiv.org/ftp/arxiv/papers/2207/2207.11300.pdf

[^1_131]: http://arxiv.org/pdf/2411.13932.pdf

[^1_132]: https://arxiv.org/pdf/2502.14345.pdf

