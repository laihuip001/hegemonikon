# シンプリシティの門番 レビュー

## 対象ファイル
`mekhane/anamnesis/export_chats.py`

## 判定
発言（要改善）

## 発見事項
- **未使用コード (Medium)**: 定数 `MIN_USER_MESSAGE_LENGTH` (100) および `MAX_USER_MESSAGE_LENGTH` (500) が定義されているが、ロジックではハードコードされた `200` が使用されているか、全く使用されていない。
- **未使用コード (Medium)**: 正規表現オブジェクト `RE_FILES_EDITED`, `RE_PROGRESS_UPDATES`, `RE_BACKGROUND_STEPS`, `RE_UI_STATUS` が定義されているが、使用箇所がコメントアウトされている。
- **未使用コード (Medium)**: 正規表現オブジェクト `RE_UNSAFE_FILENAME`, `RE_MULTI_UNDERSCORE` が定義されているが、`save_single_chat` メソッド内でインライン実装が代わりに使用されている。
- **未使用コード (Medium)**: `extract_messages` メソッド内に、コメントアウトされたままの未使用コードブロック（プレースホルダー除外処理など）が存在する。
- **過剰設計 / 重複 (Medium)**: `_process_raw_messages` と `extract_messages` メソッドで、`claude_patterns` や `user_start_patterns` などのロール判定ロジックが重複して定義されている。
- **過剰な処理 (Medium)**: `main` 関数において `export_all` メソッドの実行後に `save_individual` が呼び出されているが、`export_all` 内部で既に個別保存が行われているため、処理が重複している。

## 重大度
Medium
