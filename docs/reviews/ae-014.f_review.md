# 比喩一貫性の詩人 レビュー

## 対象ファイル
`mekhane/anamnesis/gnosis_chat.py`

## 判定
発言（要改善）

## 発見事項
- **比喩の不協和音 (Medium)**:
    - `KnowledgeIndexer` は「知識の庭 (Mneme)」を `discover` (探索) するという有機的な隠喩を持ちながら、その内部では `_chunk_text` (断片化/工場) という機械的な処理を行っています。「記憶」の文脈に統一するならば、`_fragment_text` (断片化) や `_digest_text` (消化) が相応しいでしょう。また、`index_knowledge` は図書館の隠喩ですが、`harvest_knowledge` (収穫) や `assimilate_knowledge` (同化) の方が `Gnosis` (知識/認識) の世界観に調和します。
- **構築と生成の対立 (Medium)**:
    - `GnosisChat` 内で `_build_context` (建築) と `_generate` (生成) が同居しています。文脈を「構築」するのではなく、記憶から「編み上げる (`weave_context`)」または「統合する (`synthesize_context`)」方が、対話という創造的行為に寄り添います。
- **動詞のゆらぎ (Low)**:
    - 検索処理において、メソッド名は `_retrieve` ですが、変数は `fetch_k` となっています。これは「取ってくる」行為の多重定義です。`retrieve_k` または `limit` など、文脈に即した統一が求められます。
- **抽象の階層不一致 (Low)**:
    - `KnowledgeIndexer` は静的な道具箱（Static Methodのみ）でありながら、`Reranker` は状態を持つ専門家（Instance）として扱われています。`KnowledgeIndexer` も `KnowledgeHarvester` としてインスタンス化し、あるいは単なる関数群として `knowledge_ops` モジュールに分解するなど、存在形式の統一が望まれます。

## 修正コード提案
```python
# 提案1: KnowledgeIndexer を静的クラスから "Harvester" (収穫者) へ昇華
# 変更前: class KnowledgeIndexer: ... (static methods)
# 変更後:
class KnowledgeHarvester:
    """Mneme から知識を収穫し、Gnosis へと同化させる者。"""

    def harvest(self) -> int:
        # discover_knowledge_files -> survey_fields
        files = self._survey_fields()
        # ...

    def _digest_text(self, text: str) -> list[str]:
        # _chunk_text -> _digest_text
        # ...

# 提案2: GnosisChat のメソッド名と変数の調和
class GnosisChat:
    # ...
    def _synthesize_context(self, results: list[dict]) -> str:
        # _build_context -> _synthesize_context (建築から統合へ)
        # ...

    def _retrieve(self, query: str) -> list[dict]:
         # fetch_k -> retrieval_limit (動詞の統一)
         retrieval_limit = self.top_k * 3 if self._reranker else self.top_k
         # ...
```

## 重大度
Medium
