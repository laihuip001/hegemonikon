# 暗黙契約違反検出者 レビュー

## 対象ファイル
`mekhane/anamnesis/export_chats.py`

## 判定
発言（要改善）

## 発見事項
- **環境への暗黙の依存 (High)**: `DEFAULT_OUTPUT_DIR` が `/home/makaron8426/...` と特定のユーザー環境にハードコードされている。これは「特定のユーザー環境でのみ動作する」という暗黙の契約を強制しており、他の開発者やCI環境での実行を妨げる。
- **DOM構造への重複した依存 (High)**: `jetski-agent` の DOM 構造（`button.select-none`, `.flex.flex-col...` 等）への依存が、当ファイルだけでなく `test_extract_v2.py` や `inspect_*.py` 群にも複製されている。UI構造という「外部契約」が変更された際、修正が全ファイルに波及しないリスクがある（DRY原則違反による契約不履行）。
- **ポート番号のハードコード (Medium)**: `CDP_PORT = 9222` が定数化されており、ポート変更時に柔軟に対応できない。
- **再利用性の欠如 (Medium)**: `AntigravityChatExporter` クラスが存在するにもかかわらず、`test_extract_v2.py` 等のテストコードが同クラスをインポートせず、類似のロジックを再実装している。これは「共通ロジックを提供する」というクラスの契約が機能していないことを示唆する。

## 重大度
High
