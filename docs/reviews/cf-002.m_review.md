# 暗黙契約違反検出者 レビュー

## 対象ファイル
`mekhane/pks/pks_cli.py`

## 判定
発言（要改善）

## 発見事項
- **High**: `cmd_feedback` 関数内で `PKSEngine` クラスのプライベート属性 `_feedback` に直接アクセスしており、カプセル化の契約に違反している。`PKSEngine` の内部実装変更により破損するリスクがある。
- **High**: `p_feedback` サブコマンドの引数定義において、`reaction` の選択肢（`used`, `dismissed`, `deepened`, `ignored`）をハードコードしている。これらの値は `mekhane/pks/feedback.py` 内の `REACTION_WEIGHTS` 辞書のキーとして暗黙的に定義されているものであり、一元管理されていないため、定義変更時の不整合（Enum非網羅）を招く。
- **Medium**: `cmd_feedback` 関数が `FeedbackCollector.get_stats()` の戻り値である辞書の内部構造（`count`, `avg_score`, `threshold_adjustment` キーの存在）を仮定してアクセスしており、明示的なデータクラスや型定義による契約がない。
- **Medium**: モジュールレベルでの `sys.path` 操作（`_HEGEMONIKON_ROOT` の挿入）が、ファイルシステムの特定のディレクトリ構造（`mekhane/pks/` 下にあること）を暗黙の前提としており、パッケージとしての再利用性を損なっている。

## 重大度
High
