# 暗黙契約違反検出者 レビュー

## 対象ファイル
`mekhane/symploke/boot_integration.py`

## 判定
発言（要改善）

## 発見事項
- **[High] 非共有スキーマへの依存 (.agent/projects/registry.yaml)**
  - `_load_projects` 関数が `registry.yaml` の内部構造（`projects` リスト, `status`, `path` キー等）を直接仮定している。
  - プロジェクト管理側のスキーマ変更が即座にブート処理の破損につながる。共通の Schema 定義または Data Access Object (DAO) を介すべきである。

- **[High] 非共有スキーマへの依存 (.agent/skills/*/SKILL.md)**
  - `_load_skills` 関数が Markdown フロントマターの特定フィールド（`name`, `description`）を直接仮定している。
  - スキル定義フォーマットの変更に対する防壁がない。

- **[Medium] 定理定義の重複管理 (Duplicate Source of Truth)**
  - `THEOREM_REGISTRY` 定数は `mekhane/fep/theorem_attractor.py` の `THEOREM_DEFINITIONS` と内容（名前, Series, Command）が重複している。
  - FEP 側で定理名やコマンドが変更された場合、このファイルは追随できず不整合を起こす。`theorem_attractor` からインポートするか、動的に生成すべきである。

- **[Medium] 循環的な暗黙依存 (Circular Implicit Dependency)**
  - 本ファイルは `boot_axes.py` の関数群を呼び出すが、逆に `boot_axes.py` は本ファイルの `_load_projects` 等をインポートして依存している。
  - 双方が相手の実装詳細（関数名、シグネチャ）に強く結合しており、リファクタリング時のリスクが高い。

- **[Medium] 外部サービスへの暗黙契約 (n8n Webhook)**
  - `http://localhost:5678/webhook/session-start` という固定 URL および送信ペイロード構造（`handoff_count`, `ki_count` 等）が、コード内にハードコードされている。
  - 外部ワークフローの変更を検知できず、疎結合なイベントバス等を介していない。

## 重大度
High
