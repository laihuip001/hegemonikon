# 暗黙契約違反検出者 レビュー

## 対象ファイル
`mekhane/mcp/sympatheia_mcp_server.py`

## 判定
発言（要改善）

## 発見事項
- **プライベートメンバへの依存**: (High)
  - `mekhane/api/routes/sympatheia.py` の内部ヘルパー関数 `_read_json` および `_load_config` を直接呼び出している。これらは `_` で始まる非公開関数であり、外部からの利用を想定していないため、将来的にシグネチャ変更や削除が行われるリスクがある。
- **内部データ構造の暗黙的仮定**: (Medium)
  - `sympatheia_status` ツールにおいて、`sympatheia.py` が管理する状態ファイル（`heartbeat.json`, `wbc_state.json`, `git_sentinel.json` 等）のパスと内部JSON構造（キー名: `beats`, `scanCount`, `totalAlerts` 等）を直接参照している。`sympatheia.py` のデータ保存形式が変更された場合、このツールは破損する。
- **環境依存の継承**: (Medium)
  - `sym.MNEME` を参照しており、`sympatheia.py` 内で定義されたデフォルトパス（`/home/makaron8426/...`）に暗黙的に依存している。環境変数 `HGK_MNEME` が未設定の環境では動作しない恐れがある。

## 重大度
High
