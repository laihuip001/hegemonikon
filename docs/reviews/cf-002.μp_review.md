# 暗黙契約違反検出者 レビュー

## 対象ファイル
`mekhane/pks/feedback.py`

## 判定
発言（要改善）

## 発見事項
- **[Medium] 定数/ロジックの不一致 (ドキュメント乖離)**: `adjust_threshold` 内のコメントにて、閾値調整幅が `-0.1 〜 +0.15` と記載されているが、実装 (`-avg_score * 0.1`) に従うと `-0.15` (avg 1.5) 〜 `+0.05` (avg -0.5) の範囲となる。コメントが実装と矛盾している。
- **[Medium] 暗黙の定数依存**: `0.65` という値が `adjust_threshold` のデフォルト引数および `get_stats` の計算式 (`- 0.65`) にハードコードされている。これは `PKSEngine` のデフォルト閾値と暗黙的に同期している必要があり、片方の変更が他方に波及しないリスクがある。また、`get_stats` はベース閾値 `0.65` を前提とした調整値を返すが、`PKSEngine` で異なるベース閾値が使用された場合、クランプ処理 (`max(0.3, min(0.9, ...))`) の影響により実際の調整値と乖離する可能性がある。
- **[Low] 構造的脆弱性**: `REACTION_WEIGHTS` のキー定義（"used", "dismissed" 等）が `pks_engine.py` や `pks_cli.py` にハードコードされており、`feedback.py` 側で変更があった場合に追従漏れが発生する構造になっている。

## 重大度
Medium
