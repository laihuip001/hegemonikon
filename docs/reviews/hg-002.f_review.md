# 予測誤差審問官 レビュー

## 対象ファイル
`mekhane/pks/push_dialog.py`

## 判定
発言（要改善）

## 発見事項
- **副作用非明示 (High)**: `related` メソッド内で例外発生時に `print()` で標準出力へエラーを出力しています。これは呼び出し元が制御できない副作用であり、ログ出力や例外送出など予測可能な形にすべきです。
- **副作用非明示 (High)**: `related` メソッド内で `mekhane.anamnesis.index` をローカルインポートしており、依存関係がクラス定義から隠蔽されています。クラスレベルでのインポートまたは `TYPE_CHECKING` ブロック等で明示し、実行時の依存関係を明確にする必要があります。
- **型予測困難 (Medium)**: `related` メソッドはエラー時に空リストを返しますが、これは「検索結果なし」と「検索システムエラー」の区別がつかず、呼び出し元でのエラーハンドリングを困難にします。エラー時は例外を送出し、呼び出し元でキャッチさせる設計が望ましいです。
- **暗黙状態変更/名前から予測不能 (Low)**: `deeper` や `why` というメソッド名は、内部で LLM 呼び出し（外部API通信・課金・レイテンシ）が発生することを明示していません。`ask_deeper` や `query_reason` など、動詞を含めてアクションであることを明示することが望ましいです。また、`related` の内部で `GnosisIndex` インスタンスを生成しており、暗黙的なリソース確保が発生しています。

## 重大度
High
