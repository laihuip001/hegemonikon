# 信念状態一貫性評価者 レビュー

## 対象ファイル
`mekhane/symploke/jules_client.py`

## 発見事項
- **セッションライフサイクルの不整合 (Disposable vs Pooled)**: クラス全体でセッション管理の方針が統一されていません。`__init__` や `_request` では共有セッションやコンテキストマネージャによる適切な管理が意図されていますが、内部プロパティ `_session` (L173) はアクセスされるたびに新しい `aiohttp.ClientSession` を生成し、それをクローズする手段を提供していません。これにより、コードベース内でこのプロパティを使用するとリソースリーク (CWE-772) が発生するという重大な矛盾があります。
- **並行性制御の競合 (Manual Batching vs Semaphore)**: `batch_execute` メソッドはセマフォを用いた並行数の制御を提供していますが、`synedrion_review` メソッドはこれを呼び出す際に手動でのバッチ分割（Stop-and-Wait方式）を強制しています。この手動制御はセマフォの持つ「スライディングウィンドウ」的な効率性を無効化し、各バッチ内の最も遅いタスクが完了するまで次の処理が始まらないという非効率な動作を引き起こしています。暗黙の前提として「バッチ処理が必要」という信念と「セマフォで制御する」という信念が衝突しています。
- **エラー処理戦略の矛盾 (Double-Layer Retry)**: `create_session` 等で使用される `with_retry` デコレータと、`poll_session` 内のループによる再試行ロジックが重複しており、整合性が取れていません。特に `poll_session` は `RateLimitError` に対して独自のバックオフを行いますが、デコレータが処理するはずの `aiohttp.ClientError` などのネットワークエラーがリトライ上限を超えて送出された場合、`poll_session` 側で捕捉されずにプロセス全体がクラッシュするリスクがあります。
- **沈黙検出の機能不全 (Data Availability)**: `synedrion_review` メソッドにおいて、成功した結果の中に "SILENCE" が含まれるかを `str(r.session)` で判定しようとしています。しかし、`JulesSession` データクラスにはモデルの出力テキスト（response body）が保持されておらず、文字列表現にも含まれないため、この判定ロジックは常に偽となり機能していません。「セッションオブジェクトを見れば出力がわかる」という誤った暗黙の前提に基づいています。
- **レイヤー違反 (Dependency Inversion)**: インフラストラクチャ層（L2）に位置する `jules_client.py` が、ドメイン層の `mekhane.ergasterion.synedrion` に依存し、特定のビジネスロジック（Synedrion v2.1）をハードコードしています。汎用的なAPIクライアントであるべき責務に対し、特定のワークフローへの依存が混入しています。

## 重大度
- Critical

## 沈黙判定
- 発言（要改善）
