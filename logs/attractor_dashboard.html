<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üß† Attractor Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4"></script>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: 'Inter', 'Noto Sans JP', system-ui, sans-serif;
    background: #0a0e17;
    color: #e0e6ed;
    min-height: 100vh;
}
.header {
    background: linear-gradient(135deg, #1a1f35 0%, #0d1321 100%);
    padding: 24px 32px;
    border-bottom: 1px solid rgba(99, 179, 237, 0.15);
}
.header h1 {
    font-size: 1.5rem; font-weight: 600;
    background: linear-gradient(90deg, #63b3ed, #b794f6);
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
}
.header .query {
    color: #a0aec0; font-size: 0.95rem; margin-top: 6px;
    font-style: italic;
}
.metrics {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
    gap: 12px; padding: 20px 32px;
}
.metric-card {
    background: linear-gradient(135deg, #1a2332 0%, #141c2b 100%);
    border: 1px solid rgba(99, 179, 237, 0.1);
    border-radius: 12px; padding: 16px; text-align: center;
}
.metric-value {
    font-size: 1.8rem; font-weight: 700;
    background: linear-gradient(90deg, #63b3ed, #b794f6);
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
}
.metric-label { color: #718096; font-size: 0.75rem; margin-top: 4px; text-transform: uppercase; letter-spacing: 0.05em; }
.grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px; padding: 0 32px 32px;
}
.card {
    background: linear-gradient(135deg, #1a2332 0%, #141c2b 100%);
    border: 1px solid rgba(99, 179, 237, 0.1);
    border-radius: 12px; padding: 20px;
}
.card.full { grid-column: 1 / -1; }
.card h3 {
    font-size: 0.9rem; color: #a0aec0; margin-bottom: 14px; font-weight: 500;
}
canvas { width: 100% !important; }
.flow-table { width: 100%; border-collapse: collapse; font-size: 0.8rem; }
.flow-table th { color: #718096; text-align: left; padding: 6px 8px; border-bottom: 1px solid rgba(255,255,255,0.05); }
.flow-table td { padding: 6px 8px; border-bottom: 1px solid rgba(255,255,255,0.03); }
.flow-table .converged { color: #68d391; }
.inhib-item {
    display: inline-block; margin: 4px;
    background: rgba(252, 129, 129, 0.1);
    border: 1px solid rgba(252, 129, 129, 0.2);
    border-radius: 8px; padding: 4px 10px; font-size: 0.75rem;
}
.inhib-source { color: #63b3ed; font-weight: 600; margin-bottom: 6px; }
.sep-pair {
    display: inline-block; margin: 4px;
    border-radius: 8px; padding: 4px 10px; font-size: 0.75rem;
}
.sep-close { background: rgba(252,129,129,0.1); border: 1px solid rgba(252,129,129,0.2); color: #fc8181; }
.sep-far { background: rgba(104,211,145,0.1); border: 1px solid rgba(104,211,145,0.2); color: #68d391; }
.decomp-seg {
    display: inline-block; margin: 4px;
    background: rgba(99,179,237,0.1);
    border: 1px solid rgba(99,179,237,0.2);
    border-radius: 8px; padding: 4px 10px; font-size: 0.75rem; color: #63b3ed;
}
</style>
</head>
<body>
<div class="header">
    <h1>üß† Attractor Dashboard ‚Äî 24 ÂÆöÁêÜË™çÁü•„Éû„ÉÉ„Éó</h1>
    <div class="query">Query: "Why does this truly exist?"</div>
</div>

<div class="metrics" id="metrics"></div>
<div class="grid" id="charts"></div>

<script>
const D = {"query": "Why does this truly exist?", "theorem_keys": ["O1", "O2", "O3", "O4", "S1", "S2", "S3", "S4", "H1", "H2", "H3", "H4", "P1", "P2", "P3", "P4", "K1", "K2", "K3", "K4", "A1", "A2", "A3", "A4"], "mixture": {"distribution": {"O1": 0.6422949433326721, "O2": 0.02039152756333351, "O3": 0.04836609959602356, "O4": 0.020010722801089287, "S1": 0.006155895069241524, "S2": 0.005048192571848631, "S3": 0.0063300710171461105, "S4": 0.025140982121229172, "H1": 0.020250238478183746, "H2": 0.005312113557010889, "H3": 0.006266213953495026, "H4": 0.023618677631020546, "P1": 0.003871195949614048, "P2": 0.012451320886611938, "P3": 0.009455480612814426, "P4": 0.005692729260772467, "K1": 0.009569047018885612, "K2": 0.002841539680957794, "K3": 0.05167092755436897, "K4": 0.011704306118190289, "A1": 0.004497943911701441, "A2": 0.017476750537753105, "A3": 0.013209158554673195, "A4": 0.028373872861266136}, "entropy": 0.5246999859809875, "dominant_series": "O", "series_distribution": {"O": 0.7311, "S": 0.0427, "H": 0.0554, "P": 0.0315, "K": 0.0758, "A": 0.0636}}, "suggest": [{"theorem": "K3", "name": "Telos (ÁõÆÁöÑ)", "sim": 0.4246}, {"theorem": "O3", "name": "Zƒìtƒìsis (Êé¢Ê±Ç)", "sim": 0.4213}, {"theorem": "A4", "name": "Epistƒìmƒì (Áü•Ë≠ò)", "sim": 0.3946}, {"theorem": "S4", "name": "Praxis (ÂÆüË∑µ)", "sim": 0.3885}, {"theorem": "H4", "name": "Doxa (‰ø°Âøµ)", "sim": 0.3854}, {"theorem": "O1", "name": "Noƒìsis (Ê∑±„ÅÑË™çË≠ò)", "sim": 0.3854}, {"theorem": "O2", "name": "Boulƒìsis (ÊÑèÂøó)", "sim": 0.3781}, {"theorem": "H1", "name": "Propatheia (ÂâçÊÑüÊÉÖ)", "sim": 0.3777}, {"theorem": "O4", "name": "Energeia (Ë°åÁÇ∫)", "sim": 0.3771}, {"theorem": "A2", "name": "Krisis (Âà§ÂÆö)", "sim": 0.3704}, {"theorem": "A3", "name": "Gn≈çmƒì (Ê†ºË®Ä)", "sim": 0.3564}, {"theorem": "P2", "name": "Hodos (ÈÅì)", "sim": 0.3534}, {"theorem": "K4", "name": "Sophia (Áü•ÊÅµ)", "sim": 0.3503}, {"theorem": "K1", "name": "Eukairia (Â•ΩÊ©ü)", "sim": 0.3402}, {"theorem": "P3", "name": "Trokhia (ËªåÈÅì)", "sim": 0.3396}, {"theorem": "S3", "name": "Stathmos (Âü∫Ê∫ñ)", "sim": 0.3196}, {"theorem": "H3", "name": "Orexis (Ê¨≤Ê±Ç)", "sim": 0.3191}, {"theorem": "S1", "name": "Metron (Â∞∫Â∫¶)", "sim": 0.3182}, {"theorem": "P4", "name": "Tekhnƒì (ÊäÄÊ≥ï)", "sim": 0.3143}, {"theorem": "H2", "name": "Pistis (Á¢∫‰ø°)", "sim": 0.3108}, {"theorem": "S2", "name": "Mekhanƒì (ÊñπÊ≥ï)", "sim": 0.3083}, {"theorem": "A1", "name": "Pathos (ÊÉÖÂøµ)", "sim": 0.3025}, {"theorem": "P1", "name": "Kh≈çra (Â†¥)", "sim": 0.295}, {"theorem": "K2", "name": "Chronos (ÊôÇÈñì)", "sim": 0.2795}], "multiview": [{"theorem": "O1", "name": "Noƒìsis (Ê∑±„ÅÑË™çË≠ò)", "sim": 0.538}, {"theorem": "K3", "name": "Telos (ÁõÆÁöÑ)", "sim": 0.4454}, {"theorem": "O3", "name": "Zƒìtƒìsis (Êé¢Ê±Ç)", "sim": 0.4389}, {"theorem": "H4", "name": "Doxa (‰ø°Âøµ)", "sim": 0.4267}, {"theorem": "A4", "name": "Epistƒìmƒì (Áü•Ë≠ò)", "sim": 0.4222}, {"theorem": "O2", "name": "Boulƒìsis (ÊÑèÂøó)", "sim": 0.4085}, {"theorem": "O4", "name": "Energeia (Ë°åÁÇ∫)", "sim": 0.4076}, {"theorem": "S4", "name": "Praxis (ÂÆüË∑µ)", "sim": 0.4034}, {"theorem": "K4", "name": "Sophia (Áü•ÊÅµ)", "sim": 0.4015}, {"theorem": "H1", "name": "Propatheia (ÂâçÊÑüÊÉÖ)", "sim": 0.3962}, {"theorem": "P2", "name": "Hodos (ÈÅì)", "sim": 0.3848}, {"theorem": "A2", "name": "Krisis (Âà§ÂÆö)", "sim": 0.384}, {"theorem": "K1", "name": "Eukairia (Â•ΩÊ©ü)", "sim": 0.3729}, {"theorem": "A3", "name": "Gn≈çmƒì (Ê†ºË®Ä)", "sim": 0.3725}, {"theorem": "P3", "name": "Trokhia (ËªåÈÅì)", "sim": 0.3627}, {"theorem": "H2", "name": "Pistis (Á¢∫‰ø°)", "sim": 0.3623}, {"theorem": "H3", "name": "Orexis (Ê¨≤Ê±Ç)", "sim": 0.3536}, {"theorem": "S3", "name": "Stathmos (Âü∫Ê∫ñ)", "sim": 0.3426}, {"theorem": "S1", "name": "Metron (Â∞∫Â∫¶)", "sim": 0.3404}, {"theorem": "P4", "name": "Tekhnƒì (ÊäÄÊ≥ï)", "sim": 0.3348}, {"theorem": "S2", "name": "Mekhanƒì (ÊñπÊ≥ï)", "sim": 0.33}, {"theorem": "A1", "name": "Pathos (ÊÉÖÂøµ)", "sim": 0.329}, {"theorem": "P1", "name": "Kh≈çra (Â†¥)", "sim": 0.3251}, {"theorem": "K2", "name": "Chronos (ÊôÇÈñì)", "sim": 0.3062}], "flows": {"excite": {"label": "Excitation-Only", "converged": 5, "states": [{"step": 0, "top3": [["O1", 0.07784165441989899], ["K3", 0.0511443167924881], ["O3", 0.05058400332927704]]}, {"step": 1, "top3": [["H4", 0.07450538128614426], ["H1", 0.0741288885474205], ["S4", 0.07338432967662811]]}, {"step": 2, "top3": [["K3", 0.08048807084560394], ["H4", 0.08009350299835205], ["H2", 0.08005277812480927]]}, {"step": 3, "top3": [["K2", 0.08380718529224396], ["K3", 0.08335381746292114], ["H2", 0.08322618156671524]]}, {"step": 4, "top3": [["K2", 0.08528926223516464], ["H2", 0.08425832539796829], ["K3", 0.08422964811325073]]}, {"step": 5, "top3": [["K2", 0.08575785160064697], ["H2", 0.08459585905075073], ["K3", 0.08449157327413559]]}]}, "ei_02": {"label": "E/I (Œ≤=0.2)", "converged": 4, "states": [{"step": 0, "top3": [["O1", 0.07784165441989899], ["K3", 0.0511443167924881], ["O3", 0.05058400332927704]]}, {"step": 1, "top3": [["H4", 0.08251399546861649], ["S4", 0.0818973258137703], ["H1", 0.08040520548820496]]}, {"step": 2, "top3": [["H2", 0.08557888865470886], ["K3", 0.08523809164762497], ["H3", 0.08519311249256134]]}, {"step": 3, "top3": [["K2", 0.08613905310630798], ["H2", 0.08572964370250702], ["K3", 0.08554212749004364]]}, {"step": 4, "top3": [["K2", 0.0866050198674202], ["H2", 0.08621588349342346], ["H3", 0.08551216870546341]]}]}, "ei_04": {"label": "E/I (Œ≤=0.4)", "converged": 4, "states": [{"step": 0, "top3": [["O1", 0.07784165441989899], ["K3", 0.0511443167924881], ["O3", 0.05058400332927704]]}, {"step": 1, "top3": [["S4", 0.08868639171123505], ["H4", 0.0884796530008316], ["H3", 0.08578775078058243]]}, {"step": 2, "top3": [["K3", 0.08749216049909592], ["H2", 0.08619259297847748], ["H3", 0.0857454314827919]]}, {"step": 3, "top3": [["H2", 0.08778437972068787], ["H3", 0.08699825406074524], ["K2", 0.08683627098798752]]}, {"step": 4, "top3": [["H2", 0.08843672275543213], ["K2", 0.08761639147996902], ["H3", 0.08752072602510452]]}]}}, "inhibition": {"K3": [["H1", 0.0538], ["P4", 0.0482], ["S2", 0.0482], ["O1", 0.048], ["P1", 0.0478]], "O3": [["P1", 0.0506], ["H1", 0.0502], ["P4", 0.05], ["S3", 0.0485], ["O4", 0.0475]], "A4": [["P3", 0.0531], ["K2", 0.0522], ["P1", 0.052], ["H1", 0.0511], ["S1", 0.0497]]}, "decomposition": {"divergence": 0.0, "segments": [{"text": "Why does this truly exist?", "top": "O3"}]}, "separation": {"avg": 0.4185, "min": 0.255, "max": 0.5668, "closest": [["O4", "S4", 0.255], ["H3", "A1", 0.2756], ["K4", "A4", 0.2762], ["O3", "K4", 0.2806], ["K1", "K2", 0.2807]], "farthest": [["S2", "H1", 0.5526], ["O4", "H1", 0.5553], ["H1", "P3", 0.5556], ["H1", "P1", 0.5646], ["O1", "P4", 0.5668]]}};
const COLORS = {"O": "#e74c3c", "S": "#3498db", "H": "#f39c12", "P": "#2ecc71", "K": "#9b59b6", "A": "#1abc9c"};

// --- Metrics ---
const metricsEl = document.getElementById('metrics');
const metrics = [
    { label: 'Entropy', value: D.mixture.entropy.toFixed(2) },
    { label: 'Dominant', value: D.mixture.dominant_series },
    { label: 'Top-1', value: D.suggest[0].theorem },
    { label: 'MV Top-1', value: D.multiview[0].theorem },
    { label: 'Divergence', value: D.decomposition.divergence.toFixed(2) },
    { label: 'Sep (avg)', value: D.separation.avg.toFixed(3) },
];
metricsEl.innerHTML = metrics.map(m => `
    <div class="metric-card">
        <div class="metric-value">${m.value}</div>
        <div class="metric-label">${m.label}</div>
    </div>`).join('');

// --- Charts Grid ---
const chartsEl = document.getElementById('charts');

// 1. Mixture Bar Chart
chartsEl.innerHTML += `<div class="card"><h3>üî¨ Mixture Distribution (T=0.05)</h3><canvas id="mixChart" height="200"></canvas></div>`;
// 2. Series Pie
chartsEl.innerHTML += `<div class="card"><h3>üìä Series Distribution</h3><canvas id="seriesChart" height="200"></canvas></div>`;
// 3. Flow Comparison Table
chartsEl.innerHTML += `<div class="card full"><h3>üåä Flow Comparison ‚Äî Excitation vs E/I</h3><div id="flowTable"></div></div>`;
// 4. Inhibition Network
chartsEl.innerHTML += `<div class="card"><h3>üö´ Inhibition Network (Q7)</h3><div id="inhibDiv"></div></div>`;
// 5. Separation
chartsEl.innerHTML += `<div class="card"><h3>üìè Basin Separation (Q1)</h3><div id="sepDiv"></div></div>`;
// 6. Decomposition
chartsEl.innerHTML += `<div class="card full"><h3>üîç Segment Decomposition (Q6)</h3><div id="decompDiv"></div></div>`;

// --- Mixture Bar ---
const mixCtx = document.getElementById('mixChart').getContext('2d');
const mixLabels = Object.keys(D.mixture.distribution);
const mixValues = Object.values(D.mixture.distribution);
const mixColors = mixLabels.map(t => COLORS[t[0]] || '#7f8c8d');
new Chart(mixCtx, {
    type: 'bar',
    data: {
        labels: mixLabels,
        datasets: [{ data: mixValues, backgroundColor: mixColors, borderWidth: 0 }]
    },
    options: {
        responsive: true, indexAxis: 'y',
        scales: {
            x: { grid: { color: 'rgba(255,255,255,0.03)' }, ticks: { color: '#718096' } },
            y: { ticks: { color: '#a0aec0', font: { size: 10 } } }
        },
        plugins: { legend: { display: false } }
    }
});

// --- Series Pie ---
const seriesCtx = document.getElementById('seriesChart').getContext('2d');
const seriesLabels = Object.keys(D.mixture.series_distribution);
const seriesValues = Object.values(D.mixture.series_distribution);
new Chart(seriesCtx, {
    type: 'doughnut',
    data: {
        labels: seriesLabels,
        datasets: [{
            data: seriesValues,
            backgroundColor: seriesLabels.map(s => COLORS[s] || '#7f8c8d'),
            borderWidth: 0
        }]
    },
    options: { responsive: true, plugins: { legend: { position: 'bottom', labels: { color: '#a0aec0' } } } }
});

// --- Flow Table ---
const flowDiv = document.getElementById('flowTable');
let html = '<table class="flow-table"><tr><th>Step</th>';
for (const key of ['excite', 'ei_02', 'ei_04']) {
    html += `<th>${D.flows[key].label}</th>`;
}
html += '</tr>';
const maxSteps = Math.max(...Object.values(D.flows).map(f => f.states.length));
for (let i = 0; i < Math.min(maxSteps, 8); i++) {
    html += `<tr><td>${i}</td>`;
    for (const key of ['excite', 'ei_02', 'ei_04']) {
        const st = D.flows[key].states[i];
        if (st) {
            const tops = st.top3.map(([t, v]) => `${t}(${v.toFixed(3)})`).join(' ');
            const cls = D.flows[key].converged === i ? 'converged' : '';
            html += `<td class="${cls}">${tops}</td>`;
        } else {
            html += '<td>‚Äî</td>';
        }
    }
    html += '</tr>';
}
html += '</table>';
flowDiv.innerHTML = html;

// --- Inhibition ---
const inhibDiv = document.getElementById('inhibDiv');
let inhibHtml = '';
for (const [src, pairs] of Object.entries(D.inhibition)) {
    inhibHtml += `<div class="inhib-source">${src} ‚ä£</div>`;
    pairs.forEach(([tgt, str]) => {
        inhibHtml += `<span class="inhib-item">${tgt} (${str.toFixed(3)})</span>`;
    });
    inhibHtml += '<br>';
}
inhibDiv.innerHTML = inhibHtml;

// --- Separation ---
const sepDiv = document.getElementById('sepDiv');
let sepHtml = '<b style="color:#fc8181">Closest:</b><br>';
D.separation.closest.forEach(([t1, t2, d]) => {
    sepHtml += `<span class="sep-pair sep-close">${t1}-${t2}: ${d}</span>`;
});
sepHtml += '<br><br><b style="color:#68d391">Farthest:</b><br>';
D.separation.farthest.forEach(([t1, t2, d]) => {
    sepHtml += `<span class="sep-pair sep-far">${t1}-${t2}: ${d}</span>`;
});
sepDiv.innerHTML = sepHtml;

// --- Decomposition ---
const decompDiv = document.getElementById('decompDiv');
let decompHtml = `<div style="margin-bottom:8px; color:#718096">Divergence: ${D.decomposition.divergence}</div>`;
D.decomposition.segments.forEach(seg => {
    decompHtml += `<span class="decomp-seg">"${seg.text}" ‚Üí ${seg.top}</span>`;
});
decompDiv.innerHTML = decompHtml;
</script>
</body>
</html>