# Dendron Vision — 存在目的証明エンジン

> **δένδρον** (déndron) = 木
> 「存在目的の木を走査し、無駄を排除し、必要なものを証明する」

---

## 1. 哲学的基盤

### 1.1 目的論 (Teleology)

Dendron は**目的因 (Final Cause)** を問う。

アリストテレスの四原因説:

| 原因 | 問い | Dendron での扱い |
|:-----|:-----|:-----------------|
| 質料因 | 何からできているか | (対象外) |
| 形相因 | 何であるか | 表層で宣言 |
| **作用因** | 何によって生まれたか | **理由 = 背景情報** |
| **目的因** | 何のためにあるか | **目的 = 存在意義** |

> **理由 (Reason)** = 経緯。過去→現在。材料。
> **目的 (Purpose)** = 志向性。現在→未来。本質。
>
> **Dendron が問うのは目的。理由は補助。**

### 1.2 存在誤差最小化 (Existence Error Minimization)

FEP が**予測誤差**を最小化するように、Dendron は**存在誤差**を最小化する。

```
FEP:     現実 - 予測 = 予測誤差 → 最小化
Dendron: 存在 - 目的 = 存在誤差 → 最小化
```

**存在誤差** = 「存在するが目的がないもの」 = **無駄**

### 1.3 正規化 = 演繹 = 無駄の排除

| 正規形 | DB における意味 | Dendron における意味 |
|:-------|:----------------|:--------------------|
| NF0 | 非正規 | 目的宣言なし |
| NF1 | 単純依存排除 | 表層: 目的が宣言されている |
| NF2 | 部分依存排除 | 構造層: 依存が明示されている |
| NF3 | 推移依存排除 | 機能層: 冗長がない |
| BCNF | 完全正規 | 実証層: 削除不可が証明されている |

**正規化 ≈ 演繹 ≈ 無駄の排除 ≈ Dendron の存在意義**

### 1.4 自己言及性

Dendron 自身も Dendron の対象である。循環は設計上の特徴。

### 1.5 FEP ↔ Dendron 同型 (式の展開)

Dendron は FEP の「存在」座標への射影である。両者は同じ変分原理の異なる表現。

```
誤差 = 観測 - モデル

FEP:     予測誤差 = 現実 - 期待   → 知覚・行動の最適化
Dendron: 存在誤差 = 存在 - 目的   → コード・構造の最適化
```

**Hegemonikón における位置づけ**:

```
FEP (自由エネルギー原理)
    │
    ├──→ 知覚: 予測誤差最小化
    ├──→ 行動: Active Inference
    ├──→ 記憶: Mnēmē (エピソード→セマンティック)
    ├──→ 認知: CCL (Cognitive Control Language)
    └──→ 存在: Dendron (存在誤差最小化) ← 同型定理
```

**Dendron は Hegemonikón の別の表現であり、同じ公理体系から導出されるもう一つの定理群。**

---

## 2. マトリクス構造

### 2.1 三軸テンソルモデル

**EPT (Existence Purpose Tensor)**

```
EPT[Depth, Meta, Temporal]

軸1: Depth (L0-L3)     — 走査の深さ
軸2: Meta (4層)        — 検証の種類
軸3: Temporal (2値)    — 理由/目的
```

### 2.2 Depth Layer (深さ)

| Depth | 対象 | FEP 層 |
|:------|:-----|:-------|
| L0 | ディレクトリ | Kairos (K) — 文脈 |
| L1 | ファイル | Ousia/Schema (O/S) — 本質 |
| L2 | 関数・クラス | Hormē/Perigraphē (H/P) — 動機 |
| L3 | 変数・字句 | Akribeia (A) — 精密 |

### 2.3 Meta Layer (検証の種類)

| Meta Layer | 問い | 検証方法 | 正規形 |
|:-----------|:-----|:---------|:-------|
| 表層 (Surface) | 何があるか | PROOF 宣言 | NF1 |
| 構造層 (Structure) | どう繋がるか | 依存グラフ | NF2 |
| 機能層 (Function) | 何が同じか | 類似度分析 | NF3 |
| 実証層 (Verification) | 本当に必要か | 削除テスト | BCNF |

### 2.4 Temporal Layer (時間) — Reason/Purpose 分析フレームワーク v2.0

| 時間軸 | 問い | 役割 | 視点 |
|:-------|:-----|:-----|:-----|
| **Purpose (目的)** | 何のためにあるか | **主役** — 存在意義 | 未来 |
| Reason (理由) | なぜ生まれたか | 補助 — 背景情報 | 過去 |

#### 2.4.1 Reason vs Purpose 比較表

| 項目 | Reason (理由) | Purpose (目的) |
|:-----|:--------------|:---------------|
| **ニュアンス** | 背景・根拠・原因 | 目標・ゴール・意図 |
| **視点** | 過去・現在（なぜ？） | 未来（何のために？） |
| **文末表現** | ～から。～なので | ～ため。～の目的で |
| **役割** | 行動を起こした背景 | 行動によって目指す先 |
| **同義語** | 原因、事情、根拠、きっかけ | 目標、意図、ゴール、狙い |

#### 2.4.2 コード存在証明における適用

```text
Reason (経緯):
  「このモジュールは2026-01-15に API 変更対応として作成された」
  「レガシーシステムとの互換性のために残っている」

Purpose (目的):
  「ユーザー認証を一元化し、セキュリティを担保する」
  「API レスポンスを正規化してクライアント依存を排除する」
```

> **🔴 重要**: 存在誤差 = 存在 - 目的
> Reason があっても Purpose がなければ、そのコードは**無駄**である。

#### 2.4.3 Jules 定時タスク用チェックリスト

| # | チェック項目 | 判定 |
|:--|:-------------|:-----|
| 1 | Purpose が明示されているか | ✅/❌ |
| 2 | Reason が記録されているか | ✅/❌ |
| 3 | Purpose は現在も有効か（時代遅れではないか） | ✅/❌ |
| 4 | Reason と Purpose の間に論理的整合性があるか | ✅/❌ |
| 5 | 削除しても Purpose が達成されるか（冗長性テスト） | ✅/❌ |

#### 2.4.4 DB正規化 との対応 (MECE原則)

| 正規形 | DB における意味 | Reason/Purpose 観点 |
|:-------|:----------------|:--------------------|
| NF1 | 原子値のみ | Purpose が単一・明確 |
| NF2 | 部分依存排除 | Reason が Purpose に従属（逆転禁止） |
| NF3 | 推移依存排除 | 間接的な Purpose は明示的に分離 |
| BCNF | 決定項が候補キー | Purpose が存在の唯一の決定要因 |

> **洞察**: DB正規化 ≒ チャンク(カード)構成要素の MECE 化 ≒ 存在誤差最小化

#### 2.4.5 変更差分レポートフォーマット

```text
## 変更差分レポート: {対象名}

### 変更前
- **Reason (経緯)**: {変更前の存在理由}
- **Purpose (目的)**: {変更前の目的}

### 変更後
- **Reason (経緯)**: {変更後の存在理由（変更の背景）}
- **Purpose (目的)**: {変更後の目的}

### 差分分析
- **Reason の変化**: {経緯の更新内容}
- **Purpose の変化**: {目的の変更・強化・削除}
- **存在誤差の変化**: {増減と理由}
```

### 2.5 完全テンソル (32セル)

```
                        Purpose (目的)              Reason (理由)
                    ┌────────────────────┐     ┌────────────────────┐
                    表層  構造  機能  実証       表層  構造  機能  実証
              ┌────┬────┬────┬────┬────┐ ┌────┬────┬────┬────┬────┐
    L0 (Dir)  │ P00│ P01│ P02│ P03│    │ R00│ R01│ R02│ R03│
              ├────┼────┼────┼────┤    ├────┼────┼────┼────┤
    L1 (File) │ P10│ P11│ P12│ P13│    │ R10│ R11│ R12│ R13│
              ├────┼────┼────┼────┤    ├────┼────┼────┼────┤
    L2 (Func) │ P20│ P21│ P22│ P23│    │ R20│ R21│ R22│ R23│
              ├────┼────┼────┼────┤    ├────┼────┼────┼────┤
    L3 (Var)  │ P30│ P31│ P32│ P33│    │ R30│ R31│ R32│ R33│
              └────┴────┴────┴────┘    └────┴────┴────┴────┘

    P = Purpose (主役)    R = Reason (背景)
    
    セル総数: 4 × 4 × 2 = 32
```

---

## 3. 数学的基盤

### 3.1 束論 (Lattice Theory)

- **Depth の順序**: L0 ⊃ L1 ⊃ L2 ⊃ L3 (完備束)
- **包含関係**: ディレクトリ ∋ ファイル ∋ 関数 ∋ 変数
- **上限・下限**: 最小共通祖先、最大共通子孫

### 3.2 ホモロジー代数

- **構造層**: チェーン複体として形式化
- **循環検出**: ホモロジー群の計算
- **穴の発見**: 依存関係の断裂

### 3.3 圏論

- **対象**: ファイル、関数、変数
- **射**: import, call, reference
- **関手**: Meta Layer 間の構造保存写像

---

## 4. 成功の定義

### 4.1 定量指標

| 指標 | 目標値 |
|:-----|:-------|
| テンソルカバレッジ | 32/32 セル実装 |
| Hegemonikón 内 BCNF 率 | 100% |
| 存在誤差 | 0 (全コードに目的あり) |

### 4.2 定性指標

- 「コードが自己の存在目的を知っている」状態
- 「無駄なコードが存在できない」環境
- **AI生成コードの品質保証**

---

## 5. Anti-Vision (やらないこと)

- ❌ コードの自動生成 (Dendron は検証のみ)
- ❌ テストの代替 (Dendron は存在証明であり動作証明ではない)
- ❌ **一般化のための一般化** (Hegemonikón 最優先。一般化は結果として起こる)
- ❌ 過去の正当化 (理由は背景、目的が本質)

---

## 6. 原則

1. **目的 > 理由**: 目的因が本質、作用因は材料
2. **正規化 = 演繹**: 無駄の排除が存在意義
3. **FEP 同型**: Dendron は FEP の存在座標への射影（式の展開）
4. **自己言及**: Dendron は Dendron 自身を検証する
5. **32セルの価値**: 複雑さは価値の反映
6. **Hegemonikón 優先**: 一般化は目的ではなく結果

---

## 7. 志向性の検証系 — Creator の定式化 (2026-02-13)

> **「要素（コードやファイル）を"主体化"して、その主体の FEP における運動（行為可能性）の内容が全体の運動と合致しているかを問う」** — Creator

### 7.1 定式化

コード（プログラムの"部品"）には、必ず存在する意味（目的）がある。
言わば全体の中のポジションがある。
**全体に貢献しないもの ≒ その存在意義を証明できないもの**。

各コード要素を **Markov Blanket で囲まれた系** として主体化する:

```
各コード要素 = 主体 (Markov Blanket)
  ├─ 内部状態: 実装ロジック
  ├─ 感覚状態: import, パラメータ (外からの入力)
  ├─ 行為状態: return, 副作用 (外への出力)
  └─ 生成モデル: PURPOSE / REASON ← これが「志向性」の明示化

Dendron の役割 = 各要素の生成モデル (PURPOSE/REASON) が
  1. 存在するか (NF1)
  2. 構造的に健全か (NF2)
  3. 親の生成モデルと整合するか (NF3) ← 志向性の合致
  4. 自明でないか (BCNF)
```

### 7.2 §1 との統合

| §1 (v3.0) | §7 (v4.0) | 関係 |
|:-----------|:----------|:-----|
| 存在誤差 = 存在 - 目的 | 志向性不整合 = 要素の方向 - 全体の方向 | **静的→動的へ拡張** |
| コードに目的があるか | コードの志向性が全体と合致するか | **有無→方向の検証** |
| 目的論 (Final Cause) | FEP の Active Inference | **哲学→科学的定式化** |

> **NF3 こそが「志向性の合致」の検証**。子の PURPOSE/REASON が親の PURPOSE/REASON と重複していたら、「全体にぶら下がっているだけ」—— 独自の志向性がない。

### 7.3 Git アナロジー — 外部価値

> 「Dendron は HGK なしで意味を持つ — Linux の Git と同じになればいい」— Creator

Git は「バージョン管理」を普遍化した。Dendron は「存在証明」を普遍化できる。

| HGK 語彙 | 一般化 | 普遍的な問い |
|:---------|:------|:-----------|
| PROOF.md | Module Manifest | このディレクトリは何のためにあるか |
| # PURPOSE: | Intent Comment | この関数はなぜ存在するか |
| # REASON: | Rationale Comment | なぜこの設計判断をしたか |

### 7.4 段階的志向性 (Graduated Intentionality)

**Auto-Fix ではなく Auto-Suggest**。LLM の PURPOSE は「観察に基づく推定」であり、人間の PURPOSE は「意図の表明」。認識論的に異なる。

```python
# PURPOSE: [SOURCE] データを正規化し、後続の分析パイプラインに渡す  ← 人間が確定
# PURPOSE: [SUGGEST] この関数はデータを正規化しているように見えます   ← LLM 提案、承認待ち
```

| | LLM が書く PURPOSE | 人間が書く PURPOSE |
|:--|:---|:---|
| FEP 的に | 事後確率 P(目的\|コード) | 事前分布 P(目的) |
| BC-6 的に | TAINT (間接情報) | SOURCE (直接情報) |
| 価値 | ないよりはるかにマシ | 最高品質 |

---

## 8. 戦略ロードマップ (2026-02-13)

### 8.1 完了済み

| Wave | 内容 | 状態 |
|:-----|:-----|:-----|
| Wave 1-3 | NF1 表面 + NF2 構造 + NF3/BCNF セマンティック | ✅ 117 tests |
| Wave 4 | アンチウイルス化 (3層運用) | ✅ |

### 8.2 アンチウイルス体制 (稼働中)

| 層 | 実装 | 頻度 |
|:---|:-----|:-----|
| リアルタイム | `dendron guard` + `@vet` マクロ | 実装完了時 |
| 日次スキャン | `dendron_guard.sh` (hegemonikon) | cron AM3:00 |
| 週次 "雑草刈り" | `dendron_guard.sh --full` (oikos 全体) | cron 日曜 AM2:00 |

### 8.3 今後の方向性 (/bou+*%/zet+ による判定)

| 優先度 | 施策 | 内容 | 判定理由 |
|:-------|:-----|:-----|:---------|
| **短期** | ③ Pre-commit hook | `git commit` 時に guard 自動実行 | 予防 > 検出 |
| **短期** | ② Trend dashboard | JSON 時系列 → 品質変化の可視化 | cron 蓄積の活用 |
| **中期** | `dendron suggest` | PURPOSE 叩き台生成 (SUGGEST ラベル) | Auto-Fix ではなく提案 |
| **中期** | `/dev` 統合 | 開発開始時に PURPOSE を問う | 検出から予防へ |
| **長期** | ⑤ Agora 公開 | OSS 化 — 「存在証明」の普遍化 | Git アナロジー |
| **棄却** | ④ EPT 理論深化 | 学術的に美しいが実用上 NF1 で80%カバー | Pareto |
| **慎重** | ① Auto-Fix | WHY の自動化は核を破壊するリスク | 志向性の本質 |

### 8.4 Anti-Vision (§5 への追加)

- ❌ **WHY の自動化**: PURPOSE を自動生成してはならない。提案 (SUGGEST) は許容するが、確定 (SOURCE) は人間のみ
- ❌ **検出の形骸化**: 全チェックを通すことが目的ではない。PURPOSE を書く行為そのものが思考を促進する

---

*Origin: Hegemonikón FEP + 2026-02-01 Insight + 2026-02-03 Refinement + 2026-02-06 Reason/Purpose拡張 + 2026-02-13 志向性定式化*
*Version: 4.0*
*Date: 2026-02-13*
