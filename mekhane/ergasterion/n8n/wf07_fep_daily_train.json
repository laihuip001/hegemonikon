{
    "name": "WF-07: FEP Daily Training",
    "nodes": [
        {
            "parameters": {
                "rule": {
                    "interval": [
                        {
                            "triggerAtHour": 6,
                            "triggerAtMinute": 0
                        }
                    ]
                }
            },
            "id": "schedule-trigger",
            "name": "‚è∞ Daily 6:00",
            "type": "n8n-nodes-base.scheduleTrigger",
            "typeVersion": 1,
            "position": [
                240,
                300
            ]
        },
        {
            "parameters": {
                "jsCode": "const { execSync } = require('child_process');\n\ntry {\n  const result = execSync(\n    'cd /home/makaron8426/oikos/hegemonikon && .venv/bin/python scripts/e2e_daily_train.py --rounds 5 --notify 2>&1',\n    { timeout: 300000, encoding: 'utf-8' }\n  );\n  \n  // Extract key metrics from output\n  const lines = result.split('\\n');\n  const actLine = lines.find(l => l.includes('Act:')) || '';\n  const entropyLine = lines.find(l => l.includes('entropy')) || '';\n  \n  return [{\n    json: {\n      status: 'success',\n      output: result.slice(-500),\n      actLine,\n      entropyLine,\n      timestamp: new Date().toISOString()\n    }\n  }];\n} catch (e) {\n  return [{\n    json: {\n      status: 'error',\n      error: e.message.slice(-300),\n      timestamp: new Date().toISOString()\n    }\n  }];\n}"
            },
            "id": "run-training",
            "name": "üß† Run E2E Training",
            "type": "n8n-nodes-base.code",
            "typeVersion": 2,
            "position": [
                460,
                300
            ]
        },
        {
            "parameters": {
                "conditions": {
                    "string": [
                        {
                            "value1": "={{ $json.status }}",
                            "operation": "equals",
                            "value2": "error"
                        }
                    ]
                }
            },
            "id": "check-error",
            "name": "‚ùì Error?",
            "type": "n8n-nodes-base.if",
            "typeVersion": 1,
            "position": [
                680,
                300
            ]
        },
        {
            "parameters": {
                "method": "POST",
                "url": "={{ $env.SLACK_WEBHOOK_URL || '' }}",
                "sendBody": true,
                "bodyParameters": {
                    "parameters": [
                        {
                            "name": "text",
                            "value": "‚ùå *FEP Daily Training Failed*\n```{{ $json.error }}```"
                        }
                    ]
                }
            },
            "id": "notify-error",
            "name": "üî¥ Slack Error",
            "type": "n8n-nodes-base.httpRequest",
            "typeVersion": 4,
            "position": [
                900,
                200
            ]
        }
    ],
    "connections": {
        "‚è∞ Daily 6:00": {
            "main": [
                [
                    {
                        "node": "üß† Run E2E Training",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "üß† Run E2E Training": {
            "main": [
                [
                    {
                        "node": "‚ùì Error?",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "‚ùì Error?": {
            "main": [
                [
                    {
                        "node": "üî¥ Slack Error",
                        "type": "main",
                        "index": 0
                    }
                ],
                []
            ]
        }
    },
    "settings": {
        "executionOrder": "v1"
    },
    "meta": {
        "description": "FEP Dirichlet daily learning ‚Äî ÊØéÊúù6:00„Å´E2E v2„É´„Éº„Éó„Çí5roundsÂÆüË°å„Åó„ÄÅAË°åÂàó„ÇíËÇ≤„Å¶„Çã"
    }
}