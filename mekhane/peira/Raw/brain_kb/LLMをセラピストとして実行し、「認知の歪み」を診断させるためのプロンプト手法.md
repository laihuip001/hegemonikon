---
created: 2026-01-01T09:29:59 (UTC +09:00)
tags: []
source: https://ai-data-base.com/archives/56696
author: AIDB Research
---

# LLMをセラピストとして実行し、「認知の歪み」を診断させるためのプロンプト手法 - AIDB

> ## Excerpt
> 近年、精神療法の領域でAIの活用に注目が集まっています。そんな中、新たなフレームワークが考案されました。LLMによって人々の「認知の歪み」を診断する目的に特化しており、専門家によって高く評価されています。 認知の歪みとは、例えば「0か100か」のような極端な考え方や、他人の考えを勝手に推測するなど、不健康な思考パターンのことを指します。 フレームワークを用いた診断結果は、人間の専門家が出す診断結果…

---
近年、精神療法の領域でAIの活用に注目が集まっています。そんな中、新たなフレームワークが考案されました。LLMによって人々の「認知の歪み」を診断する目的に特化しており、専門家によって高く評価されています。

認知の歪みとは、例えば「0か100か」のような極端な考え方や、他人の考えを勝手に推測するなど、不健康な思考パターンのことを指します。

フレームワークを用いた診断結果は、人間の専門家が出す診断結果とも高い一致性を示しており、その有用性が確認されています。

（追記）なお、本フレームワークに基づくGPTsを作成しました。記事末尾にURLを記載するため、興味のある方はぜひお試しください。

![[LLMをセラピストとして実行し、「認知の歪み」を診断させるためのプロンプト手法 - AIDB/AIDB_56696-1024x576.png]]

## 背景

メンタルヘルスは現代社会において非常に重要な問題です。[世界保健機関（WHO）によれば](https://www.who.int/news-room/fact-sheets/detail/mental-disorders)、世界中で約8人に1人が何らかの精神的な障害を持っています。

さらに[WHO資料によると](https://www.who.int/news/item/08-10-2021-who-report-highlights-global-shortfall-in-investment-in-mental-health#:~:text=Global%20estimates%20of%20people%20receiving,health%20promotion%2C%20but%20effectiveness%20questionable)、特定の精神健康状態を持つ人々のケアを受けるグローバルな推定値は50％未満であり、うつ病の人々の40％、精神病の人々の29％がケアを受けているとのことです。精神的な健康問題に対する対応は十分とは言えません。専門家の不足、サービスの質の低さ、高額な治療費、社会的な偏見などが主な理由です。

上記の背景から、さまざまな機関によってメンタルヘルス支援の自動化システムが開発されています。しかし現在のシステムは、感情分析や共感に特化しています。患者の思考や認知を深く理解し、モデル化する能力に欠けていると考えられています。

多くの既存研究は、テキスト内容から一般的な精神的健康問題（例：うつ病、不安）を識別することを目的としています。また、対話構造の研究も行われていますが、専門的な精神療法の知識に基づいた深い調査が不足しています。

「認知の歪み」検出は、認知行動療法（CBT）などのクラシックな治療手法で重要な要素です。しかし、この分野で使用可能な高品質なデータセットは非常に少なく、多くのデータはプライバシーの問題から公開されていません。これが、AIを用いた精神療法研究の大きな障壁となっています。

上記の課題を解決するための新しい手法やフレームワークの開発が必要とされています。

そこで本記事で紹介するのは、LLMに特定のプロンプトフレームワークを適用することで、認知行動療法に近いタスクを行わせる実験の結果です。

ここから限定コンテンツ

![[LLMをセラピストとして実行し、「認知の歪み」を診断させるためのプロンプト手法 - AIDB/AIDB_56696_6-1024x532.png]]

認知の歪みの詳細な例

## 『Diagnosis of Thought (DoT)』フレームワーク

上述の背景から研究者らは、精神的な健康問題を診断するための新しいフレームワーク『Diagnosis of Thought (DoT)』を開発しました。このフレームワークは、Large Language Model（LLM）を用いて、ユーザーの「認知の歪み」を評価および分類するためのものです。

### フレームワークの3つのフェーズ

DoTフレームワークは、以下の3つのフェーズで患者と対話します。

#### 1\. 主観性評価（Subjectivity Assessment）

まず、ユーザーの発言から事実と主観を分離します。具体的には、ユーザーの発言に含まれる客観的な事実と主観的な解釈や意見を識別します。

#### 2\. 対比的推論（Contrastive Reasoning）

次に、ユーザーの思考を支持または反証する推論プロセスを共有します。同じ状況に対して二つの異なる解釈を対比させることで、認知の歪みをより明確に識別します。

#### 3\. スキーマ分析（Schema Analysis）

その後、ユーザーが依存している認知構造（スキーマ）を理解します。スキーマとは、我々の知識、信念、期待を整理する認知構造を指します。ユーザーがどのようなスキーマに依存しているかを理解することで、その認知モードや歪みについて多くのことを明らかにします。

**関連研究：**[「心の理論」においてGPT-3は人間の3歳、GPT-4は人間の7歳（基本の概念を理解しているレベル）に相当するとの研究報告](https://ai-data-base.com/archives/54829)

![[LLMをセラピストとして実行し、「認知の歪み」を診断させるためのプロンプト手法 - AIDB/AIDB_56696_2-1024x379.png]]

「Diagnosis of Thought（DoT）」フレームワーク

## 認知の歪みに関する分類の例

下記は、DoTフレームワークで分類される「認知の歪み」の例です。心理学の研究から引用されています。

**Personalization（過度な責任感）**：

状況の責任を自分に置くこと。実際には多くの要因が関与しているが、それが個人のコントロール外であることを認識しない。

**Mind Reading（他者の思考の推測）**：

他者が何を考え、どんな動機で行動しているのかを疑う。

**Overgeneralization（過度な一般化）**：

限られた情報に基づいて大きな結論を導く。

**All-or-nothing thinking（二項対立的思考）**：

状況を0か100かで見る、または二つの結果しか考えられない。

**Emotional reasoning（感情的推論）**：

ある事実に対する自分の感じ方が、事実に対する認識を捻じ曲げてしまう。

**Labeling（ラベリング）**：

人や物に対して、限られた情報からラベルを付ける。

**Magnification（拡大解釈）**：

状況のネガティブな部分を強調するか、ポジティブな部分を低く評価する。

**Mental filter（メンタルフィルター）**：

状況のネガティブな部分だけに注意を向ける。

**Should statements（「すべき」の思考）**：

他人がどのように振る舞うべきかを決めつける。

**Fortune-telling（未来の予測）**：

特定の方向で物事が進行することを期待する、または事態が悪くなると決めつける。

## DoTの性能実験

研究者らは厳密かつ詳細な実験設定を用いて、LLMが認知の歪みをどの程度正確に評価・分類できるかを検証しました。

### 1\. データセットの選定

この研究では、ShreevastavaとFoltz（2021）によって提案された「認知の歪み」検出データセットが使用されました。このデータセットは、Therapist QAデータセットに基づいて専門家によって注釈が付けられています。2,531の患者の発話例が含まれており、それぞれが10種類の一般的な認知の歪みに注釈が付けられています。

### 2\. 実験設定

研究者らは、最近の代表的なLLM（Large Language Models）であるChatGPT（gpt-3.5-turbo）、Vicuna、およびGPT-4を使用して実験を行いました。

LLMは、一般的な指示に基づいてプロンプトされ、目標とする認知の歪みのタイプ（前項にて解説）が指定されました。

### 3\. 評価指標

認知の歪みの評価と分類に対してはF-1スコアが測定されました。このスコアは、真陽性、真陰性、偽陽性、偽陰性の数に基づいて計算され、モデルの性能を総合的に評価するために使用されました。

各実験は5回実行され、その平均値と標準偏差が報告されました。

**関連研究：**[人の音声からAIが「性格」を予測](https://ai-data-base.com/archives/50980)

## 実験の結果

実験の結果はDoTフレームワークとGPT-4が精神療法において有用なツールである可能性を強く示しています。

![[LLMをセラピストとして実行し、「認知の歪み」を診断させるためのプロンプト手法 - AIDB/AIDB_56696_4.png]]

結果を整理した表

以下はその詳細です。

### 1\. 認知の歪みを高精度に評価＆分類

研究者らは、DoT（Diagnosis of Thought）フレームワークが認知の歪みの評価と分類において高い性能を示したことを報告しています。

GPT-3.5を用いた場合でも、歪みの評価スコアはフルトレーニングの性能を上回り、歪みの分類スコアはフルトレーニングの性能に迫る結果が得られました。

### 2\. GPT-4の特別な性能

さらに驚くべきことに、GPT-4は歪みの分類においてフルトレーニングの性能を大きく上回る結果を示しました。GPT-4は本タスクにおいて非常に強力な能力を持っている可能性があります。

### 3\. 専門家による評価

人間の専門家による評価も行われました。UpWorkから雇われた精神療法の専門家（認定臨床心理士、カウンセリング心理学の博士課程の学生など）が、生成された診断を評価しました。その結果、GPT-4によるこの診断方法は「包括的である」と84.5%の専門家が評価しました。

![[LLMをセラピストとして実行し、「認知の歪み」を診断させるためのプロンプト手法 - AIDB/AIDB_56696_5.png]]

**関連研究：**[SkinGPT：大規模言語モデルがビジョンベースで診断を下す皮膚科ツール　概要から仕組みまで](https://ai-data-base.com/archives/52251)

## 研究者らによる主な結論

### 1\. DoTフレームワークの有用性

研究者らは、DoT（Diagnosis of Thought）フレームワークが精神療法の専門家による補助ツールとして非常に有用であると結論付けました。このフレームワークは、認知の歪みの評価と分類において顕著な改善をもたらし、その診断プロセスにおける解釈を提供します。

### 2\. AIと精神療法の協力

この研究は、AIと精神療法の協力を先導するものとして位置づけられています。最終的な目標は、精神健康支援システムを大幅に強化することができる専門的で安全なAI駆動の支援を構築することです。

**関連研究：**[人の「嘘」はAIにバレる。](https://ai-data-base.com/archives/8909)

## プロンプト例

このセクションでは、『Diagnosis of Thought (DoT)』フレームワークを使用して、ユーザー（患者）がどのように認知の歪みを評価・分類できるかについてのプロンプト例を紹介します。

本プロンプト例は、論文で提案されているフレームワークに基づいて具体化したものです。

### まずは主な「認知の歪み」に関する知識を整理して与える

下記のプロンプトをLLMに与えます。

```
ユーザー：
患者の認知の歪みを評価・分類するセラピストとして振る舞ってください。「認知の歪み」タイプは以下から診断してください。
--
***（「認知の歪みに関する分類の例」セクションを貼り付け）
--
上記「認知の歪み」タイプ一覧を把握したら、「完了」などでその旨を教えてください。
```

この後、下記3つのフェーズに基づくプロンプトを与えます。プロンプト例は3フェーズの説明後に掲載します。

### 1\. 事実と主観の分離

最初に、ユーザーが提供した説明に対して、事実と主観を明確に分けるようにサポートします。このフェーズは、誤解や思い込みに関する情報を整理する役割を持ちます。

### 2\. 根拠のリクエスト

次に、ユーザーが提供した説明を支持する、または反証する根拠を求めます。このフェーズは、ユーザー自身が自分の考えに対する根拠を明確にする機会を提供します。

### 3\. 認知の歪みの確認

最後に、ユーザーの考えに影響を与えている可能性のある「認知の歪み」を特定します。このフェーズは、ユーザーが自分自身の考え方をより深く理解するために役立ちます。

1〜3をまとめると、以下のようなプロンプトになります。

```
ユーザー：
では次に、下記のフレームワークに基づいて、ユーザー（私）の考えに含まれる「認知の歪み」を評価・分類してください。
1. ユーザーの説明に対して、事実と主観に分けるようにサポートしてください。
2. ユーザーの説明を実証する、あるいは反証する根拠をリクエストしてください。
3. ユーザーの考えに影響を与える「認知の歪み」は何かを確認してください。
上記を把握したら、「完了」などでその旨を教えてください。
```

※臨床レベルの成果を期待する場合には、専門家の監修が必要です。また、このプロンプトはあくまで一例であり、個々のユーザーに合わせてカスタマイズすることが可能です。

### プロンプト全文

下記は、LLMに役割と前提、そして実行タスクを認識させるプロンプト例の全文です。そのまま使用できるかと思います。

```markdown
患者の認知の歪みを評価・分類するセラピストとして振る舞ってください。「認知の歪み」タイプは以下から診断してください。
--
Personalization（過度な責任感）：
状況の責任を自分に置くこと。実際には多くの要因が関与しているが、それが個人のコントロール外であることを認識しない。

Mind Reading（他者の思考の推測）：
他者が何を考え、どんな動機で行動しているのかを疑う。

Overgeneralization（過度な一般化）：
限られた情報に基づいて大きな結論を導く。

All-or-nothing thinking（二項対立的思考）：
状況を0か100かで見る、または二つの結果しか考えられない。

Emotional reasoning（感情的推論）：
ある事実に対する自分の感じ方が、事実に対する認識を捻じ曲げてしまう。

Labeling（ラベリング）：
人や物に対して、限られた情報からラベルを付ける。

Magnification（拡大解釈）：
状況のネガティブな部分を強調するか、ポジティブな部分を低く評価する。

Mental filter（メンタルフィルター）：
状況のネガティブな部分だけに注意を向ける。

Should statements（「すべき」の思考）：
他人がどのように振る舞うべきかを決めつける。

Fortune-telling（未来の予測）：
特定の方向で物事が進行することを期待する、または事態が悪くなると決めつける。
--

では次に、下記のフレームワークに基づいて、ユーザー（私）の考えに含まれる「認知の歪み」を評価・分類してください。
1. ユーザーの説明に対して、事実と主観に分けるようにサポートしてください。
2. ユーザーの説明を実証する、あるいは反証する根拠をリクエストしてください。
3. ユーザーの考えに影響を与える「認知の歪み」は何かを確認してください。
上記を把握したら、「完了」などでその旨を教えてください。
```

上記のプロンプトを送信すると、LLMから完了の旨が知らされます。  
その後、悩み事などを共有すると、評価や分類が実行されます。

![[LLMをセラピストとして実行し、「認知の歪み」を診断させるためのプロンプト手法 - AIDB/AIDB_56696_7.jpg]]

論文には対話の様子が例示されている（英語）

### DoTフレームワークに基づくLLMとの対話例

以下は、悩みを持つユーザーとLLMの対話におけるデモンストレーションです。実際に繰り広げられた会話を紹介しています。

```
ユーザー：
患者の認知の歪みを評価・分類するセラピストとして振る舞ってください。「認知の歪み」タイプは以下から診断してください。 
--
***（「認知の歪みに関する分類の例」セクションを貼り付け）
--
上記「認知の歪み」タイプ一覧を把握したら、「完了」などでその旨を教えてください。

LLM（今回はGPT-4）：
完了です。認知の歪みの各タイプについて理解しました。このような認知の歪みは、人々が自分自身や周囲の状況について非効率的または不正確な方法で考える際にしばしば見られます。これらの歪みは、選択肢の認識を狭めたり、感情や行動に悪影響を及ぼす可能性があります。

ご質問や具体的な状況があれば、どうぞお知らせください。それに対して、最も適切なフレームワークやアプローチを用いてアドバイスします。目標は、あなたの認識や思考パターンを最適化し、全体的な幸福感や効率を高めることです。

ユーザー：
では次に、下記のフレームワークに基づいて、ユーザー（私）の考えに含まれる「認知の歪み」を評価・分類してください。

1. ユーザーの説明に対して、事実と主観に分けるようにサポートしてください。
2. ユーザーの説明を実証する、あるいは反証する根拠をリクエストしてください。
3. ユーザーの考えに影響を与える「認知の歪み」は何かを確認してください。

上記を把握したら、「完了」などでその旨を教えてください。

LLM：完了です。指定されたフレームワークに基づいて、あなたの考えに含まれる「認知の歪み」を評価・分類する準備が整いました。

まず、あなたが説明する事例や状況において、事実と主観を区別します。
次に、その説明を実証するか反証する根拠を求めます。
最後に、あなたの考えに影響を与える「認知の歪み」が何であるかを確認します。
このフレームワークを使用することで、思考の偏りを正確に特定し、より効果的な解決策を見つける助けとなるでしょう。

具体的な説明や状況をお聞かせいただければ、分析を開始します。

ユーザー：
私は現在勤めている会社を退職し、フリーランスとして新しく仕事を開始する予定です。
当面は自宅で仕事をするため、机や椅子などの道具を買い揃える必要があります。
しかし、家の中が片付いておらず、まずは掃除や不要なものを捨てる作業をしなくてはいけません。
ただ、無理に片付けをしなくても模様替えでなんとかなる可能性もあります。
新しい道具を導入するには、どちらにせよ模様替えが必須です。
新しい道具を購入する際にはコストが気がかりです。
誰かに手伝ってもらえれば、運搬のコストは削減できるかもしれません。
この一連の作業を行うためには考えることが多すぎて、頭が疲れてしまいます。どこかへ旅行にでも行きたいなあと思ってスマホを眺めている間に時間が過ぎていってしまいます。その間に片付けを少しでも進められればよかったのに、と自己嫌悪に陥ります。

LLM：
お考えや状況に対して、指定されたフレームワークに基づいて分析します。

<strong>1. 事実と主観の区別
事実: </strong>会社を退職してフリーランスとして働く予定です。家の中が片付いておらず、新しい道具を購入する必要があります。
<strong>主観:</strong> この一連の作業を行うためには考えることが多すぎて、頭が疲れてしまいます。どこかへ旅行にでも行きたいなあと思ってスマホを眺めている間に時間が過ぎていってしまいます。
<strong>2. 根拠のリクエスト
</strong>模様替えだけで状況が改善される可能性はありますか？具体的な根拠は何ですか？
誰かに手伝ってもらえればコストが削減できるという考えには、どのような根拠がありますか？
<strong>3. 認知の歪みの確認
Overgeneralization（過度な一般化）:</strong>「考えることが多すぎて頭が疲れる」は、状況全体に対して一般化している可能性があります。具体的なタスクを分解してみると、状況はもっと管理可能かもしれません。
<strong>Emotional reasoning（感情的推論）:</strong>「自己嫌悪に陥る」は、あなたの感情が事実を歪めている例かもしれません。
<strong>Should statements（「すべき」の思考）:</strong>「その間に片付けを少しでも進められればよかったのに」という考えは、自分に対する「すべき」のプレッシャーを感じている可能性があります。
このように分析すると、認知の歪みが明確になり、それに対処するための戦略が考えやすくなるでしょう。例えば、「過度な一般化」を克服するためには、タスクを小分けにして進めることで、全体像がどれほど手に負えるものなのかを確認するとよいです。

次のステップや質問があれば、どうぞお知らせください。
```

上記を読むと、LLMによってどのようにDoTフレームワークが実行されるかを知ることができます。

## 本研究における注意点

### 1\. データの品質と規模

本研究は、さらに高品質なデータを大規模に集めることでさらに洗練できる可能性があります。研究者らは、公に利用可能な「認知の歪み」検出データセットを使用していますが、これはプライバシーの観点から医療専門家と患者との対話を記録したデータセットが限られているためです。

### 2\. 専門家の監督

本手法は高い評価を得ていますが、現場で使用するには十分な注意と専門家の監督が必須です。特に、このフレームワークは患者自身が自分の思考パターンを認識するための自己診断ツールとしても使用できますが、専門家の監督なしには直接患者に使用させるべきではありません。

### 3\. プライバシー保護

本手法を使用する過程で得られたユーザーのデータはプライバシー保護を注意する必要があります。患者と医療専門家との対話データは、プライバシーの観点から機密性が高いです。

### 4\. 長期的な効果

長期的な効果は検証が必要であり、この研究はその初期段階に過ぎない可能性があります。

## まとめ

この記事では、GPT-4を用いた精神療法の新しいフレームワーク「Diagnosis of Thought (DoT)」について詳しく解説しました。このフレームワークは、精神療法の専門家によって高く評価されており、特に「認知の歪み」の評価と分類において優れた性能を示しています。

従来の課題としては、メンタルヘルスの専門家が不足している一方で、既存のシステムは感情や共感に特化していたため、認知の側面が疎かにされていました。DoTフレームワークはこのギャップを埋めるものであり、3つのフェーズを通じてユーザーと対話します。

実験結果ではGPT-4が高い性能を示し、専門家による評価が高いことがわかりました。しかし、このフレームワークを使用する際には注意点もあり、特にプライバシー保護と専門家の監督が必要です。

## おまけ

本フレームワーク『Diagnosis of Thought (DoT)』に基づくMyGPTを作成しました。 相談や心情などを話すと、GPT-4が心理学的分析を行い、ユーザーのメタ認知をサポートします。

名称：セラピスト  
[https://chat.openai.com/g/g-o9r1c3nkf-serapisuto-diagnosis-of-thought-dot](https://chat.openai.com/g/g-o9r1c3nkf-serapisuto-diagnosis-of-thought-dot)

ChatGPT Plusユーザーは上記リンクから使用できます。

※実際の診察としてではなく、あくまでも参考程度にご利用ください  
※基本的にご自身のテキストのみを使用するなど、他者のプライバシーには十分な注意をお願いいたします

**参照論文情報**

・タイトル：Empowering Psychotherapy with Large Language Models: Cognitive Distortion Detection through Diagnosis of Thought Prompting  
・著者：Zhiyu Chen, Yujie Lu, William Yang Wang  
・所属：Carnegie Mellon University, University of California, Santa Barbara  
・URL：[https://doi.org/10.48550/arXiv.2310.07146](https://doi.org/10.48550/arXiv.2310.07146)
