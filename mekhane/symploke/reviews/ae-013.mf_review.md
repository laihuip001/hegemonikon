# シンプリシティの門番 レビュー

## 対象ファイル
`mekhane/ergasterion/digestor/pipeline.py`

## 判定
発言（要改善）

## 発見事項
- (Medium) 未使用コード: `mark_as_processed` 関数がモジュール内で定義されていますが、クラスからも `main` からも、同一パッケージ内の `scheduler.py` からも使用されていません。
- (Medium) 不要なネスト: `_load_existing_keys` メソッド内のネストが深く（6階層）、可読性を損なっています。Early return またはガード節で平坦化可能です。
- (Medium) 不要な複雑さ: `_deduplicate_by_similarity` メソッド内で、ループごとに `existing_vectors` の正規化を行っており、計算効率とコードの簡潔さを損なっています。
- (Low) 未使用import: `dataclasses.field` がインポートされていますが使用されていません。
- (Low) 過剰設計: `_generate_eat_batch` で `eat_batch.json` を生成していますが、「一括参照用」とのコメントがあり、後続プロセスで必須でない可能性があります（YAGNI）。

## 重大度
Medium
