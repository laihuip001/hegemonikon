# シンプリシティの門番 レビュー

## 対象ファイル
`mekhane/anamnesis/session_indexer.py`

## 判定
発言（要改善）

## 発見事項
- (Medium) コードの重複: `index_handoffs`, `index_conversations`, `index_steps`, `index_exports`, `index_from_json` の5箇所で、重複排除・埋め込み・DB登録のロジックが完全にコピーペーストされています。共通関数 `_index_records(records, source_name)` に集約すべきです。
- (Low) 不要な import: `sessions_to_records` 関数内の `from datetime import datetime as _dt` は、モジュールレベルで `datetime` が import されているため不要です。
- (Low) 未使用変数: `parse_step_outputs` 関数内の `for i, out_file in enumerate(...)` において、`i` が使用されていません。

## 重大度
Medium
