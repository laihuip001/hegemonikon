# シンプリシティの門番 レビュー

## 対象ファイル
`mekhane/anamnesis/index.py`

## 判定
発言（要改善）

## 発見事項
- **未使用のimport (Low)**: `from mekhane.anamnesis.models.paper import merge_papers` が宣言されていますが、ファイル内で一度も使用されていません。
- **デッドコード/不要な複雑さ (Medium)**: `Embedder` クラス内の ONNX Runtime フォールバック実装 (`_init_onnx`, `_embed_onnx`, `MODELS_DIR` 等) は、プロジェクトの依存関係に `sentence-transformers` が含まれているため、実質的にデッドコードとなっている可能性が高いです。また、このフォールバックは `bge-small` (384次元) を使用しており、メインの `bge-m3` (1024次元) と次元数が異なるため、ベクトル検索において致命的な不整合を引き起こす危険性があります（コード内でも警告が出力されています）。YAGNI原則に従い、この危険かつ不要なフォールバックを削除することを推奨します。
- **不要な複雑さ (Low)**: `_get_vector_dimension` 関数において、LanceDB スキーマのフィールド型を正規表現 `r'\[(\d+)\]'` でパースしていますが、PyArrow 型オブジェクトのプロパティ（例: `field.type.list_size`）に直接アクセスする方が安全でシンプルです。
- **importの整理 (Low)**: `_get_vector_dimension` や `_normalize_title` 関数内で `import re` していますが、ファイル冒頭で `import re` することで関数ごとの import を削除できます。

## 重大度
Medium
