# 比喩一貫性の詩人 レビュー

## 対象ファイル
`mekhane/anamnesis/session_indexer.py`

## 判定
発言（要改善）

## 発見事項
- **Naming Pattern Violation (Low)**
  - `index_handoffs`, `index_conversations`, `index_steps` という「対象」に基づく命名パターンがある中、`index_from_json`, `index_from_api` だけが「手段」に基づく命名になっている。「何」をインデックスするのか（Sessions）が関数名から脱落している。
  - 提案: `index_sessions_from_json`, `index_sessions_from_api` (または `index_sessions`)
- **Verb/Structure Inconsistency (Low)**
  - パース関数の命名規則が揺らいでいる。
    - `parse_sessions_from_json` (対象 + 源)
    - `parse_handoff_md` (対象 + 形式)
    - `parse_step_outputs` (対象 + 出力?)
  - 提案: `parse_sessions`, `parse_handoffs`, `parse_steps` に統一する。
- **Metaphor Leakage (Medium)**
  - 内部データ構造において、外部システムの用語である `cascade_id` (Water metaphor) と、ドメイン用語である `conversation_id` (Dialogue metaphor) が混在している。`sessions_to_records` では `conversation_id` を使い、`conversations_to_records` では `cascade_id` を使っているが、これらは同一の実体（Session/Conversation）を指す識別子であるはず。
  - 提案: 内部辞書のキーを `conversation_id` (または `session_id`) に統一し、外部メタファー（Cascade/Trajectory）を境界で変換する。

## 重大度
Medium
