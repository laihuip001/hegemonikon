# ハルシネーション検出者 レビュー

## 対象ファイル
`mekhane/mcp/hgk_gateway.py`

## 判定
発言（要改善）

## 発見事項
- **Critical**: `AnyHttpUrl` (Pydantic v2) のコンストラクタ呼び出し
  - 該当箇所: `redirect_uris=[AnyHttpUrl("https://claude.ai/api/mcp/auth_callback")]`
  - 理由: Pydantic v2 では `AnyHttpUrl` は `Annotated` 型エイリアスであり、インスタンス化できない（`TypeError` が発生する）。文字列を直接渡すか、`TypeAdapter` を使用する必要がある。
- **Low**: グローバル変数の定義前参照
  - 該当箇所: `hgk_status` 内での `INCOMING_DIR`, `PROCESSED_DIR` 参照
  - 理由: `hgk_status` が定義された時点 (L540付近) で `INCOMING_DIR` (L760付近) は未定義。実行時には定義されているため動作するが、静的解析やリファクタリング耐性に問題がある。

## 重大度
Critical
