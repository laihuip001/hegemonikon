# 暗黙契約違反検出者 レビュー

## 対象ファイル
`mekhane/anamnesis/session_indexer.py`

## 判定
発言（要改善）

## 発見事項
- **Critical**: `fetch_all_conversations` 関数内で使用されている RPC メソッド文字列 `"exa.language_server_pb.LanguageServerService/GetAllCascadeTrajectories"` は、`mekhane/ochema/proto.py` で定義されている `RPC_GET_TRAJECTORIES` 定数と重複しており、ハードコードされています。`proto.py` の変更に追従できないリスクがあります。
- **High**: `GnosisIndex` テーブル（`knowledge`）に対して挿入されるレコード構造が、`mekhane/anamnesis/models/paper.py` で定義される `Paper` スキーマと一致していません。特に `content` フィールドの追加や `id`, `source_id`, `published` 等の欠落があり、同一テーブル内で異なるスキーマが混在する（あるいは初期化順序によってフィールドが欠落する）状態を引き起こしています。
- **Medium**: `AntigravityClient` のプライベートメソッド `_rpc` を外部から直接呼び出しており、内部実装への依存が発生しています。
- **Medium**: `GnosisIndex` のプライベートメソッド `_table_exists` を外部から直接呼び出しており、内部実装への依存が発生しています。

## 重大度
Critical
