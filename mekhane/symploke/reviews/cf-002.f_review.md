# 暗黙契約違反検出者 レビュー

## 対象ファイル
`mekhane/ergasterion/digestor/scheduler.py`

## 判定
発言（要改善）

## 発見事項
- **定数/設定値の重複定義 (Medium)**: `scheduler.py` 内の `incoming`, `expired` ディレクトリおよび `LOG_DIR` のパス定義が、`pipeline.py` や `state.py` と重複してハードコードされている。`pipeline.py` 側で出力先が変更された場合、`scheduler.py` は古いパスを参照し続け、クリーンアップ機能が動作しなくなるリスクがある。
- **ディレクトリ構造への暗黙的依存 (Low)**: `sys.path` の設定において、ファイルがプロジェクトルートから3階層目にあることを前提とした親ディレクトリ遡及 (`.parent.parent.parent`) が行われている。ファイル移動時に破損しやすい。
- **外部環境への暗黙的依存 (Low)**: `notify-send` (Linux/GNOME) コマンドの存在を仮定している。`try-except` で囲まれているものの、非Linux環境では機能しない。

## 重大度
Medium

## 修正提案
`mekhane/ergasterion/digestor/config.py` を作成し、パス定義を一元管理することを推奨する。

```python
# mekhane/ergasterion/digestor/config.py
from pathlib import Path

BASE_DIR = Path.home() / ".hegemonikon"
DIGESTOR_DIR = BASE_DIR / "digestor"
INCOMING_DIR = Path.home() / "oikos" / "mneme" / ".hegemonikon" / "incoming"
EXPIRED_DIR = Path.home() / "oikos" / "mneme" / ".hegemonikon" / "expired"
```

その後、`scheduler.py`, `pipeline.py`, `state.py` で `config.py` から変数を参照するように変更する。
