# 暗黙契約違反検出者 レビュー

## 対象ファイル
`mekhane/anamnesis/session_monitor.py`

## 判定
発言（要改善）

## 発見事項
- **会話内容の切り捨てフラグ (truncated) 未対応**: `AntigravityClient.session_read` は `conversation` の各要素に `truncated: bool` フラグを含めるが、`session_monitor.py` はこれを完全に無視している。これにより、30,000文字を超える長いセッションが警告なしに切り捨てられて保存されるリスクがある。 (High)
- **取得セッション数の暗黙的上限**: `AntigravityClient.session_info` は内部で `sessions[:20]` とハードコードされた上限を持つが、`session_monitor.py` は `MAX_SESSIONS = 20` と独自に定数を定義している。将来 `session_monitor.py` 側で `MAX_SESSIONS` を増やしても、`AntigravityClient` 側の制約により機能しないため、依存関係が不透明である。 (Medium)

## 重大度
High
