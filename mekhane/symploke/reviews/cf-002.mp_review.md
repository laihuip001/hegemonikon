# 暗黙契約違反検出者 レビュー

## 対象ファイル
`mekhane/mcp/sophia_mcp_server.py`

## 判定
発言（要改善）

## 発見事項
- (Critical) `mekhane/symploke/sophia_backlinker` のインポートが安全であるという暗黙の仮定があるが、実際には依存ライブラリ不在時に `sys.exit(1)` を呼び出すため、サーバープロセスごと終了してしまう（`try...except Exception` では捕捉不可）。
- (High) `kairos_ingest.py` が生成する `conversation` タイプのドキュメント構造（`title` フィールド）に対応しておらず、常に `primary_task` フィールドを期待しているため、検索結果で `task: N/A` となる。
- (Medium) インデックスパス（`SOPHIA_INDEX`, `KAIROS_INDEX`）が特定のユーザー環境（`/home/makaron8426/...`）に固定されており、環境非依存という暗黙の契約に違反している。

## 重大度
Critical
