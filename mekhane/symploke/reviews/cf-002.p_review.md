# 暗黙契約違反検出者 レビュー

## 対象ファイル
`mekhane/ergasterion/digestor/scheduler.py`

## 判定
発言（要改善）

## 発見事項
- [High] **プロジェクト構造への暗黙的依存**: `sys.path` 操作 (`Path(__file__).parent.parent.parent`) が、ファイルシステムの特定階層構造 (`mekhane/ergasterion/digestor/`) を前提としており、ディレクトリ移動やパッケージ構成変更に脆弱である。これはモジュール間の暗黙的な配置契約となっている。
- [Medium] **ファイルパス定数の重複定義**: `cleanup_expired` 内の `incoming` ディレクトリパス (`Path.home() / "oikos" / "mneme" / ".hegemonikon" / "incoming"`) が `pipeline.py` の `_generate_eat_batch` メソッド内の出力先と重複してハードコードされている。`pipeline.py` 側の変更が `scheduler.py` に自動的に反映されず、将来的な不整合（クリーンアップ漏れ）のリスクがある。
- [Medium] **OS/環境への暗黙的依存**: ドキュメントには「OS 非依存」と明記されているが、実装は `notify-send` コマンドおよび `DISPLAY=:0` 環境変数をハードコードして呼び出しており、Linux/X11 環境以外（macOS, Windows, Headless Server）では機能しないかエラーとなる。これはドキュメント（契約）と実装の不一致である。
- [Low] **ログディレクトリ設定の重複**: `LOG_DIR` (`.hegemonikon/digestor`) が `pipeline.py` と `scheduler.py` で個別に定義されており、設定の一元管理がなされていない。

## 重大度
High
