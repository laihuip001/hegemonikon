# 暗黙契約違反検出者 レビュー

## 対象ファイル
`mekhane/api/routes/chat.py`

## 判定
発言（要改善）

## 発見事項
- **High**: クラス内部構造への依存 (`OchemaService._get_cortex_client`)
  - `OchemaService` はシングルトンアクセサ `get()` を提供しているが、その内部キャッシュ管理用メソッド `_get_cortex_client` を直接呼び出している。
- **High**: クラス内部構造への依存 (`CortexClient._get_token`, `CortexClient._get_project`)
  - 認証トークン取得ロジックを再利用するために、`CortexClient` の protected メソッドを外部から呼び出している。
  - `CortexClient` の内部実装（トークンキャッシュの仕組みなど）が変更された場合、このファイルも連鎖的に破損する。

## 重大度
High
