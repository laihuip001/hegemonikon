# 暗黙契約違反検出者 レビュー

## 対象ファイル
`mekhane/fep/derivative_selector.py`

## 判定
発言（要改善）

## 発見事項
- `encode_for_derivative_selection` 関数は `theorem` 引数として "O1"〜"O4" を受け入れるシグネチャを持つが、内部実装は O1 固有の論理（抽象度・文脈性・反省性）のみを適用しており、他の定理（O2/O3/O4）の入力に対して誤った、あるいは無意味なエンコーディング結果を返す。これは関数シグネチャが示す契約（全 O-series 定理のサポート）に違反している。 (High)
- `SELECTION_LOG_PATH` 定数に `/home/makaron8426/oikos/mneme/.hegemonikon/derivative_selections.yaml` という絶対パスがハードコードされており、特定のユーザー環境構造を前提としている。これは環境に対する暗黙の契約違反である。 (Medium)
- `select_derivative` 関数は 24 定理 × 3 派生 = 72 種類の派生を返すが、主要な利用者である `mekhane/workflow_runner.py` 内の `DERIVATIVE_PROCESSING_HINTS` は O1 (nous, phro, meta) と A2 (affi, nega, susp) の計 6 種類しか定義していない。生産者（派生選択）と消費者（ワークフロー実行）の間で、サポート範囲に関する不整合（Enum非網羅）が生じている。 (Medium)

## 重大度
High
