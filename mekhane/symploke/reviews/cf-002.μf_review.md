# 暗黙契約違反検出者 レビュー

## 対象ファイル
`mekhane/workflow_runner.py`

## 判定
発言（要改善）

## 発見事項
- **Enum/Derivative 非網羅 (High)**
  - `mekhane/fep/derivative_selector.py` は全24定理×3派生＝72種類の派生 (Derivative) を定義している。
  - `mekhane/workflow_runner.py` の `DERIVATIVE_PROCESSING_HINTS` は `O1` (nous, phro, meta) と `A2` (affi, nega, susp) の **6種類** しか定義していない。
  - それ以外の派生が選択された場合、`{"note": "デフォルト処理"}` にフォールバックするが、これは暗黙の契約（選択された派生には適切な処理ヒントが存在する）の不完全な履行である。

- **X-Series Workflow ID の不一致 (High)**
  - `mekhane/fep/encoding.py` の `get_x_series_recommendations` は、S系列に対して `"/s"` というワークフローIDを返す。
  - `mekhane/workflow_runner.py` の `THEOREM_TO_WORKFLOW` 定義には `"/s"` は存在せず、S系列は `"/met"`, `"/mek"`, `"/sta"`, `"/pra"` に細分化されている。
  - `workflow_runner.py` が `encoding.py` から受け取った `workflow` 値をそのまま利用すると、存在しないワークフローを参照する可能性がある。

- **環境依存のハードコード (Medium)**
  - `WORKFLOWS_DIR = "/home/makaron8426/oikos/.agent/workflows"` がハードコードされている。
  - `mekhane/fep/derivative_selector.py` や `encoding.py` にも同様のパスがあり、ファイル間で「特定のユーザー環境」という暗黙の前提が共有されている。

## 重大度
High
