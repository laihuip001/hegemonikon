# ネスト深度警報者 レビュー

## 対象ファイル
`mekhane/mcp/sophia_mcp_server.py`

## 判定
発言（要改善）

## 発見事項
- `call_tool` 内の `name == "search"` ブロックにおいて、最大ネスト深度が 8 に達しています。
  - `if source` (深度3) -> `for r` (深度4) -> `if recent_days` (深度5) -> `if ts` (深度6) -> `try` (深度7) -> `if ...` (深度8) (High)
- `call_tool` 内の `name == "backlinks"` ブロックにおいて、`for link` ループがネスト深度 4 に達しています。 (High)
- `call_tool` 内の `name == "graph_stats"` ブロックにおいて、`if count > 0` がネスト深度 5 に達しています。 (High)
- `try-except` ブロック内でのネストが深く、可読性を損なっています。特に `search` ロジック内の `try` ブロックは既にネストが深い位置にあります。

## 重大度
High
