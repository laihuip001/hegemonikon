# ネスト深度警報者 レビュー

## 対象ファイル
`mekhane/anamnesis/session_indexer.py`

## 判定
発言（要改善）

## 発見事項
- **High**: `parse_sessions_from_json` 関数内の `if path:` ブロックがネスト4段目に到達しています (line 51付近)。
- **High**: `fetch_all_conversations` 関数内の `if turn.get("role") == "user":` ブロックがネスト4段目に到達しています (line 222付近)。
- **Medium**: `index_handoffs`, `index_conversations`, `index_steps`, `index_exports`, `index_from_json` 関数内で、リスト内包表記の中に辞書内包表記が含まれており、ネストが2段以上になっています (`filtered_data = [{k: v ...} for record in ...]`)。

## 重大度
High
