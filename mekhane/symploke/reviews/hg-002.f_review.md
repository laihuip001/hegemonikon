# 予測誤差審問官 レビュー

## 対象ファイル
`mekhane/mcp/hgk_gateway.py`

## 判定
発言（要改善）

## 発見事項
- **モジュールレベルでの副作用 (High)**: `sys.path.insert(0, str(PROJECT_ROOT))` がトップレベルで実行されており、インポート時にグローバルな `sys.path` を変更する。これは他のモジュールのインポート順序に影響を与える予測困難な副作用である。
- **インポート時のI/O (Medium)**: `POLICY = _load_policy()` がトップレベルで実行され、インポート時にファイル読み込みと標準エラー出力への書き込みを行う。
- **シグナルハンドラの変更 (High)**: `hgk_paper_search` 内部で `signal.signal(signal.SIGALRM, _timeout_handler)` を使用しており、プロセス全体のシグナル処理を変更する。これは呼び出し元の意図しない動作を引き起こす可能性がある。
- **暗黙的な状態変更 (Medium)**: `_check_rate_limit` 関数は名前から「チェックのみ」を想起させるが、内部で `_ask_timestamps` リストを変更（append）している。コマンドとクエリの分離（CQS）に違反している。
- **戻り値の予測困難性 (Medium)**: `hgk_digest_run` は docstring では `str` を返すとあるが、内部ロジックで `report` 変数が `dict` または `str` になりうる構造になっている（最終的に文字列化されるが、型の一貫性が低い）。

## 重大度
High
