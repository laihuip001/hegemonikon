# 予測誤差審問官 レビュー

## 対象ファイル
`mekhane/mcp/hgk_gateway.py`

## 判定
発言（要改善）

## 発見事項
- (High) モジュールレベルでの `sys.path.insert` による副作用: インポート時にグローバルな `sys.path` を変更しており、環境への影響が予測不能。
- (High) モジュールレベルでの `sys.exit(1)`: 環境変数 `HGK_GATEWAY_TOKEN` が未設定の場合にプロセスを強制終了させる副作用がある。
- (High) `hgk_paper_search` 内での `signal.signal` 変更: グローバルなシグナルハンドラを一時的に書き換えており、並行実行時や割り込み時の挙動が予測不能。
- (Medium) `_trace_tool_call` および `_wbc_log_security_event` における暗黙的なファイル出力副作用: 関数名からはログファイルへの書き込みやローテーション（ファイル名変更）を行うことが読み取れない。
- (Medium) `_pks_engine`, `_ask_timestamps` 等のグローバル変数を用いた暗黙的な状態保持: `hgk_proactive_push` や `hgk_ask` の挙動が隠蔽された状態に依存している。
- (Medium) 例外の握りつぶし: `try-except Exception` ブロックにより全ての例外をキャッチし、エラーメッセージを含む文字列を返しているため、呼び出し元がエラー種別を判別できない。

## 重大度
High
