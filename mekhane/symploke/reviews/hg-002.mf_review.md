# 予測誤差審問官 レビュー

## 対象ファイル
`mekhane/api/routes/chat.py`

## 判定
発言（要改善）

## 発見事項
- **副作用の隠蔽 (High)**: `_claude_chat_from_gemini_format` および `_cortex_chat_from_gemini_format` は、名前が「フォーマット変換」を示唆しているが、実際には外部API通信を行い `StreamingResponse` を返している。これは「驚き最小の原則」に違反する。
- **戻り値の型が予測困難 (Medium)**: `chat_send`, `cortex_chat`, `_claude_chat_from_gemini_format`, `_cortex_chat_from_gemini_format` の主要エンドポイント関数に返り値の型アノテーションがない。`-> StreamingResponse` を明記すべき。
- **暗黙的な依存解決 (Medium)**: `OchemaService.get()` や `_get_api_key()` が関数内部で呼ばれており、依存関係がシグネチャから見えない。テスト容易性と予測可能性を損なう。

## 重大度
High
