# 予測誤差審問官 レビュー

## 対象ファイル
`mekhane/mcp/hgk_gateway.py`

## 判定
発言（要改善）

## 発見事項
- **(High) 副作用非明示**: `HGKOAuthProvider.get_client` は名前から取得（Query）を想起させるが、内部で `self._clients` への登録（Command）という副作用を持っている（CQS原則違反）。
- **(High) 副作用非明示**: `_check_rate_limit` は名前から検証（Check）を想起させるが、内部で `_ask_timestamps` を更新するという副作用を持っている。
- **(High) 副作用非明示**: `hgk_sop_generate` は「生成」を謳っているが、ファイル保存という副作用を実行している。`save_` や `_and_save` が名前に含まれていない。
- **(Medium) 暗黙状態変更**: `_get_pks_engine` はグローバル変数 `_pks_engine` を遅延初期化しており、予測困難な初期化コストと状態変更を隠蔽している。
- **(Medium) 型予測困難**: `_get_policy` に戻り値の型アノテーションがなく、呼び出し元で型が予測できない。
- **(Medium) 例外隠蔽**: `_load_policy`, `_trace_tool_call`, `_wbc_log_security_event` など多数の関数で `Exception` を捕捉し、`sys.stderr` への出力やデフォルト値の返却を行っているため、呼び出し元でエラーを検知・ハンドリングできない。

## 重大度
High
