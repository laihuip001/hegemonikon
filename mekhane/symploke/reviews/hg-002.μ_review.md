# 予測誤差審問官 レビュー

## 対象ファイル
`mekhane/anamnesis/session_indexer.py`

## 判定
発言（要改善）

## 発見事項
- **[High] 副作用非明示 (Global sys.path modification)**
  - モジュールレベル（27-29行目）で `sys.path.insert` を実行しており、インポートしただけでグローバルな環境（検索パス）が変更される副作用がある。これはモジュール名や関数名から予測不能である。

- **[Medium] 型予測困難 (Ambiguous Return Types)**
  - 多数の関数（`parse_sessions_from_json`, `fetch_all_conversations` 等）が `list[dict]` や `dict` を返しているが、辞書の構造（キーや値の型）がシグネチャから予測不能。`TypedDict` やデータクラスを使用すべきである。

- **[Medium] 例外の発生が関数シグネチャから不明 (Unadvertised Exception)**
  - `index_from_json` は戻り値 `int` (終了コード) を示唆しているが、内部の `json.load` が失敗した場合に `JSONDecodeError` が外部へ漏出する可能性がある。

- **[Medium] 状態変更が暗黙的 / 例外の隠蔽 (Exception Swallowing)**
  - `fetch_all_conversations` (303行目周辺) や `parse_step_outputs` (404行目周辺) で `Exception` を捕捉し、標準出力へのログ出力のみで処理を継続している。呼び出し元は部分的な失敗を検知できず、予測誤差を生む。

## 重大度
High
