# 予測誤差審問官 レビュー

## 対象ファイル
`mekhane/workflow_runner.py`

## 判定
発言（要改善）

## 発見事項

- [High] **嘘をつく関数名**: `run_workflow` という名前は「ワークフローを実行する」ことを強く示唆するが、実際には「派生選択と推奨事項の計算（実行パラメータの準備）」しか行っておらず、副作用（実行）を伴わない。呼び出し元は実行結果（LLMの応答など）を期待して裏切られる。`select_execution_parameters` や `prepare_workflow_context` 等、実態に即した名前に変更すべきである。
- [High] **環境依存の爆弾**: `WORKFLOWS_DIR` が `/home/makaron8426/...` という特定の絶対パスでハードコードされている。これは他の環境で実行した瞬間に必ず失敗する「驚き」の実装である。環境変数や相対パス解決を使用すべきである。
- [Medium] **広範な副作用**: モジュールレベルで `sys.path.insert(0, ...)` が実行されている。このモジュールを import しただけで、インタプリタ全体の import 検索パスが変更される。これはライブラリとして予測不能な副作用である。`if __name__ == "__main__":` ブロック内に移動すべきである。
- [Medium] **暗黙の型契約**: `suggest_next_theorems` の戻り値が `List[Dict[str, str]]` であり、キー (`theorem`, `workflow`, `relation`) が暗黙的である。`NamedTuple` や `dataclass` を使用し、構造を明示することで予測誤差を排除すべきである。

## 重大度
High
