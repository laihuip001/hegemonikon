# ストア派制御審判 レビュー

## 対象ファイル
`mekhane/ochema/tests/test_service.py`

## 判定
発言（要改善）

## 発見事項
- **外部依存の障害シミュレーション欠如 (High)**: `OchemaService` は外部 LLM (Cortex, LS) へのルーティングを責務とするが、テストコードには通信タイムアウト、接続拒否、503エラーなどの「制御不能な事象」に対する耐性テストが一切存在しない。幸福な経路（Happy Path）のみを検証しており、運命への備えが不足している。
- **制御メカニズムの放棄 (Medium)**: `unittest.mock` から `patch`, `MagicMock` をインポートしているにもかかわらず、これらが使用されていない。シングルトンの `OchemaService.get()` をモックなしで呼び出しており、初期化プロセスに含まれる可能性のある I/O や環境チェックが制御されていない。
- **入力/出力の境界防衛不足 (Low)**: `stream()` メソッドのテストにおいて、非対応モデル（Claude）への即時エラーは確認されているが、対応モデル（Gemini）実行時のタイムアウト設定や再試行ロジックを検証するテストケースが欠落している。

## 重大度
High
