# ストア派制御審判 レビュー

## 対象ファイル
`mekhane/anamnesis/cli.py`

## 判定
発言（要改善）

## 発見事項
- (High) `cmd_collect` および `cmd_collect_all` における外部ソース（Arxiv, Semantic Scholar, OpenAlex）へのアクセスにタイムアウト設定が欠如している。ネットワーク遅延時にプロセスがハングする可能性がある。
- (Medium) `cmd_collect` にネットワーク障害時のリトライ機構や、特定のソースがダウンしている場合のフォールバック（別ソースへの自動切り替え）が存在しない。
- (Medium) `update_state` 関数が `STATE_FILE` に直接書き込みを行っている。書き込み中にプロセスが中断された場合、JSONファイルが破損し、次回実行時に `cmd_check_freshness` がエラーになるリスクがある（アトミックな書き込みが必要）。
- (Low) `cmd_session_index` 等のインデックス系コマンドも外部API依存であるが、CLIレベルでのタイムアウト制御が見当たらない。

## 重大度
High
