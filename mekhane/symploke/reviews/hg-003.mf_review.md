# ストア派制御審判 レビュー

## 対象ファイル
`mekhane/mcp/sophia_mcp_server.py`

## 判定
発言（要改善）

## 発見事項
- (High) **外部API呼び出しのタイムアウト欠如**: `EmbeddingAdapter` (sentence-transformers) のモデルダウンロードや、将来的な外部ベクトルDB接続に対し、明示的なタイムアウト設定が存在しない。ネットワーク遅延時にサーバーが応答不能になるリスクがある。
- (Medium) **大規模処理のタイムアウト欠如**: `SophiaBacklinker.build_graph` や `EmbeddingAdapter.search` が大規模データセットに対して実行される際、実行時間を制限するガードが存在しない。
- (Medium) **フォールバック欠如**: インデックスファイル (`sophia.pkl`, `kairos.pkl`) が存在しない場合、単に結果なしを返すのみで、代替手段（単純なgrep検索など）へのフォールバックが実装されていない。
- (Medium) **リカバリ戦略なし**: インデックス読み込み失敗時（破損など）に、再構築を促すログ出力や自動修復の試行がなく、サービスが機能停止する。
- (Medium) **サーキットブレーカーなし**: 外部依存（Hugging Face Hubなど）への接続失敗が連続した場合の遮断機構がない。

## 重大度
High
