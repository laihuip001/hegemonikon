# ストア派制御審判 レビュー

## 対象ファイル
`mekhane/mcp/hgk_gateway.py`

## 判定
発言（要改善）

## 発見事項
- (Critical) `hgk_sessions`, `hgk_ask` 等のツール内で `AntigravityClient` を都度インスタンス化しており、リクエスト毎に `ps aux` / `ss` による重いプロセス検出が走る。これは制御不能な外部状態（OSプロセス・ネットワーク）への過度な依存であり、サーキットブレーカーもないため、LS不調時にシステム全体が巻き込まれる。
- (High) `hgk_ask` 等の外部API呼び出しにおいて、明示的なタイムアウト設定が `AntigravityClient` の内部実装（10秒）に隠蔽されており、呼び出し元（Gateway）から制御できない。また、タイムアウト時の再試行ロジックも欠如している。
- (Medium) `hgk_ask` が Antigravity LS に完全依存しており、LS 接続不能時のフォールバック（直接APIコール等）がない。
- (Medium) `hgk_idea_capture` 等のファイル書き込みにおいて、I/Oエラー時のリカバリ戦略（リトライ、退避保存）が存在しない。

## 重大度
Critical
