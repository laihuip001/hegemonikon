# ストア派制御審判 レビュー

## 対象ファイル
`mekhane/anamnesis/cli.py`

## 判定
発言（要改善）

## 発見事項
- **タイムアウト設定の欠如 (High)**: `cmd_collect` (arXiv, Semantic Scholar等), `cmd_session_index` (LS API) における外部通信処理で、呼び出し時に明示的な `timeout` 引数が指定されていません。これにより、外部サービスが無応答の場合にプロセスが無限にハングするリスクがあります。
- **ネットワーク障害時のフォールバック欠如 (Medium)**: `cmd_collect` において、特定のソースからの取得が失敗した場合（例外発生時）、単にエラーログを出力して終了しており、代替ソースへの切り替えやキャッシュ利用などのフォールバック戦略が欠如しています。
- **リトライ/サーキットブレーカーの欠如 (Medium)**: `cmd_collect` および `cmd_collect_all` において、一時的なネットワークエラー（Transient Error）に対するリトライロジックや、連続失敗時の遮断（Circuit Breaker）機構が実装されていません。
- **ファイルI/Oのリカバリ戦略不足 (Medium)**: `update_state` 関数において、`STATE_FILE` の読み込み失敗時にエラーを無視（`pass`）しており、書き込み時もアトミックな書き込み（一時ファイルへの書き込み→リネーム）が行われていないため、プロセス中断時に状態ファイルが破損するリスクがあります。

## 重大度
High
