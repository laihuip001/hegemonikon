# ストア派制御審判 レビュー

## 対象ファイル
`mekhane/ergasterion/digestor/pipeline.py`

## 判定
発言（要改善）

## 発見事項
- **タイムアウト欠如 (High)**: `_fetch_from_gnosis` 内の `collector.search` 呼び出しにタイムアウト制御がありません。`ArxivCollector` 内部で `arxiv` パッケージを使用していますが、サーバー応答がない場合にリトライロジックに到達せず、無期限にハングする可能性があります。
  - *修正提案*: `func_timeout` 等で外部呼び出しをラップするか、`collector.search` にタイムアウト引数を渡し、内部で `requests` の `timeout` を設定する必要があります。
- **タイムアウト欠如 (High)**: `_deduplicate_by_similarity` 内で `EmbeddingAdapter` を初期化していますが、モデルファイルが存在しない場合のダウンロード処理にタイムアウト制御がありません。ネットワーク不安定時にプロセスがハングする可能性があります。
- **リカバリ戦略なし (Medium)**: `_save_report` および `_generate_eat_batch` でのファイル書き込み（JSONダンプ）において、ディスク容量不足や権限エラーに対する防御策がありません。書き込みに失敗するとプログラム全体がクラッシュし、収集したデータが失われます。
  - *修正提案*: `try-except` ブロックで囲み、エラー時はログ出力して処理を継続するか、安全に終了させるべきです。
- **フォールバック欠如 (Medium)**: `_generate_eat_batch` 内のループ処理で個別ファイル（`incoming/eat_*.md`）を書き出す際、単一ファイルの書き込みエラー（例：不正なファイル名文字など）が発生すると、後続の全ファイル生成が中断されます。
  - *修正提案*: ループ内での `try-except` による個別エラーハンドリングが必要です。

## 重大度
High
