# ストア派制御審判 レビュー

## 対象ファイル
`mekhane/anamnesis/cli.py`

## 判定
発言（要改善）

## 発見事項
- (High) `cmd_session_index` および `cmd_conversation_index` 内で呼び出される `index_from_api` 等の外部API依存処理が、`try...except` ブロックで保護されておらず、タイムアウトも設定されていないため、外部サービスダウン時にCLIがクラッシュする。
- (High) `cmd_collect` および `cmd_collect_all` における `collector.search()` 呼び出しにタイムアウトが明示されておらず、無限待機の可能性がある。
- (Medium) `cmd_collect` には再試行（リトライ）ロジックがなく、一時的なネットワークエラーで即座に失敗する。
- (Medium) `update_state` における `STATE_FILE.write_text` はアトミック書き込み（temp書き込み→リネーム）ではないため、書き込み失敗時にファイル破損のリスクがあり、リカバリ戦略が欠如している。

## 重大度
High
