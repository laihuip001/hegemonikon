# CCL式美学者 レビュー

## 対象ファイル
`mekhane/ergasterion/digestor/scheduler.py`

## 判定
発言（要改善）

## 発見事項
- (CCL式が60ポイント超過: Medium) モジュールが「スケジューリング」「通知」「ログ基盤」「定期掃除」「プロセス管理」という5つの異なる責務を混在させており、単一責任原則（SRP）に違反している。
- (冗長なCCL式: Low) 標準の `logging` モジュールを使用せず、独自の `log` 関数でファイル書き込みを再実装している。
- (演算子の意図が不明: Low) `env["DISPLAY"] = ":0"` というハードコードされた環境変数が、コンテキストやフォールバックなしに埋め込まれている。

## 提案コード (Refactored)
```python
"""
Refactored Scheduler - Focuses only on scheduling and orchestration.
Delegates logging, notification, and cleanup to specialized modules.
"""
import logging
import schedule
import time
from pathlib import Path
from mekhane.ergasterion.digestor.pipeline import DigestorPipeline
# assumed existing modules for separation of concerns
# from mekhane.common.notification import DesktopNotifier
# from mekhane.common.maintenance import Cleaner

# Configure standard logging
logging.basicConfig(
    level=logging.INFO,
    format="[%(asctime)s] %(message)s",
    handlers=[
        logging.FileHandler(Path.home() / ".hegemonikon/digestor/scheduler.log"),
        logging.StreamHandler()
    ]
)

def job():
    """Single responsibility: Run the job."""
    logging.info("Starting digestor...")
    try:
        pipeline = DigestorPipeline()
        result = pipeline.run(max_papers=30)
        logging.info(f"Complete: {result.total_papers} papers")

        # Notification logic delegated
        # DesktopNotifier.notify(result)

    except Exception as e:
        logging.error(f"Error: {e}")

def main():
    """Main loop."""
    schedule.every().day.at("06:00").do(job)
    # schedule.every().day.at("00:00").do(Cleaner.cleanup_expired)

    while True:
        schedule.run_pending()
        time.sleep(60)

if __name__ == "__main__":
    main()
```

## 重大度
Medium
