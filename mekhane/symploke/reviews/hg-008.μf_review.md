# Dendron×PROOF一致検査官 レビュー

## 対象ファイル
`mekhane/mcp/sophia_mcp_server.py`

## 判定
発言（要改善）

## 発見事項

### Purpose矛盾 (High)
- `list_tools`: `# PURPOSE: [L2-auto] List available tools.`
  - **問題**: `[L2-auto]` は無効なカテゴリ（本来は `[L2/インフラ]`）。内容は "WHAT"（動作）であり "WHY"（目的）ではない。
  - **修正案**: `# PURPOSE: [L2/インフラ] A0→ツール発見が必要→利用可能なツール一覧を提供する`

- `call_tool`: `# PURPOSE: [L2-auto] Handle tool calls.`
  - **問題**: `[L2-auto]` は無効なカテゴリ。内容は "WHAT"。
  - **修正案**: `# PURPOSE: [L2/インフラ] A0→ツール実行が必要→リクエストを適切なハンドラに委譲する`

- `main`: `# PURPOSE: sophia_mcp_server の main 処理を実行する`
  - **問題**: 内容が "WHAT"。
  - **修正案**: `# PURPOSE: [L2/インフラ] A0→MCPサーバー起動が必要→標準入出力でサーバーを実行する`

### 定理参照不一致 (Medium)
- ファイル全体で `A0` (Free Energy Principle / Minimization) を参照しているが、主要関数 (`list_tools`, `call_tool`) に定理参照がない。
- **修正案**: 上記 Purpose 修正案のように `A0` を明示する。

### 登録漏れ (Medium)
- `list_tools`, `call_tool` は L2 (Infrastructure) としてマークされているが、`mekhane/mcp/PROOF.md` に関数単位の登録がない。
- **処置**: `PROOF.md` に関数エントリを追加するか、ファイル単位の登録で十分とするか検討が必要（現状はファイルのみ登録）。

## 重大度
High
