# Synergeia アーキテクチャ

## 1. 概念モデル

```
┌─────────────────────────────────────────────────────────────┐
│                      CCL 式 (入力)                          │
│  例: (/noe+ || /sop+) |> /dia+ |> @delegate[openmanus]{/ene+} │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│                    CCL Parser & Planner                     │
│  - 依存関係分析                                              │
│  - スレッド割当                                               │
│  - 実行計画生成                                              │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│                    Coordinator (n8n)                        │
├─────────────────────────────────────────────────────────────┤
│  Thread 1: Antigravity    │  Thread 2: Claude Code          │
│  - /noe+ 実行              │  - /ene+ 長時間実行             │
│  - /dia+ 判断              │                                 │
├─────────────────────────────────────────────────────────────┤
│  Thread 3: Perplexity     │  Thread 4: OpenManus            │
│  - /sop+ 調査              │  - マルチエージェント           │
│  - /zet+ 探求              │  - 無制限実行                   │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│                    Result Aggregator                        │
│  - スレッド結果の統合                                        │
│  - 最終出力生成                                              │
└─────────────────────────────────────────────────────────────┘
```

## 2. 実行フロー

### 2.1 シーケンシャル (`|>`)

```
Thread A: /noe+
    ↓ (結果を渡す)
Thread B: /dia+
    ↓ (結果を渡す)
Thread C: /ene+
```

### 2.2 パラレル (`||`)

```
         ┌→ Thread A: /noe+
入力 ────┤
         └→ Thread B: /sop+
                ↓
            Join (両者完了待ち)
                ↓
            Thread C: /dia+
```

## 3. スレッド間通信

| 方式 | 用途 | ツール |
|:-----|:-----|:-------|
| **ファイル** | 中間結果の永続化 | Git/FS |
| **API** | リアルタイム結果受け渡し | REST/WebSocket |
| **Message Queue** | 非同期通信 | n8n/Temporal |

## 4. エラーハンドリング

```ccl
@fault_tolerant{
  @thread[claude_code]{/ene+}
  @fallback{
    @thread[gemini]{/ene+}
  }
}
```

## 5. 将来拡張

- [ ] 自動スレッド割当 (@cluster[auto])
- [ ] 負荷分散アルゴリズム
- [ ] スレッドプール管理

---

*Created: 2026-02-01 | Synergeia Architecture v0.1*
